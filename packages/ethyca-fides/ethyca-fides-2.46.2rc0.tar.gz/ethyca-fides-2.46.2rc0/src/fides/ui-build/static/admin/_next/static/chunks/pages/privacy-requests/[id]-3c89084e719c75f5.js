(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9650],{6554:function(e,i,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/[id]",function(){return t(4685)}])},43124:function(e,i,t){"use strict";t.d(i,{Z:function(){return h}});var n=t(24246),r=t(13054),s=t(88038),l=t.n(s),o=t(86677);t(27378);var a=t(11596),c=t(72247),d=t(11032),u=()=>{let e=(0,o.useRouter)();return(0,n.jsx)(r.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,n.jsxs)(r.xuv,{children:[(0,n.jsxs)(r.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,n.jsx)(r.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,n.jsx)(r.zxk,{size:"sm",variant:"outline",onClick:()=>{e.push(d.fz)},children:"Configure"})]}),(0,n.jsxs)(r.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},h=e=>{let{children:i,title:t,padded:s=!0,mainProps:d}=e,h=(0,a.hz)(),x=(0,o.useRouter)(),g="/privacy-requests"===x.pathname||"/datastore-connection"===x.pathname,m=!(h.flags.privacyRequestsConfiguration&&g),{data:f}=(0,c.JE)(void 0,{skip:m}),{data:p}=(0,c.PW)(void 0,{skip:m}),j=h.flags.privacyRequestsConfiguration&&(!f||!p)&&g;return(0,n.jsxs)(r.kCb,{"data-testid":t,direction:"column",h:"100vh",children:[(0,n.jsxs)(l(),{children:[(0,n.jsxs)("title",{children:["Fides Admin UI - ",t]}),(0,n.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsxs)(r.kCb,{as:"main",direction:"column",py:s?6:0,px:s?10:0,h:s?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...d,children:[j?(0,n.jsx)(u,{}):null,i]})]})}},60136:function(e,i,t){"use strict";t.d(i,{D4:function(){return s.D4},MM:function(){return h},Ot:function(){return c},c6:function(){return r},cj:function(){return g},e$:function(){return o},fn:function(){return a},iC:function(){return x},nU:function(){return u},tB:function(){return d}});var n,r,s=t(41164);let l="An unexpected error occurred. Please try again.",o=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if((0,s.Bw)(e)){if((0,s.hE)(e.data))return e.data.detail;if((0,s.cz)(e.data)){var t;let i=null===(t=e.data.detail)||void 0===t?void 0:t[0];return"".concat(null==i?void 0:i.msg,": ").concat(null==i?void 0:i.loc)}if(409===e.status&&(0,s.Dy)(e.data)||404===e.status&&(0,s.XD)(e.data))return"".concat(e.data.detail.error," (").concat(e.data.detail.fides_key,")")}return i};function a(e){return"object"==typeof e&&null!=e&&"status"in e}function c(e){return"object"==typeof e&&null!=e&&"data"in e&&"string"==typeof e.data.detail}function d(e){return"object"==typeof e&&null!=e&&"data"in e&&Array.isArray(e.data.detail)}let u=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{status:500,message:l};if((0,s.oK)(e))return{status:e.originalStatus,message:e.data};if((0,s.Bw)(e)){let{status:t}=e;return{status:t,message:o(e,i.message)}}return i},h=e=>Object.entries(e).map(e=>({value:e[1],label:e[1]}));(n=r||(r={})).GVL="gvl",n.AC="gacp",n.COMPASS="compass";let x={gvl:{label:"GVL",fullName:"Global Vendor List"},gacp:{label:"AC",fullName:"Google Additional Consent List"},compass:{label:"",fullName:""}},g=e=>{let i=e.split(".")[0];return"gacp"===i?"gacp":"gvl"===i?"gvl":"compass"}},65399:function(e,i,t){"use strict";t.d(i,{HK:function(){return s},VY:function(){return n.V},O3:function(){return o}});var n=t(75139),r=t(60136);let s=()=>{let{errorAlert:e}=(0,n.V)();return{handleError:i=>{let t="An unexpected error occurred. Please try again.";(0,r.Ot)(i)?t=i.data.detail:(0,r.tB)(i)&&(t=i.data.detail[0].msg),e(t)}}};var l=t(27378);let o=e=>{let i=(0,l.useRef)(void 0);return(0,l.useEffect)(()=>{let t=t=>{var n;(null===(n=i.current)||void 0===n?void 0:n.contains(t.target))||e()};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[i,e]),{ref:i}}},75139:function(e,i,t){"use strict";t.d(i,{V:function(){return s}});var n=t(24246),r=t(13054);let s=()=>{let e=(0,r.pmc)();return{errorAlert:(i,t,s)=>{let l={...s,position:(null==s?void 0:s.position)||"top",render:e=>{let{onClose:s}=e;return(0,n.jsxs)(r.bZj,{alignItems:"normal",status:"error",children:[(0,n.jsx)(r.zMQ,{}),(0,n.jsxs)(r.xuv,{children:[t&&(0,n.jsx)(r.CdC,{children:t}),(0,n.jsx)(r.XaZ,{children:i})]}),(0,n.jsx)(r.PZ7,{onClick:s,position:"relative",right:0,size:"sm",top:-1})]})}};(null==s?void 0:s.id)&&e.isActive(s.id)?e.update(s.id,l):e(l)},successAlert:(i,t,s)=>{let l={...s,position:(null==s?void 0:s.position)||"top",render:e=>{let{onClose:s}=e;return(0,n.jsxs)(r.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,n.jsx)(r.zMQ,{}),(0,n.jsxs)(r.xuv,{children:[t&&(0,n.jsx)(r.CdC,{children:t}),(0,n.jsx)(r.XaZ,{children:i})]}),(0,n.jsx)(r.PZ7,{onClick:s,position:"relative",right:0,size:"sm",top:-1})]})}};(null==s?void 0:s.id)&&e.isActive(s.id)?e.update(s.id,l):e(l)}}}},73485:function(e,i,t){"use strict";t.d(i,{R:function(){return o}});var n=t(24246),r=t(13054),s=t(79894),l=t.n(s);let o=e=>{let{onClick:i,...t}=e;return(0,n.jsxs)(r.kCb,{alignItems:"center",mt:-4,mb:3,onClick:i,cursor:"pointer",...t,children:[(0,n.jsx)(r.hU,{"aria-label":"Back",icon:(0,n.jsx)(r.Rpv,{}),mr:2,size:"xs",variant:"outline"}),(0,n.jsx)(r.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})]})};i.Z=e=>{let{backPath:i,...t}=e;return(0,n.jsxs)(r.kCb,{alignItems:"center",mb:6,...t,children:[(0,n.jsx)(r.hU,{as:l(),href:i,"aria-label":"Back",icon:(0,n.jsx)(r.Rpv,{}),mr:2,size:"xs",variant:"outline"}),(0,n.jsx)(r.xvT,{as:l(),href:i,fontSize:"sm",fontWeight:"500",children:"Back"})]})}},21613:function(e,i,t){"use strict";var n=t(24246),r=t(13054),s=t(27378);i.Z=e=>{let{isOpen:i,onClose:t,onApproveRequest:l,isLoading:o,subjectRequest:a}=e,{identity:c,identity_verified_at:d,custom_privacy_request_fields:u}=a,h=(0,s.useCallback)(()=>{l().then(()=>{t()})},[l,t]);return(0,n.jsxs)(r.u_l,{isOpen:i,onClose:t,size:"lg",isCentered:!0,children:[(0,n.jsx)(r.ZAr,{}),(0,n.jsxs)(r.hzk,{children:[(0,n.jsx)(r.xBx,{children:"Privacy request approval"}),(0,n.jsxs)(r.fef,{paddingTop:0,paddingBottom:0,children:[(0,n.jsx)(r.xvT,{color:"gray.500",fontSize:"14px",marginBottom:4,children:"Are you sure you want to approve this privacy request?"}),(0,n.jsxs)(r.QI$,{children:[Object.entries(c).filter(e=>{let[,{value:i}]=e;return null!==i}).map(e=>{let[i,{value:t,label:s}]=e;return(0,n.jsx)(r.HCh,{children:(0,n.jsxs)(r.kCb,{alignItems:"flex-start",children:[(0,n.jsxs)(r.xvT,{mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:[s,":"]}),(0,n.jsx)(r.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:2,children:t}),"(",d?"Verified":"Unverified",")"]},i)},i)}),u&&Object.entries(u).filter(e=>{let[,i]=e;return i.value}).map(e=>{let[i,t]=e;return(0,n.jsx)(r.HCh,{children:(0,n.jsxs)(r.kCb,{alignItems:"flex-start",children:[(0,n.jsxs)(r.xvT,{mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:[t.label,":"]}),(0,n.jsxs)(r.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:2,children:[Array.isArray(t.value)?t.value.join(", "):t.value," "]}),"(Unverified)"]},i)},i)})]})]}),(0,n.jsx)(r.mzw,{children:(0,n.jsxs)(r.MIq,{columns:2,width:"100%",children:[(0,n.jsx)(r.zxk,{variant:"outline",size:"sm",mr:3,"data-testid":"cancel-btn",onClick:t,children:"Cancel"}),(0,n.jsx)(r.zxk,{colorScheme:"primary",variant:"solid",size:"sm","data-testid":"continue-btn",onClick:h,isLoading:o,children:"Confirm"})]})})]})]})}},94723:function(e,i,t){"use strict";var n=t(24246),r=t(34803),s=t(13054),l=t(34090),o=t(27378),a=t(59389);let c={denialReason:""};i.Z=e=>{let{isOpen:i,onClose:t,onDenyRequest:d}=e,u=(0,o.useCallback)((e,i)=>{let{setSubmitting:n}=i;d(e.denialReason).then(()=>{n(!1),t()})},[d,t]);return(0,n.jsxs)(s.u_l,{isOpen:i,onClose:t,isCentered:!0,returnFocusOnClose:!1,children:[(0,n.jsx)(s.ZAr,{}),(0,n.jsx)(s.hzk,{width:"100%",maxWidth:"456px","data-testid":"deny-privacy-request-modal",children:(0,n.jsx)(l.J9,{initialValues:c,validationSchema:a.Ry({denialReason:a.Z_().required().label("Reason for denial")}),onSubmit:u,children:e=>{let{isSubmitting:i,dirty:o,isValid:a}=e;return(0,n.jsxs)(l.l0,{children:[(0,n.jsx)(s.xBx,{children:"Privacy request denial"}),(0,n.jsx)(s.fef,{color:"gray.500",fontSize:"14px",children:"Please enter a reason for denying this privacy request. Please note: this can be seen by the user in their notification email."}),(0,n.jsx)(s.fef,{children:(0,n.jsx)(r.Ks,{name:"denialReason",textAreaProps:{focusBorderColor:"primary.600",resize:"none"}})}),(0,n.jsxs)(s.mzw,{children:[(0,n.jsx)(s.zxk,{variant:"outline",size:"sm",width:"100%",maxWidth:"198px",mr:3,isDisabled:i,onClick:t,children:"Cancel"}),(0,n.jsx)(s.zxk,{type:"submit",size:"sm",width:"100%",maxWidth:"198px",colorScheme:"primary",variant:"solid",isDisabled:!o||!a,isLoading:i,"data-testid":"deny-privacy-request-modal-btn",children:"Confirm"})]})]})}})})]})}},41628:function(e,i,t){"use strict";var n=t(24246),r=t(13054),s=t(27378),l=t(44296),o=t(60136),a=t(65399),c=t(72247);let d=(0,r.Gpc)((e,i)=>{let{buttonProps:t,handleBlur:d,subjectRequest:u}=e,h=(0,l.T)(),[x,g]=(0,s.useState)(!1),{errorAlert:m,successAlert:f}=(0,a.VY)(),{errorRequests:p}=(0,l.C)(c.fe),[j]=(0,c.JD)(),[v]=(0,c.Fq)(),y=async()=>{g(!0);let e=await j(p);"error"in e?(h((0,c.uT)({checkAll:!1,errorRequests:[]})),m((0,o.e$)(e.error),"DSR batch automation has failed due to the following:",{duration:null})):(e.data.failed.length>0&&m((0,n.jsxs)(r.xuv,{children:["DSR automation has failed for"," ",(0,n.jsx)(r.xvT,{as:"span",fontWeight:"semibold",children:e.data.failed.length})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null}),e.data.succeeded.length>0&&f("Privacy request(s) are now being reprocessed.")),g(!1)},b=async()=>{if(!u)return;g(!0);let e=await v(u);"error"in e?m((0,o.e$)(e.error),"DSR automation has failed for this privacy request due to the following:",{duration:null}):f("Privacy request is now being reprocessed."),g(!1),d&&d(i)};return(0,n.jsx)(r.zxk,{...t,isDisabled:x,isLoading:x,loadingText:"Reprocessing",onClick:u?b:y,ref:i,spinnerPlacement:"end",leftIcon:(0,n.jsx)(r.AyE,{}),variant:"outline",_loading:{opacity:1,div:{opacity:.4}},children:"Reprocess"})});i.Z=d},25662:function(e,i,t){"use strict";t.d(i,{Z:function(){return r}});var n=t(72247);let r=e=>{let{subjectRequest:i}=e,[t,r]=(0,n.RW)({fixedCacheKey:i.id}),[s,l]=(0,n.F1)({fixedCacheKey:i.id}),o=l.isLoading||r.isLoading;return{approveRequest:t,approveRequestResult:r,denyRequest:s,denyRequestResult:l,handleApproveRequest:()=>t(i),handleDenyRequest:e=>s({id:i.id,reason:e}),isLoading:o}}},4685:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return Y}});var n,r,s=t(24246),l=t(13054),o=t(86677),a=t(43124),c=t(73485),d=t(11032),u=t(27365),h=t(27378),x=t(19686);let g=e=>{let i={};return e.forEach(e=>{let{collection_name:t,updated_at:n}=e;(!i[t]||new Date(i[t].updated_at)<new Date(n))&&(i[t]=e)}),Object.values(i).some(e=>e.status===x.np.ERROR)};var m=e=>{let{subjectRequest:i,setEventDetails:t}=e,{results:n}=i,r=n?Object.keys(n):[],o=r.map((e,i)=>(0,s.jsxs)(l.xuv,{children:[(0,s.jsxs)(l.kCb,{alignItems:"center",height:23,position:"relative",children:[(0,s.jsx)(l.xuv,{zIndex:1,children:g(n[e])?(0,s.jsx)(l.f9v,{}):(0,s.jsx)(l.StI,{})}),i===r.length-1?null:(0,s.jsx)(l.xuv,{width:"2px",height:"63px",backgroundColor:"gray.700",position:"absolute",top:"16px",left:"6px",zIndex:0}),(0,s.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",ml:2,children:e})]}),(0,s.jsx)(l.xvT,{cursor:"pointer",color:"complimentary.500",fontWeight:"500",fontSize:"sm",ml:6,mb:7,onClick:()=>{t({key:e,logs:n[e]})},children:"View Details"})]},e));return(0,s.jsxs)(l.xuv,{width:"100%",children:[(0,s.jsx)(l.xvT,{color:"gray.900",fontSize:"md",fontWeight:"500",mb:1,children:"Activity timeline"}),o]})},f=t(71288),p=e=>{let{errorMessage:i}=e;return(0,s.jsxs)(l.xuv,{height:"100%",id:"outer",children:[(0,s.jsxs)(l.kCb,{alignItems:"center",paddingBottom:"8px",children:[(0,s.jsx)(l.xvT,{size:"sm",color:"gray.700",fontWeight:"medium",marginRight:"8px",lineHeight:"20px",children:"Status"}),(0,s.jsx)(l.Vp9,{size:"sm",height:"20px",backgroundColor:"red.500",color:"white",marginRight:"8px",children:"Error"}),(0,s.jsx)(l.xuv,{padding:"0px",marginBottom:"3px",children:(0,s.jsx)(f.Z,{copyText:i})})]}),(0,s.jsx)(l.izJ,{}),(0,s.jsx)(l.xuv,{id:"errorWrapper",overflow:"auto",height:"100%",children:(0,s.jsx)(l.xvT,{children:i})})]})},j=t(94167);(n=r||(r={})).IN_PROCESSING="in_processing",n.PENDING="pending",n.COMPLETE="complete",n.ERROR="error",n.PAUSED="paused",n.RETRYING="retrying",n.SKIPPED="skipped";var v=e=>{let{eventLogs:i,openErrorPanel:t}=e,n=null==i?void 0:i.map(e=>(0,s.jsxs)(l.Tr,{_hover:{backgroundColor:e.status===r.ERROR?"#F7FAFC":"unset"},onClick:()=>{e.status===r.ERROR&&t(e.message)},style:{cursor:e.status===r.ERROR?"pointer":"unset"},children:[(0,s.jsx)(l.Td,{children:(0,s.jsx)(l.xvT,{color:"gray.600",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:(0,j.p6)(e.updated_at)})}),(0,s.jsx)(l.Td,{children:(0,s.jsx)(l.xvT,{color:"gray.600",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:e.status})}),(0,s.jsx)(l.Td,{children:(0,s.jsx)(l.xvT,{color:"gray.600",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:e.collection_name})})]},e.updated_at));return(0,s.jsx)(l.xuv,{width:"100%",paddingTop:"0px",height:"100%",children:(0,s.jsx)(l.xJi,{id:"tableContainer",height:"100%",style:{overflowY:"auto"},children:(0,s.jsxs)(l.iA_,{size:"sm",id:"table",position:"relative",children:[(0,s.jsx)(l.hrZ,{id:"tableHeader",position:"sticky",top:"0px",backgroundColor:"white",children:(0,s.jsxs)(l.Tr,{children:[(0,s.jsx)(l.Th,{children:(0,s.jsx)(l.xvT,{color:"black",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:"Time"})}),(0,s.jsx)(l.Th,{children:(0,s.jsx)(l.xvT,{color:"black",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:"Status"})}),(0,s.jsx)(l.Th,{children:(0,s.jsx)(l.xvT,{color:"black",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:"Collection"})})]})}),(0,s.jsx)(l.p3B,{id:"tabelBody",children:n})]})})})},y=e=>{let{eventData:i}=e,{isOpen:t,onOpen:n,onClose:r}=(0,l.qY0)(),[o,a]=(0,h.useState)(!1),[c,d]=(0,h.useState)(""),u=()=>{a(!1)},x=()=>{o&&u(),r()},g=o?"Event detail":"Event log";return void 0===i?null:(0,s.jsxs)(l.xuv,{width:"100%",paddingTop:"0px",height:"100%",children:[(0,s.jsx)(l.xvT,{color:"gray.900",fontSize:"md",fontWeight:"500",mb:1,children:"Event Details"}),(0,s.jsx)(l.xvT,{color:"gray.600",fontSize:"sm",fontWeight:"500",lineHeight:"20px",mb:1,children:i.key}),(0,s.jsx)(l.izJ,{}),(0,s.jsx)(l.xvT,{cursor:"pointer",color:"complimentary.500",fontWeight:"500",fontSize:"sm",onClick:()=>{n()},children:"View Log"}),(0,s.jsxs)(l.dys,{isOpen:t,placement:"right",onClose:x,size:"full",autoFocus:!1,children:[(0,s.jsx)(l.P1B,{}),(0,s.jsxs)(l.scA,{style:{width:"50%"},children:[(0,s.jsx)(l.OXI,{style:{paddingBottom:"0px"},children:(0,s.jsxs)(l.kCb,{justifyContent:"space-between",alignItems:"center",height:"40px",children:[(0,s.jsxs)(l.kCb,{alignItems:"center",children:[o?(0,s.jsx)(l.hU,{icon:(0,s.jsx)(l.Rpv,{}),"aria-label":"Close error logs",size:"sm",style:{height:"24px",width:"24px",minWidth:"24px",marginRight:"8px"},onClick:u}):null,(0,s.jsx)(l.xvT,{color:"gray.900",fontSize:"md",lineHeight:"6",fontWeight:"medium",children:g})]}),(0,s.jsx)(l.kCb,{alignItems:"flex-start",height:"100%",children:(0,s.jsx)(l.hU,{icon:(0,s.jsx)(l.LGN,{width:"17px"}),"aria-label":"Stop viewing error message",variant:"unstyled",size:"sm",style:{height:"24px",width:"24px",minWidth:"14px",backgroundColor:"#00000000"},isRound:!0,onClick:x})})]})}),(0,s.jsxs)(l.Ng0,{id:"drawerBody",overflow:"hidden",children:[i&&!o?(0,s.jsx)(v,{eventLogs:i.logs,openErrorPanel:e=>{d(e),a(!0)}}):null,o?(0,s.jsx)(p,{errorMessage:c}):null]})]})]})]})},b=e=>{let{subjectRequest:i}=e,[t,n]=(0,h.useState)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mb:4,children:"Events and logs"}),(0,s.jsx)(l.izJ,{}),(0,s.jsxs)(l.kCb,{mt:3,children:[(0,s.jsx)(m,{subjectRequest:i,setEventDetails:n}),(0,s.jsx)(y,{eventData:t})]})]})},C=t(65399),k=t(7564),z=t(72247),S=t(44296);let w=e=>Array.from(new Set(e.filter(e=>Object.values(x.Us).includes(e.action_type)).map(e=>e.action_type)));var _=e=>{let{rules:i}=e,t=w(i).map(e=>(0,j.kC)(e)).map(e=>(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:e},e));return(0,s.jsx)(l.xuv,{children:t})},R=t(34090),T=t(59389),q=e=>{let{connectorName:i,data:t,isSubmitting:n=!1,onSaveClick:r}=e,{isOpen:o,onOpen:a,onClose:c}=(0,l.qY0)(),d=(0,h.useRef)(null),u=async(e,i)=>{r({connection_key:t.connection_key,privacy_request_id:t.privacy_request_id,body:{...e}}),c()};return(0,s.jsxs)(s.Fragment,{children:[(null==t?void 0:t.checked)&&(0,s.jsx)(l.zxk,{color:"gray.700",fontSize:"xs",h:"24px",onClick:a,variant:"outline",w:"58px",children:"Review"}),!(null==t?void 0:t.checked)&&(0,s.jsx)(l.zxk,{color:"white",bg:"primary.800",fontSize:"xs",h:"24px",onClick:a,w:"127px",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},children:"Begin manual input"}),(0,s.jsx)(R.J9,{enableReinitialize:!0,initialValues:{...t.fields},onSubmit:u,validateOnBlur:!1,validateOnChange:!1,validationSchema:T.Ry().shape({}),children:e=>(0,s.jsxs)(l.dys,{isOpen:o,placement:"right",initialFocusRef:d,onClose:c,size:"lg",children:[(0,s.jsx)(l.P1B,{}),(0,s.jsxs)(l.scA,{children:[(0,s.jsx)(l.cCv,{}),(0,s.jsxs)(l.OXI,{color:"gray.900",children:[(0,s.jsx)(l.xvT,{fontSize:"xl",mb:8,children:i}),(0,s.jsx)(l.izJ,{}),(0,s.jsx)(l.xvT,{fontSize:"md",mt:"4",children:"Manual access"}),(0,s.jsx)(l.xuv,{mt:"8px",children:(0,s.jsx)(l.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"normal",children:"Please complete the following PII fields that have been collected for the selected subject."})})]}),(0,s.jsx)(l.Ng0,{children:(0,s.jsx)(R.l0,{id:"manual-detail-form",noValidate:!0,children:(0,s.jsx)(l.gCW,{align:"stretch",gap:"16px",children:Object.entries(t.fields).map((e,i)=>{let[t]=e;return(0,s.jsx)(l.Ugi,{children:(0,s.jsx)(R.gN,{id:t,name:t,children:e=>{let{field:n}=e;return(0,s.jsxs)(l.NIc,{alignItems:"baseline",display:"inline-flex",children:[(0,s.jsx)(l.lXp,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:t,w:"50%",children:t}),(0,s.jsx)(l.IIB,{...n,autoComplete:"off",color:"gray.700",placeholder:"Please enter ".concat(t),ref:0===i?d:void 0,size:"sm"})]})}})},t)})})})}),(0,s.jsx)(l.zeN,{justifyContent:"flex-start",children:(0,s.jsxs)(l.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,s.jsx)(l.zxk,{onClick:c,variant:"outline",children:"Cancel"}),(0,s.jsx)(l.zxk,{bg:"primary.800",color:"white",form:"manual-detail-form",isLoading:n,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_hover:{bg:"primary.400"},children:"Save"})]})})]})]})})]})},W=e=>{let{connectorName:i,data:t,isSubmitting:n=!1,onSaveClick:r}=e,{isOpen:o,onOpen:a,onClose:c}=(0,l.qY0)(),d=(0,h.useRef)(null),u=async(e,i)=>{r({connection_key:t.connection_key,privacy_request_id:t.privacy_request_id,body:{...e}}),c()};return(0,s.jsxs)(s.Fragment,{children:[(null==t?void 0:t.checked)&&(0,s.jsx)(l.zxk,{color:"gray.700",fontSize:"xs",h:"24px",onClick:a,variant:"outline",w:"58px",children:"Review"}),!(null==t?void 0:t.checked)&&(0,s.jsx)(l.zxk,{color:"white",bg:"primary.800",fontSize:"xs",h:"24px",onClick:a,w:"127px",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},children:"Begin manual input"}),(0,s.jsx)(R.J9,{enableReinitialize:!0,initialValues:{...t.fields},onSubmit:u,validateOnBlur:!1,validateOnChange:!1,validationSchema:T.Ry().shape({}),children:e=>(0,s.jsxs)(l.dys,{isOpen:o,placement:"right",initialFocusRef:d,onClose:c,size:"lg",children:[(0,s.jsx)(l.P1B,{}),(0,s.jsxs)(l.scA,{children:[(0,s.jsx)(l.cCv,{}),(0,s.jsxs)(l.OXI,{color:"gray.900",children:[(0,s.jsx)(l.xvT,{fontSize:"xl",mb:8,children:i}),(0,s.jsx)(l.izJ,{}),(0,s.jsx)(l.xvT,{fontSize:"md",mt:"4",children:"Manual erasure"}),(0,s.jsx)(l.xuv,{mt:"8px",children:(0,s.jsx)(l.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"normal",children:"Please delete the following PII fields associated with the selected subject if they are available. Once deleted, check the box to confirm the deletion."})})]}),(0,s.jsx)(l.Ng0,{children:(0,s.jsx)(R.l0,{id:"manual-detail-form",noValidate:!0,children:(0,s.jsx)(l.gCW,{align:"stretch",gap:"16px",children:Object.entries(t.fields).map(e=>{let[i]=e;return(0,s.jsx)(l.Ugi,{children:(0,s.jsx)(R.gN,{id:i,name:i,children:e=>{let{field:t}=e;return(0,s.jsxs)(l.NIc,{alignItems:"baseline",display:"inline-flex",children:[(0,s.jsx)(l.lXp,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:i,w:"50%",children:i}),(0,s.jsx)(l.XZJ,{...t,isChecked:!!t.value,onChange:t.onChange,name:i,id:i})]})}})},i)})})})}),(0,s.jsx)(l.zeN,{justifyContent:"flex-start",children:(0,s.jsxs)(l.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,s.jsx)(l.zxk,{onClick:c,variant:"outline",children:"Cancel"}),(0,s.jsx)(l.zxk,{bg:"primary.800",color:"white",form:"manual-detail-form",isLoading:n,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_hover:{bg:"primary.400"},children:"Save"})]})})]})]})})]})};let E=(e,i,t)=>e.includes(x.Us.ACCESS)?{ProcessingDetailComponent:q,uploadMutation:i,getUploadedWebhookDataEndpoint:z.$I.endpoints.getUploadedManualAccessWebhookData}:e.includes(x.Us.ERASURE)?{ProcessingDetailComponent:W,uploadMutation:t,getUploadedWebhookDataEndpoint:z.$I.endpoints.getUploadedManualErasureWebhookData}:null;var A=e=>{let{subjectRequest:i}=e,t=(0,S.T)(),{errorAlert:n,successAlert:r}=(0,C.VY)(),{handleError:o}=(0,C.HK)(),[a,c]=(0,h.useState)([]),[d,u]=(0,h.useState)(!1),[g,m]=(0,h.useState)(!1),{data:f,isFetching:p,isLoading:j,isSuccess:v}=(0,k.W6)(),[y]=(0,z.w3)(),b=w(i.policy.rules),[_]=(0,z.nL)(),[R]=(0,z.UR)(),{ProcessingDetailComponent:T,uploadMutation:q,getUploadedWebhookDataEndpoint:W}=E(b,_,R),A=async()=>{try{u(!0),await y(i.id).unwrap(),r("Manual request has been received. Request now processing.")}catch(e){o(e)}finally{u(!1)}},I=async e=>{try{m(!0),await q(e).unwrap();let i={connection_key:e.connection_key,fields:{}};Object.entries(e.body).forEach(e=>{let[t,n]=e;i.fields[t]=n||""});let t=a.map(e=>e.connection_key===i.connection_key?{...e,checked:!0,fields:{...i.fields}}:e);c(t),r("Manual input successfully saved!")}catch(e){o(e)}finally{m(!1)}};return((0,h.useEffect)(()=>(v&&f.length>0&&0===a.length&&(()=>{if(a.length>0)return;let e=[],r=null==f?void 0:f.map(e=>e.connection_config.key);null==r||r.every(n=>e.push(t(W.initiate({connection_key:n,privacy_request_id:i.id})))),Promise.allSettled(e).then(e=>{let i=[];e.forEach((e,t)=>{if("fulfilled"===e.status&&e.value.isSuccess&&e.value.data){let t={checked:e.value.data.checked,fields:{},connection_key:e.value.originalArgs.connection_key,privacy_request_id:e.value.originalArgs.privacy_request_id};Object.entries(e.value.data.fields).forEach(e=>{let[i,n]=e;t.fields[i]=n||""}),i.push(t)}else n("An error occurred while loading manual input data for ".concat(f[t].connection_config.name))}),c(i)})})(),()=>{}),[f,a.length,t,n,v,i.id,W]),b.includes(x.Us.ACCESS)||b.includes(x.Us.ERASURE))?(0,s.jsxs)(l.gCW,{align:"stretch",spacing:8,children:[(0,s.jsxs)(l.xuv,{children:[(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mb:4,children:"Manual Processing"}),(0,s.jsx)(l.izJ,{})]}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(l.xvT,{color:"gray.700",fontSize:"sm",children:"The following table details the integrations that require manual input from you."})}),(0,s.jsxs)(l.xuv,{children:[(p||j)&&(0,s.jsx)(l.M5Y,{children:(0,s.jsx)(l.$jN,{})}),v&&f?(0,s.jsx)(l.xJi,{children:(0,s.jsxs)(l.iA_,{size:"sm",variant:"unstyled",children:[(0,s.jsx)(l.hrZ,{children:(0,s.jsxs)(l.Tr,{children:[(0,s.jsx)(l.Th,{fontSize:"sm",fontWeight:"semibold",pl:"0",textTransform:"none",children:"Integration Identifier"}),(0,s.jsx)(l.Th,{})]})}),(0,s.jsxs)(l.p3B,{children:[f.length>0&&f.map(e=>(0,s.jsxs)(l.Tr,{display:"block",children:[(0,s.jsx)(l.Td,{pl:"0",children:e.connection_config.key}),(0,s.jsx)(l.Td,{children:a.length>0?(0,s.jsx)(T,{connectorName:e.connection_config.name,data:a.find(i=>i.connection_key===e.connection_config.key),isSubmitting:g,onSaveClick:I}):null})]},e.id)),0===f.length&&(0,s.jsx)(l.Tr,{children:(0,s.jsx)(l.Td,{colSpan:3,pl:"0",children:(0,s.jsx)(l.M5Y,{children:(0,s.jsx)(l.xvT,{children:"You don‘t have any Manual Process connections set up yet."})})})})]}),a.length>0&&a.every(e=>e.checked)?(0,s.jsx)(l.$RU,{children:(0,s.jsx)(l.Tr,{children:(0,s.jsx)(l.Th,{pl:"0px",children:(0,s.jsx)(l.zxk,{color:"white",bg:"primary.800",fontSize:"xs",h:"24px",isLoading:d,loadingText:"Completing DSR",onClick:A,w:"127px",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},children:"Complete DSR"})})})}):null]})}):null]})]}):null},I=t(93261),O=e=>{let{daysLeft:i,includeText:t,status:n}=e;if(!i||n===I.q.COMPLETE||n===I.q.CANCELED||n===I.q.DENIED||n===I.q.IDENTITY_UNVERIFIED)return null;let r="";switch(!0){case i>=10:r="green.500";break;case i<10&&i>4:r="orange.500";break;case i<5:r="red.400"}return(0,s.jsx)(l.Vp9,{backgroundColor:r,color:"white",fontWeight:"medium",fontSize:"sm",children:t?"".concat(i," days left"):i})},P=t(11596);let D={approved:{bg:"yellow.500",label:"Approved"},complete:{bg:"green.500",label:"Completed"},awaiting_email_send:{bg:"gray.400",label:"Awaiting Email Send"},denied:{bg:"red.500",label:"Denied"},canceled:{bg:"red.600",label:"Canceled"},error:{bg:"red.800",label:"Error"},in_processing:{bg:"orange.500",label:"In Progress"},paused:{bg:"gray.400",label:"Paused"},pending:{bg:"blue.400",label:"New"},identity_unverified:{bg:"red.400",label:"Unverified"},requires_input:{bg:"yellow.400",label:"Requires Input"}};var N=e=>{let{status:i}=e;return(0,s.jsx)(l.Cts,{color:"white",bg:D[i].bg,width:"100%",minWidth:"120px",lineHeight:"18px",textAlign:"center","data-testid":"request-status-badge",children:D[i].label})},L=t(21613),B=t(25662);let F=(0,l.Gpc)((e,i)=>(0,s.jsx)(l.zxk,{ref:i,size:"xs",bg:"white",_loading:{opacity:1,div:{opacity:.4}},_hover:{bg:"gray.100"},...e})),U=(0,l.Gpc)((e,i)=>{let{buttonProps:t,children:n,onClose:r,subjectRequest:o}=e,{handleApproveRequest:a,isLoading:c}=(0,B.Z)({subjectRequest:o}),d=(0,l.qY0)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F,{ref:i,onClick:d.onOpen,isLoading:c,isDisabled:c,...t,"data-testid":"privacy-request-approve-btn",children:n}),(0,s.jsx)(L.Z,{isOpen:d.isOpen,isLoading:c,onClose:()=>{d.onClose(),null==r||r()},onApproveRequest:a,subjectRequest:o})]})});var Z=t(94723);let V=(0,l.Gpc)((e,i)=>{let{buttonProps:t,children:n,onClose:r,subjectRequest:o}=e,{handleDenyRequest:a,isLoading:c}=(0,B.Z)({subjectRequest:o}),d=(0,l.qY0)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F,{ref:i,onClick:d.onOpen,isLoading:c,isDisabled:c,...t,"data-testid":"privacy-request-deny-btn",children:n}),(0,s.jsx)(Z.Z,{isOpen:d.isOpen,onClose:()=>{d.onClose(),null==r||r()},onDenyRequest:a})]})});var M=t(41628),X=e=>{let{subjectRequest:i}=e,{plus:t}=(0,P.hz)(),{id:n,status:r,policy:o}=i;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mt:4,mb:4,children:"Request details"}),(0,s.jsx)(l.izJ,{}),(0,s.jsxs)(l.kCb,{alignItems:"center",children:[(0,s.jsx)(l.xvT,{mt:4,mb:4,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Request ID:"}),(0,s.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:1,children:n}),(0,s.jsx)(f.Z,{copyText:n})]}),t&&i.source&&(0,s.jsxs)(l.kCb,{children:[(0,s.jsx)(l.xvT,{mb:4,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Source:"}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:i.source})})]}),(0,s.jsxs)(l.kCb,{alignItems:"center",children:[(0,s.jsx)(l.xvT,{mb:4,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Request type:"}),(0,s.jsx)(l.xuv,{mr:1,mb:4,children:(0,s.jsx)(_,{rules:o.rules})})]}),(0,s.jsxs)(l.kCb,{children:[(0,s.jsx)(l.xvT,{mb:4,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Policy key:"}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:i.policy.key})})]}),(0,s.jsxs)(l.kCb,{alignItems:"center",children:[(0,s.jsx)(l.xvT,{mb:0,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Status:"}),(0,s.jsxs)(l.Ugi,{spacing:"8px",children:[(0,s.jsx)(l.kCb,{children:(0,s.jsx)(N,{status:r})}),(0,s.jsxs)(l.hE2,{isAttached:!0,variant:"outline",borderRadius:"md",children:["error"===r&&(0,s.jsx)(M.Z,{buttonProps:{size:"xs"},subjectRequest:i}),"pending"===r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(U,{subjectRequest:i,children:"Approve"}),(0,s.jsx)(V,{subjectRequest:i,children:"Deny"})]})]}),(0,s.jsx)(O,{daysLeft:i.days_left,includeText:!0,status:i.status})]})]})]})},J=e=>{let{subjectRequest:i}=e,{identity:t,identity_verified_at:n,custom_privacy_request_fields:r}=i;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.kCb,{direction:"row",justifyContent:"space-between",children:(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mb:4,mt:4,children:"Subject identities"})}),(0,s.jsx)(l.izJ,{mb:4}),Object.entries(t).filter(e=>{let[,{value:i}]=e;return null!==i}).map(e=>{let[i,{value:t,label:r}]=e;return(0,s.jsxs)(l.kCb,{alignItems:"flex-start",children:[(0,s.jsxs)(l.xvT,{mb:4,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:[r,":"]}),(0,s.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:2,children:t||""}),(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:n?"Verified":"Unverified"})]},i)}),r&&Object.keys(r).length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mt:4,mb:4,children:"Custom request fields"}),(0,s.jsx)(l.izJ,{mb:4}),Object.entries(r).filter(e=>{let[,i]=e;return i.value}).map(e=>{let[i,t]=e;return(0,s.jsxs)(l.kCb,{alignItems:"flex-start",children:[(0,s.jsxs)(l.xvT,{mb:4,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:[t.label,":"]}),(0,s.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:2,children:Array.isArray(t.value)?t.value.join(", "):t.value}),(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:"Unverified"})]},i)})]})]})},H=e=>{let{data:i}=e;return(0,s.jsxs)(l.gCW,{align:"stretch",display:"flex-start",spacing:6,children:[(0,s.jsx)(l.xuv,{"data-testid":"privacy-request-details",children:(0,s.jsx)(X,{subjectRequest:i})}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(J,{subjectRequest:i})}),"requires_input"===i.status&&(0,s.jsx)(l.xuv,{children:(0,s.jsx)(A,{subjectRequest:i})}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(b,{subjectRequest:i})})]})},Y=()=>{let e;let{id:i=""}=(0,o.useRouter)().query,{data:t,isLoading:n,isUninitialized:r}=(0,u.QA)({id:Array.isArray(i)?i[0]:i,verbose:!0},{skip:""===i});return e=r||n?(0,s.jsx)(l.M5Y,{children:(0,s.jsx)(l.$jN,{})}):t&&(null==t?void 0:t.items.length)!==0?(0,s.jsx)(H,{data:null==t?void 0:t.items[0]}):(0,s.jsx)(l.xvT,{children:"404 no privacy request found"}),(0,s.jsxs)(a.Z,{title:"Privacy Requests - ".concat(i),children:[(0,s.jsx)(c.Z,{backPath:d.Jw}),(0,s.jsx)(l.X6q,{fontSize:"2xl",fontWeight:"semibold",children:"Privacy Request"}),e]})}},41164:function(e,i,t){"use strict";t.d(i,{Bw:function(){return l},D4:function(){return r},Dy:function(){return a},XD:function(){return c},cz:function(){return d},hE:function(){return o},oK:function(){return s}});var n=t(76649);let r=e=>"error"in e,s=e=>(0,n.Ln)({status:"string"},e)&&"PARSING_ERROR"===e.status,l=e=>(0,n.Ln)({status:"number",data:{}},e),o=e=>(0,n.Ln)({detail:"string"},e),a=e=>(0,n.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),c=e=>(0,n.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),d=e=>(0,n.Ln)({detail:[{loc:["string","number"],msg:"string",type:"string"}]},e)},76649:function(e,i,t){"use strict";t.d(i,{Ln:function(){return n},uX:function(){return l}});let n=(e,i)=>s(e,i),r=Symbol("SOME"),s=(e,i)=>"string"==typeof e?e===typeof i:Array.isArray(e)?r in e?e.some(e=>s(e,i)):!!Array.isArray(i)&&(0===e.length||i.every(i=>e.some(e=>s(e,i)))):"object"==typeof i&&null!==i&&Object.entries(e).every(([e,t])=>s(t,i[e])),l=e=>i=>n(e,i);class o{static narrow(e){return new o(i=>n(e,i))}constructor(e){this.NF=void 0,this.NF=e}satisfied(e){return this.NF(e)}build(e){return e}and(e){let i=this.NF,t=e instanceof o?e.NF:e instanceof Function?e:i=>n(e,i);return new o(e=>i(e)&&t(e))}}new o(e=>!0)}},function(e){e.O(0,[2888,9774,179],function(){return e(e.s=6554)}),_N_E=e.O()}]);