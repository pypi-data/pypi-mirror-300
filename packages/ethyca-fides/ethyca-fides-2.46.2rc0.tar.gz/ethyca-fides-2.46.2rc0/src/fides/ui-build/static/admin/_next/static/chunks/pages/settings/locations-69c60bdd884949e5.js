(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2462],{40135:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/locations",function(){return n(76519)}])},76519:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var i=n(24246),l=n(13054),s=n(44296),o=n(43124),a=n(98784),r=n.n(a),c=n(86677),d=n(27378),h=n(60136),u=n(77650),m=n(33312),g=n(16781),x=n(43073),p=n(11032),j=n(93595),f=n(93329),C=n(39514),v=e=>{let{id:t,isChecked:n,onChange:s}=e;return(0,i.jsxs)(l.kCb,{alignItems:"center",gap:"8px",children:[(0,i.jsx)(l.rsf,{isChecked:n,size:"sm",onChange:s,colorScheme:"complimentary",id:t,"data-testid":"regulated-toggle"}),(0,i.jsx)(l.lXp,{fontSize:"sm",m:0,htmlFor:t,children:"Regulated"}),(0,i.jsx)(C.Z,{label:"Toggle on to see only locations in this region with privacy regulations supported by Fides"})]})},y=n(70218),w=n(51541),k=n(77464),S=e=>{let{groups:t,locations:n,isOpen:s,onClose:o,selected:a,onChange:r}=e,[c,h]=(0,d.useState)(a),[u,m]=(0,d.useState)(!1),{filteredLocations:g,locationsByGroup:x}=(0,d.useMemo)(()=>{let e=u?n.filter(e=>{var t;return null===(t=e.regulation)||void 0===t?void 0:t.length}):n;return{locationsByGroup:(0,k.VT)(e),filteredLocations:e}},[n,u]),{allSelected:p,handleToggleAll:j,handleToggleSelection:f}=(0,y.QZ)({items:g,selected:c,onChange:h}),C=c.filter(e=>!Object.keys(x).includes(e)).length,S=n[0].continent,b=Object.keys(x),_=!(1===b.length&&"Other"===b[0]);return(0,i.jsxs)(l.u_l,{size:"2xl",isOpen:s,onClose:o,isCentered:!0,children:[(0,i.jsx)(l.ZAr,{}),(0,i.jsxs)(l.hzk,{"data-testid":"subgroup-modal",children:[(0,i.jsx)(w.h4,{title:"Select locations"}),(0,i.jsxs)(l.fef,{p:6,maxHeight:"70vh",overflowY:"auto",children:[(0,i.jsx)(w.x$,{title:S,allSelected:p,onToggleAll:j,numSelected:C,children:(0,i.jsx)(v,{id:"".concat(S,"-modal-regulated"),isChecked:u,onChange:()=>m(!u)})}),_?(0,i.jsx)(l.UQy,{allowToggle:!0,allowMultiple:!0,children:Object.entries(x).map(e=>{let[n,s]=e,o=t.find(e=>n===e.id),a=o?o.name:n;return(0,i.jsxs)(l.Qdk,{"data-testid":"".concat(a,"-accordion"),children:[(0,i.jsx)("h2",{children:(0,i.jsxs)(l.KFZ,{children:[(0,i.jsx)(l.xuv,{as:"span",flex:"1",textAlign:"left",fontWeight:"semibold",fontSize:"sm",children:a}),(0,i.jsx)(l.XEm,{})]})}),(0,i.jsx)(l.Hk3,{pb:4,children:(0,i.jsx)(l.MIq,{columns:3,spacing:6,children:s.map(e=>(0,i.jsx)(l.XZJ,{size:"sm",colorScheme:"complimentary",isChecked:c.includes(e.id),onChange:()=>f(e.id),"data-testid":"".concat(e.name,"-checkbox"),children:e.name},e.id))})})]},n)})}):(0,i.jsx)(l.MIq,{columns:3,spacing:6,paddingInline:4,children:g.map(e=>(0,i.jsx)(l.XZJ,{size:"sm",colorScheme:"complimentary",isChecked:c.includes(e.id),onChange:()=>f(e.id),"data-testid":"".concat(e.name,"-checkbox"),children:e.name},e.id))})]}),(0,i.jsx)(w.$_,{onApply:()=>{let e=new Set(c);Object.entries(x).forEach(t=>{let[n,i]=t;i.every(e=>c.includes(e.id))?e.add(n):e.delete(n)}),r(Array.from(e)),o()},onClose:o})]})]})};let b=(e,t)=>{var n;return null===(n=e.name)||void 0===n?void 0:n.toLocaleLowerCase().includes(t.toLocaleLowerCase())};var _=e=>{let{title:t,groups:n,locations:s,selected:o,onChange:a,search:r}=e,c=(0,l.qY0)(),[h,u]=(0,d.useState)(!1),m=!!(null==r?void 0:r.length),g=n.length>0,x=s;n.length&&(x=n),m&&(x=[...s,...n].sort((e,t)=>e.name.localeCompare(t.name)));let p=h?x.filter(e=>(0,k.$q)(e,s)):x,j=r?p.filter(e=>b(e,r)):p,C=n.filter(e=>"checked"===(0,k.ji)({group:e,selected:o,locations:s})).map(e=>e.id),y=n.filter(e=>"indeterminate"===(0,k.ji)({group:e,selected:o,locations:s})).map(e=>e.id),w=g?[...C,...o]:o,_=o.length,O=e=>{a(s.map(t=>e.includes(t.id)?{...t,selected:!0}:{...t,selected:!1}))};return 0===j.length&&r?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.ZP,{title:t,items:j,selected:w,indeterminate:g?y:[],onChange:e=>{let t=new Set(e),i=new Set(w);e.forEach(e=>{!i.has(e)&&n.find(t=>t.id===e)&&s.filter(t=>{var n;return null===(n=t.belongs_to)||void 0===n?void 0:n.includes(e)}).forEach(e=>{t.add(e.id)})}),i.forEach(e=>{!t.has(e)&&n.find(t=>t.id===e)&&s.filter(t=>{var n;return null===(n=t.belongs_to)||void 0===n?void 0:n.includes(e)}).forEach(e=>{t.delete(e.id)})}),O(Array.from(t))},onViewMore:()=>{c.onOpen()},numSelected:_,toggle:(0,i.jsx)(v,{id:"".concat(t,"-regulated"),isChecked:h,onChange:()=>u(!h)})}),(0,i.jsx)(S,{groups:n,locations:s,isOpen:c.isOpen,onClose:c.onClose,selected:o,onChange:O},"subgroup-modal-selected-".concat(w.length))]})},O=n(12783),E=e=>{var t;let{data:n}=e,s=(0,l.pmc)(),o=(0,l.qY0)(),[a,f]=(0,d.useState)(null!==(t=n.locations)&&void 0!==t?t:[]),[C,v]=(0,d.useState)(""),[y,{isLoading:w}]=(0,O.WA)(),S=(0,d.useMemo)(()=>(0,k.Il)(n.locations||[],n.location_groups||[]),[n]),b=!r().isEqual(a,n.locations),E=(0,c.useRouter)(),z=()=>{E.push(p.vY).then(()=>{s.closeAll()})},Z=async()=>{let e=await y({locations:a.map(e=>({id:e.id,selected:e.selected})),regulations:[]});(0,x.D4)(e)?s((0,g.Vo)((0,h.e$)(e.error))):s((0,g.t5)((0,i.jsxs)(l.xvT,{display:"inline",children:["Fides has automatically associated the relevant regulations with your location choices."," ",(0,i.jsx)(j.Z,{onClick:z,children:"View regulations here."})]})))},L=e=>{f(a.map(t=>{let n=e.find(e=>e.id===t.id);return null!=n?n:t}))};return(0,i.jsxs)(l.gCW,{alignItems:"start",spacing:4,children:[(0,i.jsx)(l.xuv,{maxWidth:"510px",width:"100%",children:(0,i.jsx)(m.Z,{onChange:v,placeholder:"Search",search:C,onClear:()=>v(""),"data-testid":"search-bar"})}),(0,i.jsx)(l.MIq,{columns:{base:1,md:2,xl:3},spacing:6,width:"100%",children:Object.entries(S).map(e=>{let[t,n]=e;return(0,i.jsx)(_,{title:t,groups:n.locationGroups,locations:n.locations,selected:a.filter(e=>n.locations.find(t=>t.id===e.id)&&e.selected).map(e=>e.id),onChange:L,search:C},t)})}),(0,i.jsx)(u.Z,{isOpen:o.isOpen,onClose:o.onClose,onConfirm:()=>{Z(),o.onClose()},title:"Regulation updates",message:"Modifications in your location settings may also affect your regulation settings to simplify management. You can override any Fides-initiated changes directly in the regulation settings.",isCentered:!0,icon:(0,i.jsx)(l.aNP,{color:"orange"})}),b?(0,i.jsx)(l.zxk,{colorScheme:"primary",size:"sm",onClick:o.onOpen,isLoading:w,"data-testid":"save-btn",children:"Save"}):null]})},z=()=>{let{isLoading:e}=(0,O.QM)(),t=(0,s.C)(O.P8);return(0,i.jsx)(o.Z,{title:"Locations",children:(0,i.jsxs)(l.xuv,{"data-testid":"location-management",children:[(0,i.jsx)(l.X6q,{marginBottom:2,fontSize:"2xl",children:"Locations"}),(0,i.jsxs)(l.xuv,{children:[(0,i.jsx)(l.xvT,{marginBottom:4,fontSize:"sm",maxWidth:"720px",children:"Select the locations that you operate in and Fides will make sure that you are automatically presented with the relevant regulatory guidelines and global frameworks for your locations."}),(0,i.jsx)(l.xuv,{children:e?(0,i.jsx)(l.$jN,{}):(0,i.jsx)(E,{data:t})})]})]})})}}},function(e){e.O(0,[8033,2137,2888,9774,179],function(){return e(e.s=40135)}),_N_E=e.O()}]);