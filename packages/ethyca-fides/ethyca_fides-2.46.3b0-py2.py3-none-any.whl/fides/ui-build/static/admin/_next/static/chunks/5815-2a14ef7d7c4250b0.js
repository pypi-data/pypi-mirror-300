"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5815],{98198:function(e,a,i){var s=i(24246),t=i(37794);a.Z=e=>{let{title:a,children:i,isOpen:n,onClose:r,...o}=e;return(0,s.jsxs)(t.u_l,{isOpen:n,onClose:r,isCentered:!0,scrollBehavior:"inside",size:"xl",...o,children:[(0,s.jsx)(t.ZAr,{}),(0,s.jsxs)(t.hzk,{textAlign:"left",p:0,"data-testid":"add-modal-content",children:[(0,s.jsx)(t.xBx,{p:0,children:(0,s.jsx)(t.xuv,{backgroundColor:"gray.50",px:6,py:4,border:"1px",borderColor:"gray.200",borderTopRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,s.jsx)(t.X6q,{as:"h3",size:"sm",children:a})})}),(0,s.jsx)(t.fef,{pb:4,overflow:"auto",children:i})]})]})}},85815:function(e,a,i){i.d(a,{Z:function(){return S}});var s=i(24246),t=i(37794),n=i(34090),r=i(27378),o=i(59389),l=i(44296),d=i(11596),c=i(34803),u=i(55827),p=i(96878),m=i(22153),v=i(62711),g=i(32141),_=i(34130),h=i(60136),y=i(98198),x=i(16781);let f={name:"",consent_use:"",data_use:"",data_categories:["user"],cookieNames:[],cookies:[]},b=[{label:"Analytics",value:"analytics",description:"Provides analytics for activities such as system and advertising performance reporting, insights and fraud detection."},{label:"Essential",value:"essential",description:"Operates the service or product, including legal obligations, support and basic system operations."},{label:"Functional",value:"functional",description:"Used for specific, necessary, and legitimate purposes."},{label:"Marketing",value:"marketing",description:"Enables marketing, promotion, advertising and sales activities for the product, service, application or system."}],k=e=>b.some(a=>a.value===e.split(".")[0]);var j=i(79851),C=i(94180);let z=e=>{let{index:a,isSuggestion:i,disabled:r}=e;(0,j.fd)();let o=(0,l.C)(j.oW),d=i?"complimentary.500":"gray.800",{values:u}=(0,n.u6)(),p=o.filter(e=>e.value.split(".")[0]===u.privacy_declarations[a].consent_use);return(0,s.jsxs)(t.gCW,{width:"100%",borderRadius:"4px",border:"1px solid",borderColor:"gray.200",spacing:4,p:4,children:[(0,s.jsx)(c.AP,{label:"Consent category",tooltip:"What is the system using the data for. For example, is it for third party advertising or perhaps simply providing system operations.",name:"privacy_declarations.".concat(a,".consent_use"),options:b,variant:"stacked",isRequired:!0,isCustomOption:!0,singleValueBlock:!0,textColor:d,isDisabled:r}),(0,s.jsx)(c.AP,{label:"Detailed consent category (optional)",tooltip:"Select a more specific consent category",name:"privacy_declarations.".concat(a,".data_use"),options:p,variant:"stacked",isCustomOption:!0,singleValueBlock:!0,textColor:d,isDisabled:!u.privacy_declarations[a].consent_use||r}),(0,s.jsx)(c.VT,{label:"Cookie names",name:"privacy_declarations.".concat(a,".cookieNames"),options:[],variant:"stacked",isMulti:!0,textColor:d,isDisabled:r})]})};var w=e=>{var a,i;let{showSuggestions:o,isCreate:d,disabled:c}=e,{values:u,setFieldValue:m}=(0,n.u6)(),{vendor_id:v}=u,{isLoading:g}=(0,p.Wp)({vendor_id:v},{skip:!o||null==v}),_=(0,l.C)((0,p.cL)(v||""));(0,r.useEffect)(()=>{o&&u.vendor_id&&(null==_?void 0:_.length)?m("privacy_declarations",_.filter(e=>k(e.data_use)).map(e=>(0,C.U)(e)).map(e=>{var a,i,s;return{name:null!==(i=e.name)&&void 0!==i?i:"",consent_use:e.data_use.split(".")[0],data_use:e.data_use,data_categories:e.data_categories,cookieNames:(null===(a=e.cookies)||void 0===a?void 0:a.map(e=>e.name))||[],cookies:null!==(s=e.cookies)&&void 0!==s?s:[]}})):d&&m("privacy_declarations",[f])},[o,d,u.vendor_id,_,m]);let h=(null===(a=u.privacy_declarations[u.privacy_declarations.length-1])||void 0===a?void 0:a.data_use)===f.data_use&&(null===(i=u.privacy_declarations[u.privacy_declarations.length-1])||void 0===i?void 0:i.consent_use)===f.consent_use;return g?(0,s.jsx)(t.$jN,{size:"sm",alignSelf:"center"}):(0,s.jsx)(n.F2,{name:"privacy_declarations",render:e=>(0,s.jsxs)(s.Fragment,{children:[u.privacy_declarations.map((e,a)=>(0,s.jsx)(z,{index:a,disabled:c,isSuggestion:o},e.data_use||a)),(0,s.jsx)(t.zxk,{size:"xs",variant:"ghost",colorScheme:"complimentary",onClick:()=>{e.push(f)},isDisabled:h||c,"data-testid":"add-data-use-btn",children:"Add data use +"})]})})};let V={name:"",vendor_id:void 0,privacy_declarations:[f]};var S=e=>{let{buttonLabel:a,buttonVariant:i="primary",onButtonClick:b}=e,k=(0,t.pmc)(),{isOpen:j,onOpen:C,onClose:z}=(0,t.qY0)(),S=(0,l.T)(),[E]=(0,m.in)(),R=(0,r.useMemo)(()=>o.Ry().shape({name:o.Z_().required().label("Vendor name").test("is-unique","",async(e,a)=>{let{data:i}=await E({page:1,size:10,search:e});return!((null==i?void 0:i.items)||[]).some(a=>a.name===e)||a.createError({message:'You already have a vendor called "'.concat(e,'". Please specify a unique name for this vendor.')})})}),[E]),{tcf:q,dictionaryService:D}=(0,d.hz)(),{isLoading:N}=(0,p.Rd)(void 0,{skip:!D}),A=(0,l.C)(p.o),F=(0,l.C)(v.gU),[Z]=(0,m.f7)(),W=(0,l.C)(v.bN),O=()=>{z(),S((0,v.b3)("initial")),S((0,v.gQ)(!1))},B=(0,r.useRef)(null),L=B.current?B.current.values.vendor_id:void 0,M=(0,l.C)((0,p.$e)(L||"")),P=async(e,a)=>{let i=e.privacy_declarations.filter(e=>e.consent_use!==f.consent_use).flatMap(e=>{let a=e.cookieNames.map(a=>{let i=e.cookies.find(e=>e.name===a);return null!=i?i:{name:a,path:"/"}}),{cookieNames:i,consent_use:s,...t}=e;return"marketing"!==e.consent_use||e.data_use?{...t,data_use:e.data_use?e.data_use:e.consent_use,cookies:a}:["marketing.advertising.first_party.targeted","marketing.advertising.third_party.targeted"].map(e=>({...t,data_use:e,cookies:a}))}),s={...M,...e,fides_key:(0,u.E)(e.name),system_type:"",privacy_declarations:i},t=await Z(s);if((0,h.D4)(t)){k((0,x.Vo)((0,h.e$)(t.error)));return}k((0,x.t5)("Vendor successfully created!")),a.resetForm(),O()},Q=e=>{if(D){if(!e){S((0,v.b3)("hiding")),S((0,v.gQ)(!1));return}S((0,v.b3)("showing")),q&&(0,h.cj)(e)===h.c6.GVL?S((0,v.gQ)(!0)):S((0,v.gQ)(!1))}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.zxk,{onClick:()=>{b?b():C()},"data-testid":"add-vendor-btn",..."primary"===i?{size:"sm",colorScheme:"primary"}:{size:"xs",variant:"outline"},children:a}),(0,s.jsx)(n.J9,{initialValues:V,enableReinitialize:!0,onSubmit:P,validationSchema:R,innerRef:B,children:e=>{let{dirty:a,isValid:i,resetForm:r}=e;return(0,s.jsx)(y.Z,{isOpen:j,onClose:O,title:"Add a vendor",children:(0,s.jsxs)(t.xuv,{"data-testid":"add-vendor-modal-content",my:4,children:[F?(0,s.jsx)(g.Z,{}):null,(0,s.jsx)(n.l0,{children:(0,s.jsxs)(t.gCW,{alignItems:"start",spacing:6,children:[D?(0,s.jsx)(_.Z,{label:"Vendor name",options:A,onVendorSelected:Q,isCreate:!0,lockedForGVL:F}):(0,s.jsx)(c.j0,{id:"name",name:"name",isRequired:!0,label:"Vendor name",tooltip:"Give the system a unique, and relevant name for reporting purposes. e.g. “Email Data Warehouse”",variant:"stacked"}),(0,s.jsx)(w,{showSuggestions:"showing"===W,isCreate:!0,disabled:F}),(0,s.jsxs)(t.hE2,{size:"sm",width:"100%",justifyContent:"space-between",children:[(0,s.jsx)(t.zxk,{variant:"outline",onClick:()=>{O(),r()},children:"Cancel"}),(0,s.jsx)(t.zxk,{type:"submit",variant:"primary",isDisabled:N||!a||!i,isLoading:N,"data-testid":"save-btn",children:"Save vendor"})]})]})})]})})}})]})}}}]);