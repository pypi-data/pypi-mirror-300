"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9885],{20133:function(e,t,l){l.d(t,{l:function(){return n}});var i=l(24246);let n=(0,l(37794).IUT)({displayName:"TrashCanSolidIcon",viewBox:"0 0 12 15",path:(0,i.jsx)("path",{d:"M8.37857 1.18083C8.23393 0.892838 7.93661 0.710938 7.6125 0.710938H4.3875C4.06339 0.710938 3.76607 0.892838 3.62143 1.18083L3.42857 1.56094H0.857143C0.383036 1.56094 -1.19209e-07 1.94158 -1.19209e-07 2.41094C-1.19209e-07 2.8803 0.383036 3.26094 0.857143 3.26094H11.1429C11.6162 3.26094 12 2.8803 12 2.41094C12 1.94158 11.6162 1.56094 11.1429 1.56094H8.57143L8.37857 1.18083ZM11.167 4.11094H0.857143V12.6109C0.857143 13.5486 1.62589 14.3109 2.57143 14.3109H9.45268C10.3754 14.3109 11.167 13.5486 11.167 12.6109V4.11094ZM9.02411 6.23594V12.1859C9.02411 12.4197 8.80714 12.6109 8.59554 12.6109C8.33571 12.6109 8.16696 12.4197 8.16696 12.1859V6.23594C8.16696 6.00219 8.33571 5.81094 8.59554 5.81094C8.80714 5.81094 9.02411 6.00219 9.02411 6.23594ZM6.45268 6.23594V12.1859C6.45268 12.4197 6.23571 12.6109 6.02411 12.6109C5.76429 12.6109 5.57143 12.4197 5.57143 12.1859V6.23594C5.57143 6.00219 5.76429 5.81094 6.02411 5.81094C6.23571 5.81094 6.45268 6.00219 6.45268 6.23594ZM3.85714 6.23594V12.1859C3.85714 12.4197 3.66429 12.6109 3.42857 12.6109C3.19286 12.6109 3 12.4197 3 12.1859V6.23594C3 6.00219 3.19286 5.81094 3.42857 5.81094C3.66429 5.81094 3.85714 6.00219 3.85714 6.23594Z",fill:"currentColor"})})},91973:function(e,t,l){l.d(t,{s:function(){return a}});var i=l(24246),n=l(37794),r=l(34090);let a={color:"gray.600",fontSize:"14px",fontWeight:"semibold",minWidth:"150px"};t.Z=e=>{let{customLabelProps:t,disabled:l=!1,displayHelpIcon:s=!0,helpIconVisibility:o=!1,isRequired:d=!1,label:u,type:c="text",placeholder:p,...x}=e,[m,h]=(0,r.U$)(x),{id:v,name:f,autoFocus:C}=x,g="custom-input-".concat(m.name);return(0,i.jsxs)(n.NIc,{display:"flex",isRequired:d,isInvalid:!!(h.error&&h.touched),children:[u&&(0,i.jsx)(n.lXp,{htmlFor:v||f,...t||a,children:u}),(0,i.jsxs)(n.gCW,{align:"flex-start",w:"inherit",children:["number"===c&&(0,i.jsxs)(n.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:0,min:0,size:"sm",children:[(0,i.jsx)(n.zuI,{...m,autoComplete:"off",autoFocus:C,"data-testid":g}),(0,i.jsxs)(n.FiK,{children:[(0,i.jsx)(n.WQu,{}),(0,i.jsx)(n.Y_d,{})]})]}),"text"===c&&(0,i.jsx)(n.IIB,{...m,autoComplete:"off",autoFocus:C,color:"gray.700",isDisabled:l,placeholder:p,size:"sm","data-testid":g}),"textarea"===c&&(0,i.jsx)(n.gxH,{...m,autoComplete:"off",autoFocus:C,color:"gray.700",placeholder:p,resize:"none",size:"sm",value:m.value||"","data-testid":g}),(0,i.jsx)(n.J1D,{children:h.error})]}),s&&(0,i.jsx)(n.kCb,{alignContent:"center",h:"32px",visibility:o?"visible":"hidden",children:(0,i.jsx)(n.ITP,{marginLeft:"8px",_hover:{cursor:"pointer"}})})]})}},79511:function(e,t,l){l.d(t,{k:function(){return r}});var i=l(76649);let n=e=>(0,i.Ln)({id:"string"},e),r=e=>(null!=e?e:[]).filter(n)},19535:function(e,t,l){l.d(t,{m:function(){return o}});var i=l(27378),n=l(11596),r=l(65399),a=l(96878),s=l(79511);let o=e=>{let{resourceFidesKey:t,resourceType:l}=e,{errorAlert:o}=(0,r.VY)(),{plus:d}=(0,n.hz)(),u=(0,i.useMemo)(()=>null!=t?t:"",[]),c=(0,a.YU)(!0,{skip:!d}),p=(0,a.VN)(l,{skip:!d}),{data:x,isLoading:m,error:h,isError:v}=(0,a.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[f]=(0,a._D)(),C=c.isLoading||p.isLoading||m,g=(0,i.useMemo)(()=>new Map((0,s.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),j=(0,i.useMemo)(()=>{var e;return null===(e=p.data)||void 0===e?void 0:e.filter(e=>e.active)},[p.data]),_=(0,i.useMemo)(()=>new Map((0,s.k)(j).map(e=>[e.id,e])),[j]),b=(0,i.useMemo)(()=>v&&(null==h?void 0:h.status)===404?new Map:new Map((0,s.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,v,h]),y=(0,i.useMemo)(()=>{let e=[..._.keys()];return e.sort(),e},[_]),T=(0,i.useMemo)(()=>{let e={};return j&&b&&j.forEach(t=>{let l=b.get(t.id||"");l&&(t.allow_list_id&&"string[]"===t.field_type?e[l.custom_field_definition_id]=l.value:e[l.custom_field_definition_id]=l.value.toString())}),e},[j,b]),S=(0,i.useCallback)(async e=>{if(!d)return;let i="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!i)return;let{customFieldValues:n}=e;if(!n||0===Object.keys(n).length)return;let r=[],a=[];y.forEach(e=>{let t=b.get(e),l=n[e];void 0===l||""===l||Array.isArray(l)&&0===l.length?(null==t?void 0:t.id)&&a.push(t.id):r.push({custom_field_definition_id:e,resource_id:i,id:null==t?void 0:t.id,value:l})});try{await f({resource_type:l,resource_id:i,upsert:r,delete:a})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,b,o,t,y,f,l]);return{customFieldValues:T,definitionIdToCustomField:b,idToAllowListWithOptions:g,idToCustomFieldDefinition:_,isEnabled:d,isLoading:C,sortedCustomFieldDefinitionIds:y,upsertCustomFields:S}}},91591:function(e,t,l){l.d(t,{d:function(){return n}});var i=l(24246);let n=(0,l(37794).IUT)({displayName:"AddIcon",viewBox:"0 0 10 10",path:(0,i.jsx)("path",{d:"M4.33331 4.33398V0.333984H5.66665V4.33398H9.66665V5.66732H5.66665V9.66732H4.33331V5.66732H0.333313V4.33398H4.33331Z",fill:"currentColor"})})},49885:function(e,t,l){l.d(t,{uc:function(){return E},Hn:function(){return o},Uv:function(){return a},C7:function(){return d},mZ:function(){return A.m}});var i,n,r,a,s=l(19686);(i=r||(r={}))[i.CREATE_CUSTOM_FIELDS=0]="CREATE_CUSTOM_FIELDS",i[i.CREATE_CUSTOM_LISTS=1]="CREATE_CUSTOM_LISTS",i[i.CHOOSE_FROM_LIBRARY=2]="CHOOSE_FROM_LIBRARY",s.AL.STRING,s.AL.STRING_,(n=a||(a={})).SINGLE_SELECT="singleSelect",n.MULTIPLE_SELECT="multipleSelect",n.OPEN_TEXT="openText";let o=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open Text",value:"openText"}],d=[{label:"taxonomy:".concat(s.P6.DATA_CATEGORY),value:s.P6.DATA_CATEGORY},{label:"taxonomy:".concat(s.P6.DATA_SUBJECT),value:s.P6.DATA_SUBJECT},{label:"taxonomy:".concat(s.P6.DATA_USE),value:s.P6.DATA_USE},{label:"".concat(s.P6.SYSTEM,":information"),value:s.P6.SYSTEM},{label:"system:data use",value:s.P6.PRIVACY_DECLARATION}];var u=l(24246),c=l(37794),p=l(34090),x=l(27378),m=l(59389),h=l(60136),v=l(65399),f=l(20133),C=l(96878),g=l(91973),j=l(91591);let _=e=>{let{children:t,...l}=e;return(0,u.jsx)(c.gCW,{alignItems:"stretch",flexShrink:0,gap:"18px",overflow:"auto",...l,children:t})},b={allowed_values:[""],description:void 0,id:void 0,name:""},y=m.Ry().shape({name:m.Z_().required("Name is required").trim(),allowed_values:m.IX(m.Z_().required("List item is required")).min(1,"Must add at least one list value").label("allowed_values")});(0,c.Gpc)((e,t)=>{let{onSubmitComplete:l}=e,{errorAlert:i,successAlert:n}=(0,v.VY)(),r=(0,x.useRef)(null),a=(0,x.useRef)(null),[s,o]=(0,x.useState)(!1),[d]=(0,C.Nt)(),m=async(e,t)=>{if(new Set(e.allowed_values.map(e=>e.toLowerCase().trim()).map(e=>e)).size<e.allowed_values.length){i("List item value must be unique");return}let r=await d(e);"error"in r?i((0,h.e$)(r.error),"Custom list has failed to save due to the following:"):(t.resetForm(),n("Custom list successfully saved")),l()};return(0,x.useEffect)(()=>{s&&a.current&&(a.current.scrollIntoView({behavior:"smooth"}),o(!1))},[s]),(0,x.useImperativeHandle)(t,()=>({getDirty(){let e=!1;return r.current&&(e=r.current.dirty),e},submitForm(){r.current&&r.current.submitForm()}}),[]),(0,u.jsx)(_,{children:(0,u.jsx)(p.J9,{enableReinitialize:!0,initialValues:b,innerRef:r,onSubmit:m,validationOnBlur:!1,validationOnChange:!1,validationSchema:y,children:e=>(0,u.jsx)(p.l0,{"data-testid":"create-custom-lists-form",noValidate:!0,children:(0,u.jsxs)(c.kCb,{flexDirection:"column",gap:"12px",paddingTop:"6px",paddingBottom:"24px",children:[(0,u.jsx)(g.Z,{displayHelpIcon:!1,isRequired:!0,label:"Name",name:"name",placeholder:""}),(0,u.jsx)(g.Z,{displayHelpIcon:!1,height:"100px",label:"Description",name:"description",placeholder:"",type:"textarea"}),(0,u.jsx)(p.F2,{name:"allowed_values",render:t=>{let{allowed_values:l}=e.values;return(0,u.jsxs)(c.kCb,{flexDirection:"column",gap:"24px",pl:"24px",children:[(0,u.jsx)(c.kCb,{flexDirection:"column",children:l.map((e,i)=>(0,u.jsxs)(c.kCb,{flexGrow:1,gap:"12px",mt:i>0?"12px":void 0,ref:a,children:[(0,u.jsx)(g.Z,{customLabelProps:{color:"gray.600",fontSize:"sm",fontWeight:"500",lineHeight:"20px",minW:"126px",pr:"8px"},displayHelpIcon:!1,isRequired:!0,label:"List item ".concat(i+1),name:"allowed_values[".concat(i,"]")}),(0,u.jsx)(c.hU,{"aria-label":"Remove this list value","data-testid":"remove-list-value-btn-".concat(i),icon:(0,u.jsx)(f.l,{}),isDisabled:l.length<=1,onClick:()=>t.remove(i),size:"sm",variant:"ghost"})]},i))}),(0,u.jsxs)(c.kCb,{alignItems:"center",children:[(0,u.jsx)(c.xvT,{color:"gray.600",fontSize:"xs",fontWeight:"500",lineHeight:"16px",pr:"8px",children:"Add a list value"}),(0,u.jsx)(c.hU,{"aria-label":"Add a list value","data-testid":"add-list-value-btn",icon:(0,u.jsx)(j.d,{h:"7px",w:"7px"}),onClick:()=>{t.push(""),o(!0)},size:"xs",variant:"outline"}),0===l.length&&(0,u.jsx)(c.xvT,{color:"red.500",pl:"18px",size:"sm",children:e.errors.allowed_values})]})]})}})]})})})})});var T=l(90982),S=l(34803),A=l(19535);let E=e=>{let{resourceFidesKey:t,resourceType:l}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:n,isEnabled:r,isLoading:a,sortedCustomFieldDefinitionIds:o}=(0,A.m)({resourceFidesKey:t,resourceType:l});return r&&0!==o.length?(0,u.jsx)(T.Z,{heading:"Custom fields",children:(0,u.jsx)(c.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,u.jsx)(c.kCb,{flexDir:"column",gap:"24px",children:a?(0,u.jsx)(c.M5Y,{children:(0,u.jsx)(c.$jN,{})}):o.length>0&&(0,u.jsx)(c.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:o.map(e=>{let t=n.get(e);if(!t)return null;let l="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===s.AL.STRING)return(0,u.jsx)(p.gN,{name:l,children:e=>{let{field:l}=e;return(0,u.jsx)(S.j0,{...l,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let r=i.get(t.allow_list_id);if(!r)return null;let{options:a}=r;return(0,u.jsx)(p.gN,{name:l,children:e=>{let{field:l}=e;return(0,u.jsx)(S.AP,{...l,isClearable:!0,isFormikOnChange:!0,isMulti:t.field_type!==s.AL.STRING,label:t.name,options:a,tooltip:t.description,variant:"stacked"})}},e)})})})})}):null};l(79511)},65399:function(e,t,l){l.d(t,{HK:function(){return r},VY:function(){return i.V},O3:function(){return s}});var i=l(75139),n=l(60136);let r=()=>{let{errorAlert:e}=(0,i.V)();return{handleError:t=>{let l="An unexpected error occurred. Please try again.";(0,n.Ot)(t)?l=t.data.detail:(0,n.tB)(t)&&(l=t.data.detail[0].msg),e(l)}}};var a=l(27378);let s=e=>{let t=(0,a.useRef)(void 0);return(0,a.useEffect)(()=>{let l=l=>{var i;(null===(i=t.current)||void 0===i?void 0:i.contains(l.target))||e()};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[t,e]),{ref:t}}},75139:function(e,t,l){l.d(t,{V:function(){return r}});var i=l(24246),n=l(37794);let r=()=>{let e=(0,n.pmc)();return{errorAlert:(t,l,r)=>{let a={...r,position:(null==r?void 0:r.position)||"top",render:e=>{let{onClose:r}=e;return(0,i.jsxs)(n.bZj,{alignItems:"normal",status:"error",children:[(0,i.jsx)(n.zMQ,{}),(0,i.jsxs)(n.xuv,{children:[l&&(0,i.jsx)(n.CdC,{children:l}),(0,i.jsx)(n.XaZ,{children:t})]}),(0,i.jsx)(n.PZ7,{onClick:r,position:"relative",right:0,size:"sm",top:-1})]})}};(null==r?void 0:r.id)&&e.isActive(r.id)?e.update(r.id,a):e(a)},successAlert:(t,l,r)=>{let a={...r,position:(null==r?void 0:r.position)||"top",render:e=>{let{onClose:r}=e;return(0,i.jsxs)(n.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,i.jsx)(n.zMQ,{}),(0,i.jsxs)(n.xuv,{children:[l&&(0,i.jsx)(n.CdC,{children:l}),(0,i.jsx)(n.XaZ,{children:t})]}),(0,i.jsx)(n.PZ7,{onClick:r,position:"relative",right:0,size:"sm",top:-1})]})}};(null==r?void 0:r.id)&&e.isActive(r.id)?e.update(r.id,a):e(a)}}}},90982:function(e,t,l){var i=l(24246),n=l(37794);t.Z=e=>{let{heading:t,HeadingButton:l,children:r}=e;return(0,i.jsx)(n.Kqy,{spacing:4,children:(0,i.jsxs)(n.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,i.jsxs)(n.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,i.jsx)(n.X6q,{as:"h3",size:"xs",children:t}),l?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.LZC,{}),(0,i.jsx)(l,{})]}):null]}),(0,i.jsx)(n.Kqy,{spacing:4,px:6,py:6,children:r})]})})}}}]);