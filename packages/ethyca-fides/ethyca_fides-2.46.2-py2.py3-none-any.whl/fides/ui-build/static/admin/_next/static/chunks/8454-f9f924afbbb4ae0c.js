"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8454],{20133:function(e,i,t){t.d(i,{l:function(){return r}});var l=t(24246);let r=(0,t(13054).IUT)({displayName:"TrashCanSolidIcon",viewBox:"0 0 12 15",path:(0,l.jsx)("path",{d:"M8.37857 1.18083C8.23393 0.892838 7.93661 0.710938 7.6125 0.710938H4.3875C4.06339 0.710938 3.76607 0.892838 3.62143 1.18083L3.42857 1.56094H0.857143C0.383036 1.56094 -1.19209e-07 1.94158 -1.19209e-07 2.41094C-1.19209e-07 2.8803 0.383036 3.26094 0.857143 3.26094H11.1429C11.6162 3.26094 12 2.8803 12 2.41094C12 1.94158 11.6162 1.56094 11.1429 1.56094H8.57143L8.37857 1.18083ZM11.167 4.11094H0.857143V12.6109C0.857143 13.5486 1.62589 14.3109 2.57143 14.3109H9.45268C10.3754 14.3109 11.167 13.5486 11.167 12.6109V4.11094ZM9.02411 6.23594V12.1859C9.02411 12.4197 8.80714 12.6109 8.59554 12.6109C8.33571 12.6109 8.16696 12.4197 8.16696 12.1859V6.23594C8.16696 6.00219 8.33571 5.81094 8.59554 5.81094C8.80714 5.81094 9.02411 6.00219 9.02411 6.23594ZM6.45268 6.23594V12.1859C6.45268 12.4197 6.23571 12.6109 6.02411 12.6109C5.76429 12.6109 5.57143 12.4197 5.57143 12.1859V6.23594C5.57143 6.00219 5.76429 5.81094 6.02411 5.81094C6.23571 5.81094 6.45268 6.00219 6.45268 6.23594ZM3.85714 6.23594V12.1859C3.85714 12.4197 3.66429 12.6109 3.42857 12.6109C3.19286 12.6109 3 12.4197 3 12.1859V6.23594C3 6.00219 3.19286 5.81094 3.42857 5.81094C3.66429 5.81094 3.85714 6.00219 3.85714 6.23594Z",fill:"currentColor"})})},91973:function(e,i,t){t.d(i,{s:function(){return s}});var l=t(24246),r=t(13054),n=t(34090);let s={color:"gray.600",fontSize:"14px",fontWeight:"semibold",minWidth:"150px"};i.Z=e=>{let{customLabelProps:i,disabled:t=!1,displayHelpIcon:a=!0,helpIconVisibility:o=!1,isRequired:d=!1,label:u,type:c="text",placeholder:m,...p}=e,[x,h]=(0,n.U$)(p),{id:f,name:v,autoFocus:g}=p,j="custom-input-".concat(x.name);return(0,l.jsxs)(r.NIc,{display:"flex",isRequired:d,isInvalid:!!(h.error&&h.touched),children:[u&&(0,l.jsx)(r.lXp,{htmlFor:f||v,...i||s,children:u}),(0,l.jsxs)(r.gCW,{align:"flex-start",w:"inherit",children:["number"===c&&(0,l.jsxs)(r.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:0,min:0,size:"sm",children:[(0,l.jsx)(r.zuI,{...x,autoComplete:"off",autoFocus:g,"data-testid":j}),(0,l.jsxs)(r.FiK,{children:[(0,l.jsx)(r.WQu,{}),(0,l.jsx)(r.Y_d,{})]})]}),"text"===c&&(0,l.jsx)(r.IIB,{...x,autoComplete:"off",autoFocus:g,color:"gray.700",isDisabled:t,placeholder:m,size:"sm","data-testid":j}),"textarea"===c&&(0,l.jsx)(r.gxH,{...x,autoComplete:"off",autoFocus:g,color:"gray.700",placeholder:m,resize:"none",size:"sm",value:x.value||"","data-testid":j}),(0,l.jsx)(r.J1D,{children:h.error})]}),a&&(0,l.jsx)(r.kCb,{alignContent:"center",h:"32px",visibility:o?"visible":"hidden",children:(0,l.jsx)(r.ITP,{marginLeft:"8px",_hover:{cursor:"pointer"}})})]})}},79511:function(e,i,t){t.d(i,{k:function(){return n}});var l=t(76649);let r=e=>(0,l.Ln)({id:"string"},e),n=e=>(null!=e?e:[]).filter(r)},19535:function(e,i,t){t.d(i,{m:function(){return o}});var l=t(27378),r=t(11596),n=t(65399),s=t(96878),a=t(79511);let o=e=>{let{resourceFidesKey:i,resourceType:t}=e,{errorAlert:o}=(0,n.VY)(),{plus:d}=(0,r.hz)(),u=(0,l.useMemo)(()=>null!=i?i:"",[]),c=(0,s.YU)(!0,{skip:!d}),m=(0,s.VN)(t,{skip:!d}),{data:p,isLoading:x,error:h,isError:f}=(0,s.PV)(null!=i?i:"",{skip:""!==u&&!(d&&u)}),[v]=(0,s._D)(),g=c.isLoading||m.isLoading||x,j=(0,l.useMemo)(()=>new Map((0,a.k)(c.data).map(e=>{var i;return[e.id,{...e,options:(null!==(i=e.allowed_values)&&void 0!==i?i:[]).map(e=>({value:e,label:e}))}]})),[c.data]),C=(0,l.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),b=(0,l.useMemo)(()=>new Map((0,a.k)(C).map(e=>[e.id,e])),[C]),_=(0,l.useMemo)(()=>f&&(null==h?void 0:h.status)===404?new Map:new Map((0,a.k)(p).map(e=>[e.custom_field_definition_id,e])),[p,f,h]),y=(0,l.useMemo)(()=>{let e=[...b.keys()];return e.sort(),e},[b]),S=(0,l.useMemo)(()=>{let e={};return C&&_&&C.forEach(i=>{let t=_.get(i.id||"");t&&(i.allow_list_id&&"string[]"===i.field_type?e[t.custom_field_definition_id]=t.value:e[t.custom_field_definition_id]=t.value.toString())}),e},[C,_]),T=(0,l.useCallback)(async e=>{if(!d)return;let l="fides_key"in e&&""!==e.fides_key?e.fides_key:i;if(!l)return;let{customFieldValues:r}=e;if(!r||0===Object.keys(r).length)return;let n=[],s=[];y.forEach(e=>{let i=_.get(e),t=r[e];void 0===t||""===t||Array.isArray(t)&&0===t.length?(null==i?void 0:i.id)&&s.push(i.id):n.push({custom_field_definition_id:e,resource_id:l,id:null==i?void 0:i.id,value:t})});try{await v({resource_type:t,resource_id:l,upsert:n,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,_,o,i,y,v,t]);return{customFieldValues:S,definitionIdToCustomField:_,idToAllowListWithOptions:j,idToCustomFieldDefinition:b,isEnabled:d,isLoading:g,sortedCustomFieldDefinitionIds:y,upsertCustomFields:T}}},91591:function(e,i,t){t.d(i,{d:function(){return r}});var l=t(24246);let r=(0,t(13054).IUT)({displayName:"AddIcon",viewBox:"0 0 10 10",path:(0,l.jsx)("path",{d:"M4.33331 4.33398V0.333984H5.66665V4.33398H9.66665V5.66732H5.66665V9.66732H4.33331V5.66732H0.333313V4.33398H4.33331Z",fill:"currentColor"})})},8454:function(e,i,t){t.d(i,{uc:function(){return E},Hn:function(){return g},Uv:function(){return s},C7:function(){return j},mZ:function(){return D.m}});var l,r,n,s,a=t(24246),o=t(13054),d=t(34090),u=t(27378),c=t(60136),m=t(65399),p=t(96878);let x=e=>{let{children:i,...t}=e;return(0,a.jsx)(o.gCW,{alignItems:"stretch",flexShrink:0,gap:"18px",overflow:"auto",...t,children:i})},h={customFieldDefinitions:[]};(0,o.Gpc)((e,i)=>{let{onSubmitComplete:t,resourceType:l}=e,{errorAlert:r,successAlert:n}=(0,m.VY)(),s=(0,u.useRef)(null),{data:f,isFetching:v,isLoading:g,isSuccess:j}=(0,p.VN)(l),[C]=(0,p.yM)();h.customFieldDefinitions=(0,u.useMemo)(()=>f||[],[f]);let b=async(e,i)=>{var l;let s=e.customFieldDefinitions.filter(e=>h.customFieldDefinitions.some(i=>i.id===e.id&&i.active!==e.active));if(0===s.length)return;let a=await Promise.all(s.map(e=>C(e))),o=null!==(l=a.find(e=>"error"in e))&&void 0!==l?l:a[0];"error"in o?r((0,c.e$)(o.error),"One or more custom field(s) failed to update due to the following:",{containerStyle:{maxWidth:"max-content"}}):(i.resetForm(),n("Custom field(s) successfully saved")),t()};return(0,u.useImperativeHandle)(i,()=>({getDirty(){let e=!1;return s.current&&(e=s.current.dirty),e},submitForm(){s.current&&s.current.submitForm()}}),[]),(0,a.jsxs)(x,{children:[(v||g)&&(0,a.jsx)(o.M5Y,{children:(0,a.jsx)(o.$jN,{})}),j&&f&&(0,a.jsx)(d.J9,{enableReinitialize:!0,initialValues:h,innerRef:s,onSubmit:b,validationOnBlur:!1,validationOnChange:!1,children:e=>(0,a.jsx)(d.l0,{"data-testid":"choose-from-library-form",noValidate:!0,children:(0,a.jsx)(o.kCb,{flexDirection:"column",gap:"12px",paddingTop:"6px",paddingBottom:"24px",children:(0,a.jsx)(d.F2,{name:"customFieldDefinitions",render:()=>{let{customFieldDefinitions:i}=e.values;return(0,a.jsx)(o.kCb,{flexDirection:"column",gap:"24px",children:(0,a.jsx)(o.kCb,{flexDirection:"column",children:i.map((e,i)=>(0,a.jsxs)(o.kCb,{alignItems:"baseline",flexGrow:1,gap:"12px",mt:i>0?"12px":void 0,mr:"16px",children:[(0,a.jsx)(o.NIc,{display:"flex",children:(0,a.jsx)(o.lXp,{htmlFor:"customFieldDefinitions[".concat(i,"]"),color:"gray.600",fontSize:"14px",fontWeight:"medium",minWidth:"150px",children:e.name})}),(0,a.jsx)(o.LZC,{}),(0,a.jsx)(d.gN,{name:"customFieldDefinitions[".concat(i,"].active"),children:i=>{let{field:t}=i;return(0,a.jsx)(o.rsf,{...t,colorScheme:"secondary",isChecked:e.active,onChange:e=>{t.onChange(e)},size:"sm"})}})]},e.id))})})}})})})})]})});var f=t(19686);(l=n||(n={}))[l.CREATE_CUSTOM_FIELDS=0]="CREATE_CUSTOM_FIELDS",l[l.CREATE_CUSTOM_LISTS=1]="CREATE_CUSTOM_LISTS",l[l.CHOOSE_FROM_LIBRARY=2]="CHOOSE_FROM_LIBRARY";let v=[{label:"Single select",value:f.AL.STRING},{label:"Multiple select",value:f.AL.STRING_}];(r=s||(s={})).SINGLE_SELECT="singleSelect",r.MULTIPLE_SELECT="multipleSelect",r.OPEN_TEXT="openText";let g=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open Text",value:"openText"}],j=[{label:"taxonomy:".concat(f.P6.DATA_CATEGORY),value:f.P6.DATA_CATEGORY},{label:"taxonomy:".concat(f.P6.DATA_SUBJECT),value:f.P6.DATA_SUBJECT},{label:"taxonomy:".concat(f.P6.DATA_USE),value:f.P6.DATA_USE},{label:"".concat(f.P6.SYSTEM,":information"),value:f.P6.SYSTEM},{label:"system:data use",value:f.P6.PRIVACY_DECLARATION}];var C=t(76649),b=t(59389),_=t(34803),y=t(91973);let S={active:!0,allow_list_id:void 0,description:void 0,field_type:f.AL.STRING,name:"",resource_type:f.P6.DATA_CATEGORY},T=b.Ry().shape({allow_list_id:b.Z_().required("Select custom list is required"),name:b.Z_().required("Name is required").trim()});(0,o.Gpc)((e,i)=>{var t;let{onSubmitComplete:l,resourceType:r}=e,{errorAlert:n,successAlert:s}=(0,m.VY)(),h=(0,u.useRef)(null),{data:f}=(0,p.YU)(!1),[g]=(0,p.Ld)(),b=async(e,i)=>{let t=await g(e);"error"in t?n((0,c.e$)(t.error),"Custom field has failed to save due to the following:"):(i.resetForm(),s("Custom field successfully saved")),l()},k=(0,u.useMemo)(()=>(null!=f?f:[]).filter((0,C.uX)({name:"string",id:"string"})).map(e=>({label:e.name,value:e.id})),[f]);(0,u.useImperativeHandle)(i,()=>({getDirty(){let e=!1;return h.current&&(e=h.current.dirty),e},submitForm(){h.current&&h.current.submitForm()}}),[]);let w={...S,resource_type:r,allow_list_id:null===(t=k[0])||void 0===t?void 0:t.value};return(0,a.jsx)(x,{children:(0,a.jsx)(d.J9,{enableReinitialize:!0,initialValues:w,innerRef:h,onSubmit:b,validationOnBlur:!1,validationOnChange:!1,validationSchema:T,children:e=>(0,a.jsxs)(d.l0,{"data-testid":"create-custom-fields-form",noValidate:!0,children:[(0,a.jsxs)(o.kCb,{flexDirection:"column",gap:"12px",paddingTop:"6px",paddingBottom:"24px",children:[(0,a.jsx)(y.Z,{displayHelpIcon:!1,isRequired:!0,label:"Name",name:"name",placeholder:""}),(0,a.jsx)(y.Z,{displayHelpIcon:!1,height:"100px",label:"Description",name:"description",placeholder:"",type:"textarea"}),(0,a.jsx)(_.AP,{label:"Field type",labelProps:y.s,name:"field_type",options:v}),(0,a.jsx)(_.AP,{isRequired:!0,label:"Select custom list",labelProps:y.s,menuPosition:"fixed",name:"allow_list_id",options:k}),(0,a.jsx)(_.AP,{isDisabled:!0,label:"Resource type",labelProps:y.s,name:"resource_type",options:j})]}),(0,a.jsxs)(o.kCb,{background:"gray.50",border:"1px solid",borderColor:"gray.200",borderRadius:"6px",flexDirection:"column",gap:"4px",padding:"16px",children:[(0,a.jsxs)(o.kCb,{children:[(0,a.jsx)(o.xvT,{color:"gray.600",fontWeight:"semibold",lineHeight:"20px",size:"sm",children:"Show in forms and reports"}),(0,a.jsx)(o.LZC,{}),(0,a.jsx)(d.gN,{name:"active",children:i=>{let{field:t}=i;return(0,a.jsx)(o.rsf,{...t,colorScheme:"secondary",isChecked:e.values.active,onChange:e=>{t.onChange(e)},size:"sm"})}})]}),(0,a.jsx)(o.xvT,{color:"gray.600",fontWeight:"light",lineHeight:"20px",size:"sm",children:"Turn this off to hide this field from this form and data map reports. You can turn hidden fields back on at any time from the library tab."})]})]})})})});var k=t(20133),w=t(91591);let A={allowed_values:[""],description:void 0,id:void 0,name:""},R=b.Ry().shape({name:b.Z_().required("Name is required").trim(),allowed_values:b.IX(b.Z_().required("List item is required")).min(1,"Must add at least one list value").label("allowed_values")});(0,o.Gpc)((e,i)=>{let{onSubmitComplete:t}=e,{errorAlert:l,successAlert:r}=(0,m.VY)(),n=(0,u.useRef)(null),s=(0,u.useRef)(null),[h,f]=(0,u.useState)(!1),[v]=(0,p.Nt)(),g=async(e,i)=>{if(new Set(e.allowed_values.map(e=>e.toLowerCase().trim()).map(e=>e)).size<e.allowed_values.length){l("List item value must be unique");return}let n=await v(e);"error"in n?l((0,c.e$)(n.error),"Custom list has failed to save due to the following:"):(i.resetForm(),r("Custom list successfully saved")),t()};return(0,u.useEffect)(()=>{h&&s.current&&(s.current.scrollIntoView({behavior:"smooth"}),f(!1))},[h]),(0,u.useImperativeHandle)(i,()=>({getDirty(){let e=!1;return n.current&&(e=n.current.dirty),e},submitForm(){n.current&&n.current.submitForm()}}),[]),(0,a.jsx)(x,{children:(0,a.jsx)(d.J9,{enableReinitialize:!0,initialValues:A,innerRef:n,onSubmit:g,validationOnBlur:!1,validationOnChange:!1,validationSchema:R,children:e=>(0,a.jsx)(d.l0,{"data-testid":"create-custom-lists-form",noValidate:!0,children:(0,a.jsxs)(o.kCb,{flexDirection:"column",gap:"12px",paddingTop:"6px",paddingBottom:"24px",children:[(0,a.jsx)(y.Z,{displayHelpIcon:!1,isRequired:!0,label:"Name",name:"name",placeholder:""}),(0,a.jsx)(y.Z,{displayHelpIcon:!1,height:"100px",label:"Description",name:"description",placeholder:"",type:"textarea"}),(0,a.jsx)(d.F2,{name:"allowed_values",render:i=>{let{allowed_values:t}=e.values;return(0,a.jsxs)(o.kCb,{flexDirection:"column",gap:"24px",pl:"24px",children:[(0,a.jsx)(o.kCb,{flexDirection:"column",children:t.map((e,l)=>(0,a.jsxs)(o.kCb,{flexGrow:1,gap:"12px",mt:l>0?"12px":void 0,ref:s,children:[(0,a.jsx)(y.Z,{customLabelProps:{color:"gray.600",fontSize:"sm",fontWeight:"500",lineHeight:"20px",minW:"126px",pr:"8px"},displayHelpIcon:!1,isRequired:!0,label:"List item ".concat(l+1),name:"allowed_values[".concat(l,"]")}),(0,a.jsx)(o.hU,{"aria-label":"Remove this list value","data-testid":"remove-list-value-btn-".concat(l),icon:(0,a.jsx)(k.l,{}),isDisabled:t.length<=1,onClick:()=>i.remove(l),size:"sm",variant:"ghost"})]},l))}),(0,a.jsxs)(o.kCb,{alignItems:"center",children:[(0,a.jsx)(o.xvT,{color:"gray.600",fontSize:"xs",fontWeight:"500",lineHeight:"16px",pr:"8px",children:"Add a list value"}),(0,a.jsx)(o.hU,{"aria-label":"Add a list value","data-testid":"add-list-value-btn",icon:(0,a.jsx)(w.d,{h:"7px",w:"7px"}),onClick:()=>{i.push(""),f(!0)},size:"xs",variant:"outline"}),0===t.length&&(0,a.jsx)(o.xvT,{color:"red.500",pl:"18px",size:"sm",children:e.errors.allowed_values})]})]})}})]})})})})});var I=t(90982),D=t(19535);let E=e=>{let{resourceFidesKey:i,resourceType:t}=e,{idToAllowListWithOptions:l,idToCustomFieldDefinition:r,isEnabled:n,isLoading:s,sortedCustomFieldDefinitionIds:u}=(0,D.m)({resourceFidesKey:i,resourceType:t});return n&&0!==u.length?(0,a.jsx)(I.Z,{heading:"Custom fields",children:(0,a.jsx)(o.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,a.jsx)(o.kCb,{flexDir:"column",gap:"24px",children:s?(0,a.jsx)(o.M5Y,{children:(0,a.jsx)(o.$jN,{})}):u.length>0&&(0,a.jsx)(o.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:u.map(e=>{let i=r.get(e);if(!i)return null;let t="customFieldValues.".concat(i.id);if(!i.allow_list_id&&i.field_type===f.AL.STRING)return(0,a.jsx)(d.gN,{name:t,children:e=>{let{field:t}=e;return(0,a.jsx)(_.j0,{...t,label:i.name,tooltip:i.description,variant:"stacked"})}},e);let n=l.get(i.allow_list_id);if(!n)return null;let{options:s}=n;return(0,a.jsx)(d.gN,{name:t,children:e=>{let{field:t}=e;return(0,a.jsx)(_.AP,{...t,isClearable:!0,isFormikOnChange:!0,isMulti:i.field_type!==f.AL.STRING,label:i.name,options:s,tooltip:i.description,variant:"stacked"})}},e)})})})})}):null};t(79511)},65399:function(e,i,t){t.d(i,{HK:function(){return n},VY:function(){return l.V},O3:function(){return a}});var l=t(75139),r=t(60136);let n=()=>{let{errorAlert:e}=(0,l.V)();return{handleError:i=>{let t="An unexpected error occurred. Please try again.";(0,r.Ot)(i)?t=i.data.detail:(0,r.tB)(i)&&(t=i.data.detail[0].msg),e(t)}}};var s=t(27378);let a=e=>{let i=(0,s.useRef)(void 0);return(0,s.useEffect)(()=>{let t=t=>{var l;(null===(l=i.current)||void 0===l?void 0:l.contains(t.target))||e()};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[i,e]),{ref:i}}},75139:function(e,i,t){t.d(i,{V:function(){return n}});var l=t(24246),r=t(13054);let n=()=>{let e=(0,r.pmc)();return{errorAlert:(i,t,n)=>{let s={...n,position:(null==n?void 0:n.position)||"top",render:e=>{let{onClose:n}=e;return(0,l.jsxs)(r.bZj,{alignItems:"normal",status:"error",children:[(0,l.jsx)(r.zMQ,{}),(0,l.jsxs)(r.xuv,{children:[t&&(0,l.jsx)(r.CdC,{children:t}),(0,l.jsx)(r.XaZ,{children:i})]}),(0,l.jsx)(r.PZ7,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}};(null==n?void 0:n.id)&&e.isActive(n.id)?e.update(n.id,s):e(s)},successAlert:(i,t,n)=>{let s={...n,position:(null==n?void 0:n.position)||"top",render:e=>{let{onClose:n}=e;return(0,l.jsxs)(r.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,l.jsx)(r.zMQ,{}),(0,l.jsxs)(r.xuv,{children:[t&&(0,l.jsx)(r.CdC,{children:t}),(0,l.jsx)(r.XaZ,{children:i})]}),(0,l.jsx)(r.PZ7,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}};(null==n?void 0:n.id)&&e.isActive(n.id)?e.update(n.id,s):e(s)}}}},90982:function(e,i,t){var l=t(24246),r=t(13054);i.Z=e=>{let{heading:i,HeadingButton:t,children:n}=e;return(0,l.jsx)(r.Kqy,{spacing:4,children:(0,l.jsxs)(r.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,l.jsxs)(r.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,l.jsx)(r.X6q,{as:"h3",size:"xs",children:i}),t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.LZC,{}),(0,l.jsx)(t,{})]}):null]}),(0,l.jsx)(r.Kqy,{spacing:4,px:6,py:6,children:n})]})})}}}]);