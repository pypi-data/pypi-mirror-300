"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6796],{51425:function(e,n,a){var i=a(24246),l=a(37794),t=a(39514);n.Z=e=>{let{title:n,tooltip:a,children:s,...r}=e;return(0,i.jsxs)(l.xuv,{borderRadius:"md",border:"1px solid",borderColor:"gray.200",...r,children:[(0,i.jsxs)(l.X6q,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[n,a?(0,i.jsx)(l.xvT,{as:"span",mx:1,children:(0,i.jsx)(t.Z,{label:a})}):void 0]}),(0,i.jsx)(l.Kqy,{p:6,spacing:6,children:s})]})}},26796:function(e,n,a){a.d(n,{Z:function(){return D}});var i=a(24246),l=a(69883),t=a(6903),s=a(37794),r=a(34090),o=a(86677),d=a(27378),c=a(44296),u=a(51425),m=a(34803),g=a(60136),v=a(11032),h=a(43938),x=a(39514),p=a(16781),j=a(79851),b=a(35051),_=a(31241),f=a(27365);let y=e=>{let{index:n}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.j0,{autoFocus:0!==n,name:"translations.".concat(n,".title"),label:"Title of privacy notice as displayed to user",variant:"stacked"}),(0,i.jsx)(m.Ks,{name:"translations.".concat(n,".description"),label:"Privacy notice displayed to the user",variant:"stacked"})]})},C=e=>{let{index:n,name:a,isOOB:l}=e;return(0,i.jsxs)(s.kCb,{direction:"column",gap:6,children:[(0,i.jsxs)(s.X6q,{size:"sm",children:["Edit ",a," translation"]}),l?(0,i.jsx)(_.f,{languageName:a}):null,(0,i.jsx)(y,{index:n})]})},k=e=>{let{translation:n,name:a,onLanguageDeleted:l}=e;return(0,i.jsxs)(s.kCb,{gap:2,direction:"row",w:"100%",children:[(0,i.jsx)(s.OK9,{as:s.zxk,variant:"outline",size:"sm",fontWeight:"normal",w:"100%",_selected:{color:"white",bg:"gray.500"},children:a},n.language),l?(0,i.jsx)(s.hU,{"aria-label":"Delete translation",variant:"outline",size:"sm",onClick:()=>l(n.language),children:(0,i.jsx)(s.pJl,{boxSize:4})}):null]})};var w=e=>{var n;let{availableTranslations:a}=e,{values:t,setFieldValue:o}=(0,r.u6)(),[g,v]=(0,d.useState)(!1),[h,x]=(0,d.useState)(!1),[p,j]=(0,d.useState)(0),{data:_}=(0,f.tB)({api_set:!1}),w=null==_?void 0:null===(n=_.plus_consent_settings)||void 0===n?void 0:n.enable_translations,N=(0,c.C)(b.Zp),P=(0,c.C)(b.G1);(0,b.Ah)({page:N,size:P});let z=(0,c.C)(b.fJ).slice().sort((e,n)=>e.name.localeCompare(n.name)),T=z.filter(e=>{var n;return null===(n=t.translations)||void 0===n?void 0:n.every(n=>n.language!==e.id)}).map(e=>({label:e.name,value:e.id})),S=e=>{let n=null==a?void 0:a.find(n=>n.language===e);x(!!n),j(t.translations.length),o("translations",[...t.translations,null!=n?n:{language:e,title:"",description:""}]),v(!1)},E=e=>{let n=t.translations?t.translations.slice().filter(n=>n.language!==e):[],a=p===n.length?n.length-1:p;o("translations",n),j(a)},Z=e=>{var n,a;return null!==(a=null===(n=z.find(n=>n.id===e))||void 0===n?void 0:n.name)&&void 0!==a?a:e};return w?(0,i.jsx)(u.Z,{title:"Localizations",children:(0,i.jsxs)(s.mQc,{index:p,onChange:e=>{j(e),x(!1)},as:s.Ugi,spacing:8,align:"start",w:"100%",orientation:"vertical",variant:"unstyled",children:[(0,i.jsxs)(s.gCW,{spacing:4,minW:"30%",p:2,children:[(0,i.jsx)(s.tdY,{w:"100%",children:(0,i.jsx)(s.gCW,{spacing:2,w:"100%",p:4,maxH:60,overflow:"scroll",outline:"1px solid",outlineColor:"gray.200",borderRadius:"md",children:t.translations.map(e=>(0,i.jsx)(k,{translation:e,name:Z(e.language),onLanguageDeleted:E},e.language))})}),g?(0,i.jsx)(s.xuv,{w:"full","data-testid":"select-language",children:(0,i.jsx)(l.Z,{chakraStyles:m.hP,size:"sm",options:T,onChange:e=>S(e.value),autoFocus:!0,classNamePrefix:"select-language",menuPlacement:"auto"})}):null,!g&&T.length?(0,i.jsx)(s.zxk,{leftIcon:(0,i.jsx)(s.jBn,{boxSize:6}),w:"full",variant:"outline",size:"sm",onClick:()=>v(!0),"data-testid":"add-language-btn",children:"Add a language"}):null]}),(0,i.jsx)(s.xuv,{w:"100%",children:(0,i.jsx)(r.F2,{name:"translations",render:()=>(0,i.jsx)(s.nPR,{w:"100%",children:t.translations.map((e,n)=>(0,i.jsx)(s.x45,{children:(0,i.jsx)(C,{index:n,name:Z(e.language),isOOB:h})},e.language))})})})]})}):(0,i.jsx)(u.Z,{title:"Notice text",children:(0,i.jsx)(y,{index:0})})},N=a(59389),P=a(94167),z=a(69236),T=a(19686);let S=(0,P.Jt)(z.ye),E=(0,P.Jt)(z.B8),Z=[{language:T.eU.EN,title:"",description:""}],O={name:"",consent_mechanism:T.J7.OPT_IN,data_uses:[],enforcement_level:T.QT.FRONTEND,disabled:!0,translations:Z,children:[]},R=e=>{var n,a,i,l;return{name:null!==(n=e.name)&&void 0!==n?n:O.name,consent_mechanism:null!==(a=e.consent_mechanism)&&void 0!==a?a:O.consent_mechanism,data_uses:null!==(i=e.data_uses)&&void 0!==i?i:O.data_uses,enforcement_level:null!==(l=e.enforcement_level)&&void 0!==l?l:O.enforcement_level,notice_key:e.notice_key,disabled:e.disabled,has_gpc_flag:e.has_gpc_flag,id:e.id,internal_description:e.internal_description,translations:e.translations?e.translations.map(e=>{var n;let{privacy_notice_history_id:a,...i}=e;return{...i,title:null!==(n=e.title)&&void 0!==n?n:""}}):Z,children:e.children}},q=N.Ry().shape({name:N.Z_().required().label("Title"),consent_mechanism:N.Z_().required().label("Consent mechanism")});var I=a(14441),J=a.n(I),F=e=>{let{isEditing:n}=e,{values:a,setFieldValue:l}=(0,r.u6)();return(0,d.useEffect)(()=>{n||l("notice_key",J()(a.name))},[a.name,n,l]),(0,i.jsx)(m.j0,{name:"notice_key",label:"Key used in Fides cookie",variant:"stacked"})},L=a(40793);let A=e=>{var n;let{regions:a,label:t,tooltip:r}=e;return(0,i.jsxs)(s.gCW,{align:"start",children:[(0,i.jsxs)(s.kCb,{align:"start",children:[t?(0,i.jsx)(s.lXp,{htmlFor:"regions",fontSize:"xs",my:0,mr:1,children:t}):null,r?(0,i.jsx)(x.Z,{label:r}):null]}),(0,i.jsx)(s.xuv,{w:"100%","data-testid":"notice-locations",children:(0,i.jsx)(l.Z,{chakraStyles:{...m.hP,dropdownIndicator:e=>({...e,display:"none"}),multiValueRemove:e=>({...e,display:"none"})},classNamePrefix:"notice-locations",size:"sm",isMulti:!0,isDisabled:!0,placeholder:"No locations assigned",value:null!==(n=null==a?void 0:a.map(e=>({label:h.Z8[e],value:e})))&&void 0!==n?n:[]})})]})};var D=e=>{let{privacyNotice:n,availableTranslations:a}=e,l=(0,o.useRouter)(),h=(0,s.pmc)(),x=n?R(n):O;(0,j.fd)();let b=(0,c.C)(j.qv),_=(0,c.C)(L.sX),f=(0,c.C)(L.Zp),y=(0,c.C)(L.G1);(0,L.J6)({page:f,size:y});let C=e=>{var n;let{id:a}=e,i=_.find(e=>e.id===a);return null!==(n=null==i?void 0:i.name)&&void 0!==n?n:a},k=_.some(e=>{var a;return null===(a=e.children)||void 0===a?void 0:a.some(e=>e.id===(null==n?void 0:n.id))}),[N]=(0,L.vL)(),[P]=(0,L.p4)(),z=(0,d.useMemo)(()=>!!n,[n]),T=async e=>{let a;if(z){var i;let l={...e,id:n.id,translations:null!==(i=e.translations)&&void 0!==i?i:[]};a=await N(l)}else a=await P(e);(0,g.D4)(a)?h((0,p.Vo)((0,g.e$)(a.error))):(h((0,p.t5)("Privacy notice ".concat(z?"updated":"created"))),z||l.push(v.IT))};return(0,i.jsx)(r.J9,{initialValues:x,enableReinitialize:!0,onSubmit:T,validationSchema:q,children:e=>{var o,d;let{values:c,setFieldValue:g,dirty:v,isValid:h,isSubmitting:x}=e;return(0,i.jsx)(r.l0,{children:(0,i.jsxs)(s.Kqy,{spacing:10,children:[(0,i.jsxs)(s.Kqy,{spacing:6,children:[(0,i.jsxs)(u.Z,{title:"Privacy notice details",children:[(0,i.jsx)(m.j0,{label:"Notice title",name:"name",isRequired:!0,variant:"stacked"}),(0,i.jsx)(m.AP,{name:"consent_mechanism",label:"Consent mechanism",options:S,isRequired:!0,variant:"stacked"}),(0,i.jsx)(F,{isEditing:z}),(0,i.jsx)(A,{regions:null==n?void 0:n.configured_regions,label:"Locations where privacy notice is shown to visitors",tooltip:"To configure locations, change the privacy experiences where this notice is shown"}),!k&&(0,i.jsx)(t.Z,{label:"Child notices",addButtonLabel:"Add notice children",allItems:_.map(e=>({id:e.id,name:e.name})),values:null!==(d=null===(o=c.children)||void 0===o?void 0:o.map(e=>({id:e.id,name:e.name})))&&void 0!==d?d:[],setValues:e=>g("children",e),idField:"id",getItemLabel:C,draggable:!0,maxHeight:100,baseTestId:"children"}),(0,i.jsx)(s.izJ,{}),(0,i.jsx)(m.w8,{name:"has_gpc_flag",label:"Configure whether this notice conforms to the Global Privacy Control",variant:"stacked"}),(0,i.jsx)(m.AP,{name:"data_uses",label:"Data use",options:b,isMulti:!0,variant:"stacked"}),(0,i.jsx)(m.AP,{name:"enforcement_level",label:"Enforcement level",options:E,isRequired:!0,variant:"stacked"})]}),(0,i.jsx)(w,{availableTranslations:a})]}),(0,i.jsxs)(s.hE2,{size:"sm",spacing:2,children:[(0,i.jsx)(s.zxk,{variant:"outline",onClick:()=>{l.back()},children:"Cancel"}),(0,i.jsx)(s.zxk,{type:"submit",variant:"primary",size:"sm",isDisabled:x||!v||!h,isLoading:x,"data-testid":"save-btn",children:"Save"})]})]})})}})}},69236:function(e,n,a){a.d(n,{B8:function(){return t},Ep:function(){return s},ye:function(){return l}});var i=a(19686);let l=new Map([[i.J7.OPT_IN,"Opt in"],[i.J7.NOTICE_ONLY,"Notice only"],[i.J7.OPT_OUT,"Opt out"]]),t=new Map([[i.QT.SYSTEM_WIDE,"System wide"],[i.QT.FRONTEND,"Front end"],[i.QT.NOT_APPLICABLE,"Not applicable"]]),s=new Map([["gpp_us_national","GPP US National"],["gpp_us_state","GPP US State"]])}}]);