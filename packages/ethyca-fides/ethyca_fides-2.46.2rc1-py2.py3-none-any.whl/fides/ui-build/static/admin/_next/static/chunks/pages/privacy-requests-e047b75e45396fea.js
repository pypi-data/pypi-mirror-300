(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2369],{1565:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests",function(){return r(52304)}])},65464:function(e,t,r){"use strict";var i=r(24246),l=r(13054),n=r(88038),s=r.n(n);r(27378),t.Z=e=>{let{children:t,title:r,mainProps:n}=e;return(0,i.jsxs)(l.kCb,{"data-testid":r,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 200px)",children:[(0,i.jsxs)(s(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",r]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsx)(l.kCb,{pt:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...n,children:t})]})}},37440:function(e,t,r){"use strict";var i=r(24246),l=r(13054);t.Z=e=>{let{title:t,text:r,onClose:n}=e;return(0,i.jsxs)(l.Ugi,{backgroundColor:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",py:4,pr:6,pl:3,"data-testid":"empty-state",gap:2,position:"relative",children:[n&&(0,i.jsx)(l.Two,{boxSize:5,position:"absolute",right:3,top:3,zIndex:1,cursor:"pointer",p:1,onClick:n}),(0,i.jsx)(l.iid,{alignSelf:"start",color:"blue.400",mt:.5,flexGrow:0}),(0,i.jsxs)(l.kCb,{direction:"column",gap:2,flexGrow:1,children:[(0,i.jsx)(l.X6q,{fontSize:"md",children:t}),(0,i.jsx)(l.xvT,{fontSize:"sm",color:"gray.600",lineHeight:"5",children:r})]})]})}},38615:function(e,t,r){"use strict";r.d(t,{Tg:function(){return s}});var i=r(24246),l=r(44296),n=r(96451);let s=e=>(0,l.C)(n.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:r}=e;return s(t)?(0,i.jsx)(i.Fragment,{children:r}):null}},57555:function(e,t,r){"use strict";var i=r(24246),l=r(13054),n=r(27378);t.Z=e=>{let{defaultValues:t,items:r,onSelection:s}=e,[a,o]=(0,n.useState)(r),d=()=>{s(a)};return(0,i.jsxs)(l.qyq,{lineHeight:"1rem",pt:"0",children:[(0,i.jsxs)(l.kCb,{borderBottom:"1px",borderColor:"gray.200",cursor:"auto",p:"8px",children:[(0,i.jsx)(l.zxk,{onClick:()=>{o(r),s(new Map)},size:"xs",variant:"outline",children:"Clear"}),(0,i.jsx)(l.LZC,{}),(0,i.jsx)(l.zxk,{backgroundColor:"primary.800",color:"white",onClick:d,size:"xs",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},children:"Done"})]}),(0,i.jsx)(l.xuv,{maxH:"360px",overflow:"auto",children:(0,i.jsx)(l.cOn,{colorScheme:"purple",defaultValue:t,onChange:e=>{let t=new Map(a);t.forEach((e,r)=>{t.set(r,!1)}),e.forEach(e=>{t.set(e,!0)}),o(t)},children:[...r].sort().map(e=>{let[t]=e;return(0,i.jsx)(l.sNh,{p:0,onKeyPress:e=>{" "===e.key&&e.currentTarget.getElementsByTagName("input")[0].click(),"Enter"===e.key&&d()},children:(0,i.jsx)(l.XZJ,{isChecked:r.get(t),spacing:2,value:t,width:"100%",fontSize:"0.75rem",paddingTop:"10px",paddingRight:"8.5px",paddingBottom:"10px",paddingLeft:"8.5px",onClick:e=>e.stopPropagation(),children:t})},t)})})})]})}},65399:function(e,t,r){"use strict";r.d(t,{HK:function(){return n},VY:function(){return i.V},O3:function(){return a}});var i=r(75139),l=r(60136);let n=()=>{let{errorAlert:e}=(0,i.V)();return{handleError:t=>{let r="An unexpected error occurred. Please try again.";(0,l.Ot)(t)?r=t.data.detail:(0,l.tB)(t)&&(r=t.data.detail[0].msg),e(r)}}};var s=r(27378);let a=e=>{let t=(0,s.useRef)(void 0);return(0,s.useEffect)(()=>{let r=r=>{var i;(null===(i=t.current)||void 0===i?void 0:i.contains(r.target))||e()};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[t,e]),{ref:t}}},75139:function(e,t,r){"use strict";r.d(t,{V:function(){return n}});var i=r(24246),l=r(13054);let n=()=>{let e=(0,l.pmc)();return{errorAlert:(t,r,n)=>{let s={...n,position:(null==n?void 0:n.position)||"top",render:e=>{let{onClose:n}=e;return(0,i.jsxs)(l.bZj,{alignItems:"normal",status:"error",children:[(0,i.jsx)(l.zMQ,{}),(0,i.jsxs)(l.xuv,{children:[r&&(0,i.jsx)(l.CdC,{children:r}),(0,i.jsx)(l.XaZ,{children:t})]}),(0,i.jsx)(l.PZ7,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}};(null==n?void 0:n.id)&&e.isActive(n.id)?e.update(n.id,s):e(s)},successAlert:(t,r,n)=>{let s={...n,position:(null==n?void 0:n.position)||"top",render:e=>{let{onClose:n}=e;return(0,i.jsxs)(l.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,i.jsx)(l.zMQ,{}),(0,i.jsxs)(l.xuv,{children:[r&&(0,i.jsx)(l.CdC,{children:r}),(0,i.jsx)(l.XaZ,{children:t})]}),(0,i.jsx)(l.PZ7,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}};(null==n?void 0:n.id)&&e.isActive(n.id)?e.update(n.id,s):e(s)}}}},21613:function(e,t,r){"use strict";var i=r(24246),l=r(13054),n=r(27378);t.Z=e=>{let{isOpen:t,onClose:r,onApproveRequest:s,isLoading:a,subjectRequest:o}=e,{identity:d,identity_verified_at:u,custom_privacy_request_fields:c}=o,h=(0,n.useCallback)(()=>{s().then(()=>{r()})},[s,r]);return(0,i.jsxs)(l.u_l,{isOpen:t,onClose:r,size:"lg",isCentered:!0,children:[(0,i.jsx)(l.ZAr,{}),(0,i.jsxs)(l.hzk,{children:[(0,i.jsx)(l.xBx,{children:"Privacy request approval"}),(0,i.jsxs)(l.fef,{paddingTop:0,paddingBottom:0,children:[(0,i.jsx)(l.xvT,{color:"gray.500",fontSize:"14px",marginBottom:4,children:"Are you sure you want to approve this privacy request?"}),(0,i.jsxs)(l.QI$,{children:[Object.entries(d).filter(e=>{let[,{value:t}]=e;return null!==t}).map(e=>{let[t,{value:r,label:n}]=e;return(0,i.jsx)(l.HCh,{children:(0,i.jsxs)(l.kCb,{alignItems:"flex-start",children:[(0,i.jsxs)(l.xvT,{mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:[n,":"]}),(0,i.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:2,children:r}),"(",u?"Verified":"Unverified",")"]},t)},t)}),c&&Object.entries(c).filter(e=>{let[,t]=e;return t.value}).map(e=>{let[t,r]=e;return(0,i.jsx)(l.HCh,{children:(0,i.jsxs)(l.kCb,{alignItems:"flex-start",children:[(0,i.jsxs)(l.xvT,{mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:[r.label,":"]}),(0,i.jsxs)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:2,children:[Array.isArray(r.value)?r.value.join(", "):r.value," "]}),"(Unverified)"]},t)},t)})]})]}),(0,i.jsx)(l.mzw,{children:(0,i.jsxs)(l.MIq,{columns:2,width:"100%",children:[(0,i.jsx)(l.zxk,{variant:"outline",size:"sm",mr:3,"data-testid":"cancel-btn",onClick:r,children:"Cancel"}),(0,i.jsx)(l.zxk,{colorScheme:"primary",variant:"solid",size:"sm","data-testid":"continue-btn",onClick:h,isLoading:a,children:"Confirm"})]})})]})]})}},94723:function(e,t,r){"use strict";var i=r(24246),l=r(34803),n=r(13054),s=r(34090),a=r(27378),o=r(59389);let d={denialReason:""};t.Z=e=>{let{isOpen:t,onClose:r,onDenyRequest:u}=e,c=(0,a.useCallback)((e,t)=>{let{setSubmitting:i}=t;u(e.denialReason).then(()=>{i(!1),r()})},[u,r]);return(0,i.jsxs)(n.u_l,{isOpen:t,onClose:r,isCentered:!0,returnFocusOnClose:!1,children:[(0,i.jsx)(n.ZAr,{}),(0,i.jsx)(n.hzk,{width:"100%",maxWidth:"456px","data-testid":"deny-privacy-request-modal",children:(0,i.jsx)(s.J9,{initialValues:d,validationSchema:o.Ry({denialReason:o.Z_().required().label("Reason for denial")}),onSubmit:c,children:e=>{let{isSubmitting:t,dirty:a,isValid:o}=e;return(0,i.jsxs)(s.l0,{children:[(0,i.jsx)(n.xBx,{children:"Privacy request denial"}),(0,i.jsx)(n.fef,{color:"gray.500",fontSize:"14px",children:"Please enter a reason for denying this privacy request. Please note: this can be seen by the user in their notification email."}),(0,i.jsx)(n.fef,{children:(0,i.jsx)(l.Ks,{name:"denialReason",textAreaProps:{focusBorderColor:"primary.600",resize:"none"}})}),(0,i.jsxs)(n.mzw,{children:[(0,i.jsx)(n.zxk,{variant:"outline",size:"sm",width:"100%",maxWidth:"198px",mr:3,isDisabled:t,onClick:r,children:"Cancel"}),(0,i.jsx)(n.zxk,{type:"submit",size:"sm",width:"100%",maxWidth:"198px",colorScheme:"primary",variant:"solid",isDisabled:!a||!o,isLoading:t,"data-testid":"deny-privacy-request-modal-btn",children:"Confirm"})]})]})}})})]})}},95758:function(e,t,r){"use strict";r.d(t,{DE:function(){return a},MP:function(){return l},qX:function(){return s},rE:function(){return n}});var i=r(19686);let l=new Map([[i.q2.APPROVED,"Approved"],[i.q2.CANCELED,"Canceled"],[i.q2.COMPLETE,"Completed"],[i.q2.DENIED,"Denied"],[i.q2.ERROR,"Error"],[i.q2.IN_PROCESSING,"In Progress"],[i.q2.PENDING,"New"],[i.q2.PAUSED,"Paused"],[i.q2.IDENTITY_UNVERIFIED,"Unverified"],[i.q2.REQUIRES_INPUT,"Requires input"]]),n=new Map([[i.Us.ACCESS,"Access"],[i.Us.ERASURE,"Erasure"],[i.Us.CONSENT,"Consent"],[i.Us.UPDATE,"Update"]]),s={mailgun:"mailgun",twilio_email:"twilio_email",twilio_text:"twilio_text"},a={local:"local",s3:"s3"}},25662:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var i=r(72247);let l=e=>{let{subjectRequest:t}=e,[r,l]=(0,i.RW)({fixedCacheKey:t.id}),[n,s]=(0,i.F1)({fixedCacheKey:t.id}),a=s.isLoading||l.isLoading;return{approveRequest:r,approveRequestResult:l,denyRequest:n,denyRequestResult:s,handleApproveRequest:()=>r(t),handleDenyRequest:e=>n({id:t.id,reason:e}),isLoading:a}}},52304:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return en}});var i,l,n=r(24246),s=r(65464),a=r(13054),o=r(65218),d=r.n(o),u=r(27378),c=r(11596),h=r(38615),p=r(59003),x=r(92222),m=r(86677),v=r(45007),f=r(36223),y=r(62528),b=r(52850),j=r(72247),g=r(94167),_=r(95758),C=r(19686);let q={approved:{colorScheme:"green",label:"Approved"},complete:{label:"Completed"},awaiting_email_send:{label:"Awaiting Email Send"},denied:{label:"Denied"},canceled:{label:"Canceled"},error:{colorScheme:"red",label:"Error"},in_processing:{colorScheme:"yellow",label:"In Progress"},paused:{label:"Paused"},pending:{colorScheme:"blue",label:"New"},identity_unverified:{colorScheme:"red",label:"Unverified"},requires_input:{colorScheme:"orange",label:"Requires Input"}},E=e=>{let{value:t}=e;return(0,n.jsx)(b.A4,{colorScheme:q[t].colorScheme,value:q[t].label,"data-testid":"request-status-badge"})},R=e=>{let t,{daysLeft:r,timeframe:i=45,status:l,includeText:s=!1}=e;if(null==r||l===C.q2.COMPLETE||l===C.q2.CANCELED||l===C.q2.DENIED||l===C.q2.IDENTITY_UNVERIFIED)return null;let a=100*r/i;return a<25?t="red":a>=75?t="green":a>=25&&(t="orange"),(0,n.jsx)(b.A4,{value:s?"".concat(r," days left"):r.toString(),colorScheme:t})},S=e=>Array.from(new Set(e.filter(e=>Object.values(C.Us).includes(e.action_type)).map(e=>e.action_type))),k=e=>{let{value:t}=e,r=S(t).map(e=>_.rE.get(e));return(0,n.jsx)(b.WP,{value:r,cellState:{isExpanded:!0}})};var w=r(21613),z=r(94723),P=r(25662);let I=e=>{let{subjectRequest:t,...r}=e,i=(0,a.qY0)(),l=(0,a.qY0)(),{handleApproveRequest:s,handleDenyRequest:o,isLoading:d}=(0,P.Z)({subjectRequest:t});return"pending"!==t.status?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.Ugi,{...r,children:[(0,n.jsx)(a.hU,{title:"Approve","aria-label":"Approve",icon:(0,n.jsx)(a.nQG,{w:2,h:2}),onClick:i.onOpen,isLoading:d,isDisabled:d,"data-testid":"privacy-request-approve-btn",size:"xs",variant:"outline"}),(0,n.jsx)(a.hU,{title:"Deny","aria-label":"Deny",icon:(0,n.jsx)(a.Two,{w:2,h:2}),onClick:l.onOpen,isLoading:d,isDisabled:d,"data-testid":"privacy-request-deny-btn",size:"xs",variant:"outline"})]}),(0,n.jsx)(a.h_i,{children:(0,n.jsx)(w.Z,{isOpen:i.isOpen,isLoading:d,onClose:i.onClose,onApproveRequest:s,subjectRequest:t})}),(0,n.jsx)(a.h_i,{children:(0,n.jsx)(z.Z,{isOpen:l.isOpen,onClose:l.onClose,onDenyRequest:o})})]})};(i=l||(l={})).STATUS="status",i.DAYS_LEFT="due_date",i.SOURCE="source",i.REQUEST_TYPE="request_type",i.SUBJECT_IDENTITY="subject_identity",i.TIME_RECEIVED="created_at",i.CREATED_BY="created_by",i.REVIEWER="reviewer",i.ID="id",i.ACTIONS="actions";let A=(0,x.Cl)(),T=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[A.accessor(e=>e.status,{id:"status",cell:e=>{let{getValue:t}=e;return(0,n.jsx)(E,{value:t()})},header:e=>(0,n.jsx)(b.Rr,{value:"Status",...e})}),A.accessor(e=>e.days_left,{id:"due_date",cell:e=>{let{row:t,getValue:r}=e;return(0,n.jsx)(R,{daysLeft:r(),timeframe:t.original.policy.execution_timeframe,status:t.original.status})},header:e=>(0,n.jsx)(b.Rr,{value:"Days left",...e})}),...e?[A.accessor(e=>e.source,{id:"source",cell:e=>e.getValue()?(0,n.jsx)(b.A4,{value:e.getValue()}):(0,n.jsx)(b.G3,{value:void 0}),header:e=>(0,n.jsx)(b.Rr,{value:"Source",...e}),enableSorting:!1})]:[],A.accessor(e=>e.policy.rules,{id:"request_type",cell:e=>{let{getValue:t}=e;return(0,n.jsx)(k,{value:t()})},header:e=>(0,n.jsx)(b.Rr,{value:"Request type",...e}),enableSorting:!1}),A.accessor(e=>{var t,r;return(null===(t=e.identity)||void 0===t?void 0:t.email.value)||(null===(r=e.identity)||void 0===r?void 0:r.phone_number.value)||""},{id:"subject_identity",cell:e=>{let{getValue:t}=e;return(0,n.jsx)(b.G3,{value:t()})},header:e=>(0,n.jsx)(b.Rr,{value:"Subject identity",...e}),enableSorting:!1}),A.accessor(e=>e.created_at,{id:"created_at",cell:e=>{let{getValue:t}=e;return(0,n.jsx)(b.G3,{value:(0,g.p6)(t())})},header:e=>(0,n.jsx)(b.Rr,{value:"Time received",...e})}),A.accessor(e=>{var t;return(null===(t=e.reviewer)||void 0===t?void 0:t.username)||""},{id:"reviewer",cell:e=>{let{getValue:t}=e;return(0,n.jsx)(b.G3,{value:t()})},header:e=>(0,n.jsx)(b.Rr,{value:"Reviewed by",...e}),enableSorting:!1}),A.accessor(e=>e.id,{id:"id",cell:e=>{let{getValue:t}=e;return(0,n.jsx)(b.G3,{value:t()})},header:e=>(0,n.jsx)(b.Rr,{value:"Request ID",...e}),enableSorting:!1}),A.display({id:"actions",cell:e=>{let{row:t}=e;return(0,n.jsx)(I,{subjectRequest:t.original})},header:e=>(0,n.jsx)(b.Rr,{value:"Actions",...e}),meta:{disableRowClick:!0}})]};var D=r(57555);let O=e=>{let{closeOnSelect:t=!1,options:r,value:i,onChange:l,placeholder:s="Select one or more items",...o}=e,[d,c]=(0,u.useState)(!1),h=(0,u.useMemo)(()=>(0,g.gv)(r,i),[r,i]),p=(0,u.useMemo)(()=>null==i?void 0:i.map(e=>r.get(e)),[r,i]),x=()=>{c(!1)},m=e=>{let t=(0,g.W)(e,[!0]);l((0,g.W)(r,t)),x()},v=e=>{l(i.filter(t=>t!==e))};return(0,n.jsx)(a.v2r,{isLazy:!0,closeOnSelect:t,onClose:x,onOpen:()=>{c(!0)},children:e=>{let{onClose:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.xuv,{sx:{border:"1px solid",borderColor:"gray.200",borderRadius:"md",display:"flex",flexWrap:"wrap",gap:2,py:2,pl:2,pr:10,position:"relative",zIndex:0,...o.sx},children:[(null==i?void 0:i.length)?i.map(e=>(0,n.jsxs)(a.Vp9,{size:"md",zIndex:1,children:[(0,n.jsx)(a.Sn0,{children:r.get(e)}),(0,n.jsx)(a.SD9,{onClick:()=>v(e)})]},e)):s,(0,n.jsx)(a.j2t,{as:a.zxk,rightIcon:(0,n.jsx)(a.mCO,{}),variant:"ghost",_active:{bg:"none"},_hover:{bg:"none"},"aria-label":s,...o,sx:{position:"absolute",height:"auto",top:0,right:0,bottom:0,left:0,zIndex:0,...o.sx}})]}),d&&(0,n.jsx)(D.Z,{defaultValues:p,items:h,onSelection:e=>{m(e),t()}})]})}})},Z=e=>{let t=(0,v.v9)(j.dp),r=(0,v.I0)();return{handleStatusChange:t=>{r((0,j.CI)(t)),e()},handleActionTypeChange:t=>{r((0,j.aM)(t)),e()},handleFromChange:t=>{r((0,j.su)(null==t?void 0:t.target.value)),e()},handleToChange:t=>{r((0,j.Ue)(null==t?void 0:t.target.value)),e()},handleClearAllFilters:()=>{r((0,j.Mk)()),e()},...t}},U=e=>{let{onClose:t,onFilterChange:r,...i}=e,{handleStatusChange:l,handleActionTypeChange:s,handleFromChange:o,handleToChange:d,handleClearAllFilters:u,from:c,to:h,status:p,action_type:x}=Z(r);return(0,n.jsxs)(a.u_l,{onClose:t,size:"xl",...i,children:[(0,n.jsx)(a.ZAr,{}),(0,n.jsxs)(a.hzk,{children:[(0,n.jsx)(a.xBx,{borderBottomWidth:1,borderBottomColor:"gray.200",children:"All Filters"}),(0,n.jsx)(a.olH,{}),(0,n.jsx)(a.fef,{py:4,sx:{"& label":{mb:0}},children:(0,n.jsxs)(a.Kqy,{gap:4,children:[(0,n.jsxs)(a.Kqy,{children:[(0,n.jsx)(a.lXp,{size:"md",id:"request-date-range-label",children:"Date range"}),(0,n.jsxs)(a.Ugi,{gap:3,children:[(0,n.jsxs)(a.BZy,{size:"sm",flex:1,children:[(0,n.jsx)(a.UiE,{as:"label",htmlFor:"from-date",borderRadius:"md",children:"From"}),(0,n.jsx)(a.IIB,{type:"date",name:"From",value:c,max:h||void 0,onChange:o,borderRadius:"md",id:"from-date","aria-describedby":"request-date-range-label"})]}),(0,n.jsxs)(a.BZy,{size:"sm",flex:1,children:[(0,n.jsx)(a.UiE,{as:"label",htmlFor:"to-date",borderRadius:"md",children:"To"}),(0,n.jsx)(a.IIB,{type:"date",borderRadius:"md",name:"To",value:h,min:c||void 0,onChange:d,id:"to-date","aria-describedby":"request-date-range-label"})]})]})]}),(0,n.jsxs)(a.Kqy,{children:[(0,n.jsx)(a.lXp,{size:"md",id:"request-status-label",children:"Status"}),(0,n.jsx)(O,{options:_.MP,value:p,onChange:l,"aria-describedby":"request-status-label"})]}),(0,n.jsxs)(a.Kqy,{children:[(0,n.jsx)(a.lXp,{size:"md",id:"request-action-type-label",children:"Request Type"}),(0,n.jsx)(O,{options:_.rE,value:x,onChange:s,"aria-describedby":"request-action-type-label"})]})]})}),(0,n.jsxs)(a.mzw,{justifyContent:"space-between",children:[(0,n.jsx)(a.zxk,{size:"sm",variant:"ghost",onClick:u,children:"Clear all"}),(0,n.jsx)(a.zxk,{size:"sm",colorScheme:"primary",onClick:t,children:"Done"})]})]})]})},N=e=>{let{...t}=e,{plus:r}=(0,c.hz)(),[i,l]=(0,u.useState)(""),s=(0,v.v9)(j.dp),o=(0,v.v9)(f.rK),d=(0,a.pmc)(),h=(0,m.useRouter)(),g=(0,v.I0)(),{PAGE_SIZES:_,pageSize:C,setPageSize:q,onPreviousPageClick:E,isPreviousPageDisabled:R,onNextPageClick:S,isNextPageDisabled:k,startRange:w,endRange:z,pageIndex:P,setTotalPages:I,resetPageIndexToDefault:A}=(0,b.oi)(),{isOpen:D,onOpen:O,onClose:Z}=(0,a.qY0)(),{data:N,isLoading:F,isFetching:M}=(0,j.QA)({...s,page:P,size:C}),{items:L,total:V}=(0,u.useMemo)(()=>{let e=N||{items:[],total:0,pages:0};return I(e.pages),e},[N,I]),B=(0,u.useCallback)(e=>{g((0,j.mU)(e)),l(e),A()},[g,A,l]),W=async()=>{let e;try{await (0,j.py)({...s,token:o})}catch(t){e=t instanceof Error?t.message:"Unknown error occurred"}e&&d({description:"".concat(e),duration:5e3,status:"error"})},Y=e=>{h.push("/privacy-requests/".concat(e))},G=(0,p.b7)({getCoreRowModel:(0,x.sC)(),data:L,columns:(0,u.useMemo)(()=>T(r),[r]),getRowId:e=>"".concat(e.status,"-").concat(e.id),manualPagination:!0});return(0,n.jsxs)(a.xuv,{...t,children:[(0,n.jsxs)(b.Q$,{children:[(0,n.jsx)(b.HO,{globalFilter:i,setGlobalFilter:B,placeholder:"Search by request ID or identity value"}),(0,n.jsxs)(a.Ugi,{alignItems:"center",spacing:4,children:[(0,n.jsx)(a.zxk,{"data-testid":"filter-btn",size:"xs",variant:"outline",onClick:O,children:"Filter"}),(0,n.jsx)(a.hU,{"aria-label":"Export report","data-testid":"export-btn",size:"xs",variant:"outline",icon:(0,n.jsx)(y.nM,{}),onClick:W})]}),(0,n.jsx)(a.h_i,{children:(0,n.jsx)(U,{isOpen:D,onClose:Z,onFilterChange:A})})]}),F?(0,n.jsx)(a.xuv,{p:2,borderWidth:1,children:(0,n.jsx)(b.I4,{rowHeight:26,numRows:10})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.ZK,{tableInstance:G,onRowClick:e=>Y(e.id),onSort:e=>{if(!e){g((0,j.p2)()),A();return}let{id:t,desc:r}=e;g((0,j.PU)(t)),g((0,j.iX)(r?"desc":"asc")),A()}}),(0,n.jsx)(b.s8,{totalRows:V||0,pageSizes:_,setPageSize:q,onPreviousPageClick:E,isPreviousPageDisabled:R||M,onNextPageClick:S,isNextPageDisabled:k||M,startRange:w,endRange:z})]})]})};var F=r(60136),M=r(37440),L=r(16781),V=r(34090),B=r(59389),W=r(34803);let Y=(e,t)=>null==t?void 0:t.find(t=>t.policy_key===e),G=e=>{var t,r;if(!e)return B.Ry().shape({policy_key:B.Z_().required().label("Request type")});let i=e.custom_privacy_request_fields?Object.entries(e.custom_privacy_request_fields).map(e=>{let[t,r]=e;return{[t]:B.Ry().shape({value:r.required&&!r.hidden?B.Z_().required().label(r.label):B.Z_().nullable()})}}).reduce((e,t)=>({...e,...t}),{}):{};return B.Ry().shape({policy_key:B.Z_().required().label("Request type"),identity:B.Ry().shape({email:(null===(t=e.identity_inputs)||void 0===t?void 0:t.email)==="required"?B.Z_().email().required().label("Email address"):B.Z_().nullable(),phone_number:(null===(r=e.identity_inputs)||void 0===r?void 0:r.phone)==="required"?B.Z_().matches(/^\+?[1-9]\d{1,14}$/,"Phone number must be formatted correctly (e.g. 15555555555)").required().label("Phone number"):B.Z_().matches(/^\+?[1-9]\d{1,14}$/,"Phone number must be formatted correctly (e.g. 15555555555)").nullable()}),custom_privacy_request_fields:B.Ry().shape(i)})},X={is_verified:!1,policy_key:"",identity:{}},K=e=>{let{identityInputs:t}=e;return t?(0,n.jsxs)(n.Fragment,{children:[t.email?(0,n.jsx)(W.j0,{name:"identity.email",label:"User email address",isRequired:"required"===t.email,variant:"stacked"}):null,t.phone?(0,n.jsx)(W.j0,{name:"identity.phone_number",label:"User phone number",isRequired:"required"===t.phone,variant:"stacked"}):null]}):null},H=e=>{let{customFieldInputs:t}=e;if(!t)return null;let r=Object.entries(t);return(0,n.jsx)(n.Fragment,{children:r.map(e=>{let[t,r]=e;return(0,n.jsx)(W.j0,{name:"custom_privacy_request_fields.".concat(t,".value"),label:r.label,isRequired:!!r.required,variant:"stacked"},t)})})};var Q=e=>{let{onSubmit:t,onCancel:r}=e,{data:i}=(0,j.xv)();return(0,n.jsx)(V.J9,{initialValues:X,onSubmit:t,validationSchema:()=>(0,B.Vo)(e=>G(Y(e.policy_key,null==i?void 0:i.actions))),children:e=>{var t;let{values:l,dirty:s,isValid:o,isSubmitting:d,setFieldValue:u}=e,c=Y(l.policy_key,null==i?void 0:i.actions),h=e=>{let t=Y(e.value,null==i?void 0:i.actions);if(!(null==t?void 0:t.custom_privacy_request_fields)){u("custom_privacy_request_fields",void 0);return}u("custom_privacy_request_fields",Object.entries(t.custom_privacy_request_fields).map(e=>{let[t,r]=e;return{[t]:{label:r.label,value:r.default_value}}}).reduce((e,t)=>({...e,...t}),{}))};return(0,n.jsx)(V.l0,{children:(0,n.jsxs)(a.Kqy,{spacing:6,mb:2,children:[(0,n.jsx)(W.AP,{name:"policy_key",label:"Request type",options:null!==(t=null==i?void 0:i.actions.map(e=>({label:e.title,value:e.policy_key})))&&void 0!==t?t:[],onChange:e=>h(e),variant:"stacked",isRequired:!0}),(0,n.jsx)(K,{identityInputs:null==c?void 0:c.identity_inputs}),(0,n.jsx)(H,{customFieldInputs:null==c?void 0:c.custom_privacy_request_fields}),(0,n.jsx)(W.Xl,{name:"is_verified",label:"I confirm that I have verified this user information"}),(0,n.jsxs)(a.hE2,{alignSelf:"end",spacing:0,children:[(0,n.jsx)(a.zxk,{variant:"outline",size:"sm",onClick:r,mr:4,children:"Cancel"}),(0,n.jsx)(a.zxk,{type:"submit",colorScheme:"primary",size:"sm",isDisabled:!l.is_verified||!s||!o,isLoading:d,"data-testid":"submit-btn",children:"Create"})]})]})})}})},$=r(43073);let J=e=>{let{isOpen:t,onClose:r}=e,[i]=(0,j.M6)(),l=(0,a.pmc)(),s=async e=>{let{is_verified:t,...n}=e,s=n.custom_privacy_request_fields?Object.entries(n.custom_privacy_request_fields).map(e=>{let[t,r]=e;return r.value?{[t]:r}:{}}).reduce((e,t)=>({...e,...t}),{}):void 0,a={...n,custom_privacy_request_fields:s},o=await i([a]);(0,$.D4)(o)?l((0,L.Vo)((0,F.e$)(o.error,"An error occurred while creating this privacy request. Please try again"))):l((0,L.t5)("Privacy request created")),r()};return(0,n.jsxs)(a.u_l,{isOpen:t,onClose:r,size:"2xl",isCentered:!0,children:[(0,n.jsx)(a.ZAr,{}),(0,n.jsxs)(a.hzk,{"data-testid":"submit-request-modal",maxHeight:"80%",overflowY:"auto",children:[(0,n.jsx)(a.xBx,{children:"Create privacy request"}),(0,n.jsx)(a.fef,{children:(0,n.jsxs)(a.Kqy,{spacing:4,children:[(0,n.jsx)(M.Z,{title:"Warning: You are bypassing identity verification",text:"You are bypassing Fides' built-in identity verification step. Please ensure that you are only entering information on behalf of a verified and approved user's privacy request."}),(0,n.jsx)(Q,{onSubmit:s,onCancel:()=>r()})]})})]})]})};var ee=()=>{let{onOpen:e,isOpen:t,onClose:r}=(0,a.qY0)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(J,{isOpen:t,onClose:r}),(0,n.jsx)(a.zxk,{colorScheme:"primary",size:"xs",onClick:e,"data-testid":"submit-request-btn",children:"Create request"})]})},et=r(65399);let er=()=>{let{errorAlert:e}=(0,et.VY)(),[t,r]=(0,u.useState)(!1),[i,l]=(0,u.useState)({count:0,total:0}),[s,o]=(0,u.useState)(!0),d=C.q2.ERROR,{data:c}=(0,j.tE)(),{data:h}=(0,j.QA)({status:[d]},{pollingInterval:15e3,skip:s});return(0,u.useEffect)(()=>{o(!(c&&c.notify_after_failures>0))},[c]),(0,u.useEffect)(()=>{let e=(null==h?void 0:h.total)||0;e>=((null==c?void 0:c.notify_after_failures)||0)&&e>i.total?(l({count:e-i.total,total:e}),r(!0)):r(!1)},[null==h?void 0:h.total,null==c?void 0:c.notify_after_failures,i.total]),{processing:()=>{t&&e((0,n.jsxs)(a.xuv,{children:["DSR automation has failed for"," ",(0,n.jsx)(a.xvT,{as:"span",fontWeight:"semibold",children:i.count})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null,id:"dsrErrorAlert"})}}},ei=d()(()=>r.e(7528).then(r.bind(r,37528)),{loadableGenerated:{webpack:()=>[37528]},loading:()=>(0,n.jsx)("div",{children:"Loading..."})});var el=()=>{let{processing:e}=er(),{plus:t}=(0,c.hz)();return(0,u.useEffect)(()=>{e()},[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.kCb,{"data-testid":"privacy-requests",gap:4,children:[(0,n.jsx)(a.X6q,{mb:8,fontSize:"2xl",fontWeight:"semibold",children:"Privacy Requests"}),(0,n.jsx)(a.LZC,{}),t&&(0,n.jsx)(h.ZP,{scopes:[C.Sh.PRIVACY_REQUEST_CREATE],children:(0,n.jsx)(ee,{})}),(0,n.jsx)(ei,{})]}),(0,n.jsx)(N,{})]})},en=()=>(0,n.jsx)(s.Z,{title:"Privacy Requests",mainProps:{px:10},children:(0,n.jsx)(el,{})})},43073:function(e,t,r){"use strict";r.d(t,{Bw:function(){return i.Bw},D4:function(){return i.D4}});var i=r(41164)},23600:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return a},noSSR:function(){return s}});let i=r(51538);r(24246),r(27378);let l=i._(r(45362));function n(e){return{default:(null==e?void 0:e.default)||e}}function s(e,t){return delete t.webpack,delete t.modules,e(t)}function a(e,t){let r=l.default,i={loading:e=>{let{error:t,isLoading:r,pastDelay:i}=e;return null}};e instanceof Promise?i.loader=()=>e:"function"==typeof e?i.loader=e:"object"==typeof e&&(i={...i,...e});let a=(i={...i,...t}).loader;return(i.loadableGenerated&&(i={...i,...i.loadableGenerated},delete i.loadableGenerated),"boolean"!=typeof i.ssr||i.ssr)?r({...i,loader:()=>null!=a?a().then(n):Promise.resolve(n(()=>null))}):(delete i.webpack,delete i.modules,s(r,i))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},91389:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return i}});let i=r(51538)._(r(27378)).default.createContext(null)},45362:function(e,t,r){"use strict";/**
@copyright (c) 2017-present James Kyle <me@thejameskyle.com>
 MIT License
 Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:
 The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE
*/Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return h}});let i=r(51538)._(r(27378)),l=r(91389),n=[],s=[],a=!1;function o(e){let t=e(),r={loading:!0,loaded:null,error:null};return r.promise=t.then(e=>(r.loading=!1,r.loaded=e,e)).catch(e=>{throw r.loading=!1,r.error=e,e}),r}class d{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function u(e){return function(e,t){let r=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),n=null;function o(){if(!n){let t=new d(e,r);n={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return n.promise()}if(!a){let e=r.webpack?r.webpack():r.modules;e&&s.push(t=>{for(let r of e)if(t.includes(r))return o()})}function u(e,t){!function(){o();let e=i.default.useContext(l.LoadableContext);e&&Array.isArray(r.modules)&&r.modules.forEach(t=>{e(t)})}();let s=i.default.useSyncExternalStore(n.subscribe,n.getCurrentValue,n.getCurrentValue);return i.default.useImperativeHandle(t,()=>({retry:n.retry}),[]),i.default.useMemo(()=>{var t;return s.loading||s.error?i.default.createElement(r.loading,{isLoading:s.loading,pastDelay:s.pastDelay,timedOut:s.timedOut,error:s.error,retry:n.retry}):s.loaded?i.default.createElement((t=s.loaded)&&t.default?t.default:t,e):null},[e,s])}return u.preload=()=>o(),u.displayName="LoadableComponent",i.default.forwardRef(u)}(o,e)}function c(e,t){let r=[];for(;e.length;){let i=e.pop();r.push(i(t))}return Promise.all(r).then(()=>{if(e.length)return c(e,t)})}u.preloadAll=()=>new Promise((e,t)=>{c(n).then(e,t)}),u.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let r=()=>(a=!0,t());c(s,e).then(r,r)})),window.__NEXT_PRELOADREADY=u.preloadReady;let h=u},65218:function(e,t,r){e.exports=r(23600)}},function(e){e.O(0,[6451,2850,2888,9774,179],function(){return e(e.s=1565)}),_N_E=e.O()}]);