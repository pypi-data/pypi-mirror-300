"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7528],{37528:function(e,i,r){r.r(i),r.d(i,{default:function(){return y}});var t=r(24246),n=r(13054),s=r(44296),a=r(41628),o=r(34090),l=r(27378),d=r(59389),c=r(60136),u=r(65399);let f=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,m=e=>f.test(e),h=(0,n.Gpc)((e,i)=>{let{isRequired:r=!1,...s}=e,{emails:a}=s.form.values,[o,d]=(0,l.useState)(""),c=e=>a.includes(e),u=e=>{e.map(e=>e.trim()).filter(e=>m(e)&&!c(e)).forEach(e=>s.push(e)),d("")};return(0,t.jsxs)(n.NIc,{alignItems:"baseline",display:"inline-flex",isInvalid:!!s.form.errors[s.name],isRequired:r,children:[(0,t.jsx)(n.lXp,{fontSize:"md",htmlFor:"email",children:"Email"}),(0,t.jsxs)(n.gCW,{align:"flex-start",w:"inherit",children:[(0,t.jsx)(n.IIB,{autoComplete:"off",placeholder:"Type or paste email addresses separated by commas and press `Enter` or `Tab`...",onChange:e=>{d(e.target.value)},onKeyDown:e=>{["Enter","Tab",","].includes(e.key)&&(e.preventDefault(),u([o]))},onPaste:e=>{e.preventDefault(),u(e.clipboardData.getData("text").split(","))},ref:i,size:"sm",type:"email",value:o}),(0,t.jsx)(n.J1D,{children:s.form.errors[s.name]}),a.length>0&&(0,t.jsx)(n.Eq9,{spacing:1,mb:3,pt:"8px",children:a.map((e,i)=>(0,t.jsxs)(n.Vp9,{borderRadius:"full",backgroundColor:"primary.400",color:"white",size:"sm",variant:"solid",children:[(0,t.jsx)(n.Sn0,{children:e}),(0,t.jsx)(n.SD9,{onClick:()=>{s.remove(i)}})]},e))})]})]})});var x=r(72247);let g=d.Ry().shape({emails:d.IX(d.Z_()).when(["notify"],{is:!0,then:()=>d.IX(d.Z_()).min(1,"Must enter at least one valid email").label("Email")}),notify:d.O7(),minErrorCount:d.Rx().required()});var p=()=>{let{isOpen:e,onOpen:i,onClose:r}=(0,n.qY0)(),[s,a]=(0,l.useState)({emails:[],notify:!1,minErrorCount:1}),d=(0,l.useRef)(null),{errorAlert:f,successAlert:m}=(0,u.VY)(),[p,y]=(0,l.useState)(!0),{data:j}=(0,x.tE)(void 0,{skip:p}),[v]=(0,x.SC)(),C=async(e,i)=>{i.setSubmitting(!0);let t=await v({email_addresses:e.emails,notify_after_failures:e.notify?e.minErrorCount:0});"error"in t?f((0,c.e$)(t.error),"Configure alerts and notifications has failed to save due to the following:"):m("Configure alerts and notifications saved successfully."),i.setSubmitting(!1),r()};return(0,l.useEffect)(()=>{e&&y(!1),j&&a({emails:j.email_addresses,notify:0!==j.notify_after_failures,minErrorCount:j.notify_after_failures})},[j,e]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.hU,{onClick:i,variant:"outline",size:"xs",title:"Configure alerts","aria-label":"Configure alerts",icon:(0,t.jsx)(n.Dkj,{})}),(0,t.jsx)(o.J9,{enableReinitialize:!0,initialValues:s,onSubmit:C,validationSchema:g,children:i=>(0,t.jsxs)(n.dys,{isOpen:e,placement:"right",initialFocusRef:d,onClose:()=>{i.resetForm(),r()},size:"lg",children:[(0,t.jsx)(n.P1B,{}),(0,t.jsxs)(n.scA,{color:"gray.900",children:[(0,t.jsx)(n.cCv,{}),(0,t.jsxs)(n.OXI,{color:"gray.900",children:[(0,t.jsx)(n.xvT,{fontSize:"2xl",fontWeight:"normal",mb:4,children:"Configure alerts and notifications"}),(0,t.jsx)(n.xuv,{mt:"26px",children:(0,t.jsx)(n.xvT,{fontSize:"md",fontWeight:"normal",children:"Setup your alerts to send you a notification when there are any processing failures. You can also setup a threshold for connector failures for Fides to notify you after X amount of failures have occurred."})})]}),(0,t.jsx)(n.Ng0,{mt:"20px",children:(0,t.jsxs)(o.l0,{id:"configure-alerts-form",noValidate:!0,children:[(0,t.jsx)(n.xvT,{fontSize:"md",children:"Contact details"}),(0,t.jsxs)(n.gCW,{align:"stretch",gap:"29px",mt:"14px",children:[(0,t.jsx)(n.Ugi,{children:(0,t.jsx)(o.F2,{name:"emails",render:e=>(0,t.jsx)(h,{...e,isRequired:i.values.notify,ref:d})})}),(0,t.jsx)(n.Ugi,{children:(0,t.jsx)(o.gN,{id:"notify",name:"notify",children:e=>{let{field:r}=e;return(0,t.jsxs)(n.NIc,{alignItems:"center",display:"flex",mt:"45px",children:[(0,t.jsx)(n.lXp,{fontSize:"md",mb:"0",children:"Notify me immediately if there are any DSR processing errors"}),(0,t.jsx)(n.rsf,{...r,colorScheme:"secondary",isChecked:i.values.notify,onChange:e=>{r.onChange(e),i.setFieldValue("minErrorCount",1),e.target.checked||setTimeout(()=>{i.setFieldTouched("emails",!1)},0)}})]})}})})]}),(0,t.jsx)(n.xvT,{color:"#757575",fontSize:"sm",mt:"11px",children:"If selected, then Fides will notify you by your chosen method of communication every time the system encounters a data subject request processing error. You can turn this off anytime and setup a more suitable notification method below if you wish."}),i.values.notify&&(0,t.jsx)(n.Ugi,{mt:"34px",children:(0,t.jsx)(o.gN,{id:"minErrorCount",name:"minErrorCount",children:e=>{let{field:r,meta:s}=e;return(0,t.jsxs)(n.NIc,{alignItems:"center",display:"flex",isInvalid:!!(s.error&&s.touched),isRequired:!0,children:[(0,t.jsx)(n.xvT,{children:"Notify me after"}),(0,t.jsxs)(n.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:i.values.minErrorCount||1,min:1,ml:"8px",mr:"8px",onChange:(e,r)=>{i.setFieldValue("minErrorCount",r)},size:"sm",w:"80px",children:[(0,t.jsx)(n.zuI,{...r}),(0,t.jsxs)(n.FiK,{children:[(0,t.jsx)(n.WQu,{}),(0,t.jsx)(n.Y_d,{})]})]}),(0,t.jsx)(n.xvT,{children:"DSR processing errors "})]})}})})]})}),(0,t.jsx)(n.zeN,{justifyContent:"flex-start",children:(0,t.jsxs)(n.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,t.jsx)(n.zxk,{onClick:()=>{i.resetForm(),r()},variant:"outline",children:"Cancel"}),(0,t.jsx)(n.zxk,{bg:"primary.800",color:"white",form:"configure-alerts-form",isDisabled:i.isSubmitting,isLoading:i.isSubmitting,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_hover:{bg:"primary.400"},children:"Save"})]})})]})]})})]})},y=()=>{let{errorRequests:e}=(0,s.C)(x.fe);return(0,t.jsxs)(n.kCb,{gap:4,children:[(null==e?void 0:e.length)>0&&(0,t.jsx)(a.Z,{buttonProps:{size:"xs"}}),(0,t.jsx)(p,{})]})}},41628:function(e,i,r){var t=r(24246),n=r(13054),s=r(27378),a=r(44296),o=r(60136),l=r(65399),d=r(72247);let c=(0,n.Gpc)((e,i)=>{let{buttonProps:r,handleBlur:c,subjectRequest:u}=e,f=(0,a.T)(),[m,h]=(0,s.useState)(!1),{errorAlert:x,successAlert:g}=(0,l.VY)(),{errorRequests:p}=(0,a.C)(d.fe),[y]=(0,d.JD)(),[j]=(0,d.Fq)(),v=async()=>{h(!0);let e=await y(p);"error"in e?(f((0,d.uT)({checkAll:!1,errorRequests:[]})),x((0,o.e$)(e.error),"DSR batch automation has failed due to the following:",{duration:null})):(e.data.failed.length>0&&x((0,t.jsxs)(n.xuv,{children:["DSR automation has failed for"," ",(0,t.jsx)(n.xvT,{as:"span",fontWeight:"semibold",children:e.data.failed.length})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null}),e.data.succeeded.length>0&&g("Privacy request(s) are now being reprocessed.")),h(!1)},C=async()=>{if(!u)return;h(!0);let e=await j(u);"error"in e?x((0,o.e$)(e.error),"DSR automation has failed for this privacy request due to the following:",{duration:null}):g("Privacy request is now being reprocessed."),h(!1),c&&c(i)};return(0,t.jsx)(n.zxk,{...r,isDisabled:m,isLoading:m,loadingText:"Reprocessing",onClick:u?C:v,ref:i,spinnerPlacement:"end",leftIcon:(0,t.jsx)(n.AyE,{}),variant:"outline",_loading:{opacity:1,div:{opacity:.4}},children:"Reprocess"})});i.Z=c}}]);