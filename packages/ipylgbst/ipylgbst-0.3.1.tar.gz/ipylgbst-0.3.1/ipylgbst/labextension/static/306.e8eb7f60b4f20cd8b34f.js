"use strict";(self.webpackChunkipylgbst=self.webpackChunkipylgbst||[]).push([[306],{306:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var o={};n.r(o),n.d(o,{LegoBoostModel:()=>k,LegoBoostView:()=>A});var i=n(983);const s=n(330),r=s.version,l=s.name;var a=n(318),c=n.n(a),d=n(879),p=n.n(d),m=n(237),h=n.n(m),u=n(862),b=n.n(u),_=n(50),g=n.n(_),f=n(495),x=n.n(f),y=n(780),v={};v.styleTagTransform=x(),v.setAttributes=b(),v.insert=h().bind(null,"head"),v.domAPI=p(),v.insertStyleElement=g(),c()(y.A,v),y.A&&y.A.locals&&y.A.locals;var C=n(925),w=n.n(C);const j={};class k extends i.DOMWidgetModel{constructor(){super(...arguments),this.polling_frame=0,this.polling_is_running=!1,this.stop_polling=!1,this.lane_cmd_index=[0],this.lanes=[Promise.resolve(),Promise.resolve(),Promise.resolve()]}defaults(){return{...super.defaults(),_model_name:k.model_name,_model_module:k.model_module,_model_module_version:k.model_module_version,_view_name:k.view_name,_view_module:k.view_module,_view_module_version:k.view_module_version,_device_info:{},name:"device1",n_lanes:3}}save_device_info(){const e={polling_frame:this.polling_frame,lane_cmd_index:this.lane_cmd_index,...this.boost.deviceInfo};this.set("_device_info",e),this.save_changes()}poll(){this.polling_frame+=1,this.save_device_info()}polling(){this.poll(),this.stop_polling?this.polling_is_running=!1:(this.polling_is_running=!0,setTimeout(this.polling.bind(this),200))}initialize(e,t){super.initialize(e,t);const n=this.get("n_lanes");console.log(`initialize with n_lanes=${n}`,this);const o=this.get("name");console.log(`initialize with name=${o}`),o in j||(j[o]=new(w())),this.boost=j[o],this.on("msg:custom",(async(e,t)=>{const n=e.lane;this.lanes[n]=this.lanes[n].then((async()=>{const o=e.args,i=e.args,s=this.onCommand(e,t);i&&await s,o&&(this.lane_cmd_index[n]+=1,this.save_device_info())}))}))}async onCommand(e,t){console.log("onCommand",e);const n=e.command,o=e.args;if("connect"===n)await this.connect();else if("disconnect"===n)this.disconnect();else if(this.boost.deviceInfo.connected)switch(n){case"poll":this.poll();break;case"led":this.boost.led.apply(this.boost,o);break;case"ledAsync":await this.boost.ledAsync.apply(this.boost,o);break;case"motorTime":this.boost.motorTime.apply(this.boost,o);break;case"motorTimeMulti":this.boost.motorTimeMulti.apply(this.boost,o);break;case"motorTimeAsync":await this.boost.motorTimeAsync.apply(this.boost,o);break;case"motorTimeMultiAsync":await this.boost.motorTimeMultiAsync.apply(this.boost,o);break;case"motorAngle":this.boost.motorAngle.apply(this.boost,o);break;case"motorAngleMulti":this.boost.motorAngleMulti.apply(this.boost,o);break;case"motorAngleAsync":await this.boost.motorAngleAsync.apply(this.boost,o);break;case"motorAngleMultiAsync":await this.boost.motorAngleMultiAsync.apply(this.boost,o);break;default:console.error(`unknown command "${n}"`)}else console.log(`cannot run command ${n} since we are not connected`)}async connect(){const e=e=>new Promise((t=>setTimeout(t,e)));if(!this.boost.deviceInfo.connected){console.log("not connected yet"),await this.boost.connect();for(let t=0;t<30&&(await e(100),!this.boost.deviceInfo.connected||void 0===this.boost.hub||!this.boost.hub.connected);t++);await e(4e3)}const t=this.get("n_lanes");for(;this.lane_cmd_index.length<t;)this.lane_cmd_index.push(0);this.polling_is_running||(this.polling_is_running=!0,setTimeout(this.polling.bind(this),200))}disconnect(){console.log("disconnect"),this.boost.disconnect()}dispose(){console.log("remove model")}}k.serializers={...i.DOMWidgetModel.serializers},k.model_name="LegoBoostModel",k.model_module=l,k.model_module_version=r,k.view_name="LegoBoostView",k.view_module=l,k.view_module_version=r;class A extends i.DOMWidgetView{constructor(){super(...arguments),this.isWebBluetoothSupported=!!navigator.bluetooth}render(){if(this.el.classList.add("custom-widget"),!this.isWebBluetoothSupported){const e=document.createElement("div");e.classList.add("error-box"),this.el.appendChild(e),this.txt_bluetooth=document.createElement("div"),this.txt_bluetooth.textContent="Your device doesn't support Web Bluetooth API. Try to turn on Experimental Platform Features from Chrome, by accessing the following link and turning it on: chrome://flags/#enable-experimental-web-platform-features",e.appendChild(this.txt_bluetooth),console.log("Your device doesn't support Web Bluetooth API. Try to turn on Experimental Platform Features from Chrome, by accessing the following link and turning it on: chrome://flags/#enable-experimental-web-platform-features")}const e=document.createElement("div");e.classList.add("box"),this.el.appendChild(e);const t=document.createElement("div");t.classList.add("box"),this.el.appendChild(t);const n=document.createElement("div");n.classList.add("box"),this.el.appendChild(n),this.txt_connected=document.createElement("div"),this.txt_connected.textContent="Disconnected",e.appendChild(this.txt_connected),this.txt_pitch=document.createElement("div"),this.txt_pitch.textContent="pitch1:",t.appendChild(this.txt_pitch),this.meter_pitch=document.createElement("meter"),t.appendChild(this.meter_pitch),this.meter_pitch.min=-90,this.meter_pitch.max=90,this.el.appendChild(document.createElement("br")),this.txt_roll=document.createElement("div"),this.txt_roll.textContent="roll:",t.appendChild(this.txt_roll),this.meter_roll=document.createElement("meter"),t.appendChild(this.meter_roll),this.meter_roll.min=-90,this.meter_roll.max=90,t.appendChild(document.createElement("br")),this.txt_distance=document.createElement("div"),this.txt_distance.textContent="distance:",t.appendChild(this.txt_distance),this.meter_distance=document.createElement("meter"),t.appendChild(this.meter_distance),this.meter_distance.min=0,this.meter_distance.max=255,t.appendChild(document.createElement("br")),this.txt_color=document.createElement("div"),this.txt_color.textContent="color:",t.appendChild(this.txt_color),this.color_color=document.createElement("div"),t.appendChild(this.color_color),this.color_color.textContent="None",this.changes(),n.appendChild(document.createElement("br")),this.txt_port_a=document.createElement("div"),this.txt_port_a.textContent="Port A:",n.appendChild(this.txt_port_a),n.appendChild(document.createElement("br")),this.txt_port_b=document.createElement("div"),this.txt_port_b.textContent="Port B:",n.appendChild(this.txt_port_b),n.appendChild(document.createElement("br")),this.txt_port_ab=document.createElement("div"),this.txt_port_ab.textContent="Port AB:",n.appendChild(this.txt_port_ab),n.appendChild(document.createElement("br")),this.txt_port_c=document.createElement("div"),this.txt_port_c.textContent="Port C:",n.appendChild(this.txt_port_c),n.appendChild(document.createElement("br")),this.txt_port_d=document.createElement("div"),this.txt_port_d.textContent="Port D:",n.appendChild(this.txt_port_d),this.model.on("change:_device_info",this.changes,this)}changes(){const e=this.model.boost.deviceInfo;if(void 0!==e.connected&&e.connected){this.txt_connected.textContent="Connected",this.meter_roll.value=e.tilt.roll,this.txt_roll.textContent=`roll: ${e.tilt.roll}`,this.meter_pitch.value=e.tilt.pitch,this.txt_pitch.textContent=`pitch1: ${e.tilt.pitch}`;const t=e.distance;null!=t&&isFinite(t)?(this.meter_distance.value=t,this.txt_distance.textContent=`distance: ${t}`):(this.meter_distance.value=255,this.txt_distance.textContent="distance: ∞");const n=e.color;null!=n?(this.color_color.textContent=`${n}`,this.color_color.style.backgroundColor=n):(this.color_color.textContent="None",this.color_color.style.backgroundColor="#444"),this.txt_port_a.textContent=`Port A:  ${e.ports.A.action} ${e.ports.A.angle}`,this.txt_port_b.textContent=`Port B:  ${e.ports.B.action} ${e.ports.B.angle}`,this.txt_port_ab.textContent=`Port AB: ${e.ports.AB.action} ${e.ports.AB.angle}`,this.txt_port_c.textContent=`Port C:  ${e.ports.C.action} ${e.ports.C.angle}`,this.txt_port_d.textContent=`Port D:  ${e.ports.D.action} ${e.ports.D.angle}`}else this.txt_connected.textContent="Disconnected"}remove(){this.model.stop_polling=!0}}const E={id:"ipylgbst:plugin",requires:[i.IJupyterWidgetRegistry],activate:function(e,t){t.registerWidget({name:l,version:r,exports:o})},autoStart:!0}},780:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(551),i=n.n(o),s=n(992),r=n.n(s)()(i());r.push([e.id,".custom-widget {\n}\n\n.custom-widget {\n  display: grid;\n  grid-template-columns: 200px 200px 200px 200px;\n  grid-gap: 10px;\n  background-color: #fff;\n  color: #444;\n  background-color: white;\n  padding: 0px 2px;\n}\n\n.box {\n  background-color: #444;\n  color: #fff;\n  border-radius: 5px;\n  padding: 20px;\n  font-size: 100%;\n}\n\n.error-box {\n  background-color: #ffffff;\n  color: #000000;\n  border-radius: 5px;\n  padding: 20px;\n  font-size: 100%;\n}\n",""]);const l=r},992:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(o)for(var l=0;l<this.length;l++){var a=this[l][0];null!=a&&(r[a]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);o&&r[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),i&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=i):d[4]="".concat(i)),t.push(d))}},t}},551:e=>{e.exports=function(e){return e[1]}},318:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var s={},r=[],l=0;l<e.length;l++){var a=e[l],c=o.base?a[0]+o.base:a[0],d=s[c]||0,p="".concat(c," ").concat(d);s[c]=d+1;var m=n(p),h={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==m)t[m].references++,t[m].updater(h);else{var u=i(h,o);o.byIndex=l,t.splice(l,0,{identifier:p,updater:u,references:1})}r.push(p)}return r}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var s=o(e=e||[],i=i||{});return function(e){e=e||[];for(var r=0;r<s.length;r++){var l=n(s[r]);t[l].references--}for(var a=o(e,i),c=0;c<s.length;c++){var d=n(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=a}}},237:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},50:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},862:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},879:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},495:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},330:e=>{e.exports=JSON.parse('{"name":"ipylgbst","version":"0.3.1","description":"A widget library for controlling LEGO® BOOST via web-bluetooth","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css","style/index.js"],"homepage":"https://github.com/jupyter-robotics/ipylgbst","bugs":{"url":"https://github.com/jupyter-robotics/ipylgbst/issues"},"license":"BSD-3-Clause","author":{"name":"Thorsten Beier","email":"derthorstenbeier@gmail.com"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/jupyter-robotics/ipylgbst"},"scripts":{"build":"jlpm build:lib && jlpm build:labextension:dev","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc --sourceMap","build:lib:prod":"tsc","build:nbextension":"webpack","build:prod":"jlpm clean && jlpm build:lib:prod && jlpm build:labextension","clean":"jlpm clean:lib","clean:all":"jlpm clean:lib && jlpm clean:labextension && jlpm clean:lintcache","clean:labextension":"rimraf ipylgbst/labextension ipylgbst/_version.py","clean:lib":"rimraf lib tsconfig.tsbuildinfo","clean:lintcache":"rimraf .eslintcache .stylelintcache","clean:nbextension":"rimraf ipylgbst/nbextension/static/index.js","eslint":"jlpm eslint:check --fix","eslint:check":"eslint . --cache --ext .ts,.tsx","install:extension":"jlpm build","lint":"jlpm stylelint && jlpm prettier && jlpm eslint","lint:check":"jlpm stylelint:check && jlpm prettier:check && jlpm eslint:check","prepack":"jlpm run build:lib","prettier":"jlpm prettier:base --write --list-different","prettier:base":"prettier \\"**/*{.ts,.tsx,.js,.jsx,.css,.json,.md}\\"","prettier:check":"jlpm prettier:base --check","stylelint":"jlpm stylelint:check --fix","stylelint:check":"stylelint --cache \\"style/**/*.css\\"","test":"jest --coverage","watch":"run-p watch:src watch:labextension","watch:labextension":"jupyter labextension watch .","watch:lib":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:src":"tsc -w --sourceMap"},"dependencies":{"@jupyter-widgets/base":"^1.1.10 || ^2 || ^3 || ^4 || ^5 || ^6","@lumino/application":"^2.3.0-alpha.0","@lumino/widgets":"^2.3.1-alpha.0","add":"^2.0.6","ieee754":"^1.2.1","lego-boost-browser":"git+https://github.com/DerThorsten/lego-boost-browser.git"},"devDependencies":{"@babel/core":"^7.5.0","@babel/preset-env":"^7.5.0","@jupyter-widgets/base-manager":"^1.0.2","@jupyterlab/builder":"^4.0.0","@jupyterlab/testutils":"^4.0.0","@types/jest":"^29.2.0","@types/json-schema":"^7.0.11","@types/react":"^18.0.26","@types/react-addons-linked-state-mixin":"^0.14.22","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^6.1.0","@typescript-eslint/parser":"^6.1.0","acorn":"^7.2.0","css-loader":"^6.7.1","eslint":"^8.36.0","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^5.0.0","fs-extra":"^7.0.0","identity-obj-proxy":"^3.0.0","jest":"^29.2.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.5","prettier":"^3.0.0","rimraf":"^5.0.1","source-map-loader":"^1.0.2","style-loader":"^3.3.1","stylelint":"^15.10.1","stylelint-config-recommended":"^13.0.0","stylelint-config-standard":"^34.0.0","stylelint-csstree-validator":"^3.0.0","stylelint-prettier":"^4.0.0","ts-jest":"^29.2.5","ts-loader":"^8.0.0","typescript":"~5.0.2","webpack":"^5.61.0","webpack-cli":"^4.0.0","yjs":"^13.5.40"},"jupyterlab":{"extension":"lib/plugin","outputDir":"ipylgbst/labextension","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}},"eslintConfig":{"extends":["eslint:recommended","plugin:@typescript-eslint/eslint-recommended","plugin:@typescript-eslint/recommended","plugin:prettier/recommended"],"parser":"@typescript-eslint/parser","parserOptions":{"project":"tsconfig.json","sourceType":"module"},"plugins":["@typescript-eslint"],"rules":{"@typescript-eslint/naming-convention":["error",{"selector":"interface","format":["PascalCase"],"custom":{"regex":"^I[A-Z]","match":true}}],"@typescript-eslint/no-unused-vars":["warn",{"args":"none"}],"@typescript-eslint/no-explicit-any":"off","@typescript-eslint/no-namespace":"off","@typescript-eslint/no-use-before-define":"off","@typescript-eslint/quotes":["error","single",{"avoidEscape":true,"allowTemplateLiterals":false}],"curly":["error","all"],"eqeqeq":"error","prefer-arrow-callback":"error"}},"eslintIgnore":["node_modules","dist","coverage","**/*.d.ts","tests","**/__tests__","ui-tests"],"prettier":{"singleQuote":true,"trailingComma":"none","arrowParens":"avoid","endOfLine":"auto","overrides":[{"files":"package.json","options":{"tabWidth":4}}]},"stylelint":{"extends":["stylelint-config-recommended","stylelint-config-standard","stylelint-prettier/recommended"],"plugins":["stylelint-csstree-validator"],"rules":{"csstree/validator":true,"property-no-vendor-prefix":null,"selector-class-pattern":"^([a-z][A-z\\\\d]*)(-[A-z\\\\d]+)*$","selector-no-vendor-prefix":null,"value-no-vendor-prefix":null}},"styleModule":"style/index.js"}')}}]);