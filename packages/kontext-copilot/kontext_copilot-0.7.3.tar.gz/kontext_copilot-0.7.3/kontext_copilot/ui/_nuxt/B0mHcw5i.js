import{e as U,r as T,s as I,D as B,H as z,o as i,c as M,j as e,h as y,w as d,b as r,d as S,i as x,aj as O,ak as P,al as j,N as Q,O as q,am as H,g as G,a as c,F as A,k as Y,t as E,aa as h,X as Z,_ as J,q as X,p as K,U as R,V as ee,A as te,f as ae}from"./CMhNC8Lg.js";import{u as oe}from"./BLaHawV6.js";import{_ as le}from"./UIpGyKRI.js";import"./B5PkttyH.js";import"./CbFGs04G.js";const ne={class:"container"},re=U({__name:"edit-form",props:{updateModel:{}},setup($,{expose:p}){const m=T(!1),b=I(()=>n.value&&k.value&&V.value),a=[{value:null,text:"Select the data source type"},...Object.values(B).map(t=>({value:t,text:t}))],n=I(()=>{var t;return m.value?!!((t=F.updateModel)!=null&&t.type):null}),k=I(()=>{var t;return m.value?!!((t=F.updateModel)!=null&&t.name):null}),V=I(()=>{var t;return m.value?!!((t=F.updateModel)!=null&&t.connStr):null}),C=(t=!0)=>{m.value=t},F=$,l=z({...F.updateModel});return p({setFormEntered:C,formValid:b,model:l}),(t,o)=>{const _=O,s=P,u=j,N=Q,D=q,f=H;return i(),M("div",ne,[e(l)?(i(),y(f,{key:0},{default:d(()=>[r(u,{label:"Name","label-for":"dataSourceName","label-class":"mb-1",class:"mb-3"},{default:d(()=>[r(_,{id:"dataSourceName",modelValue:e(l).name,"onUpdate:modelValue":o[0]||(o[0]=g=>e(l).name=g),required:"",placeholder:"Enter data source name",state:e(k)},null,8,["modelValue","state"]),r(s,{state:e(k)},{default:d(()=>o[4]||(o[4]=[S(" Please input a data source name ")])),_:1},8,["state"])]),_:1}),r(u,{label:"Type","label-for":"dataSourceType","label-class":"mb-1",class:"mb-3"},{default:d(()=>[r(N,{id:"dataSourceType",modelValue:e(l).type,"onUpdate:modelValue":o[1]||(o[1]=g=>e(l).type=g),options:a,required:"",state:e(n)},null,8,["modelValue","state"]),r(s,{state:e(n)},{default:d(()=>o[5]||(o[5]=[S(" Please select a data source type ")])),_:1},8,["state"])]),_:1}),r(u,{label:"Description","label-for":"dataSourceDesc","label-class":"mb-1",class:"mb-3"},{default:d(()=>[r(D,{id:"dataSourceDesc",modelValue:e(l).description,"onUpdate:modelValue":o[2]||(o[2]=g=>e(l).description=g)},null,8,["modelValue"])]),_:1}),r(u,{label:"Connection string","label-for":"dataSourceConnStr","label-class":"mb-1",class:"mb-3"},{default:d(()=>[r(D,{id:"dataSourceConnStr",modelValue:e(l).connStr,"onUpdate:modelValue":o[3]||(o[3]=g=>e(l).connStr=g),required:"",placeholder:"Enter connection string",state:e(V)},null,8,["modelValue","state"]),r(s,{state:e(V)},{default:d(()=>o[6]||(o[6]=[S(" Please input a connection string ")])),_:1},8,["state"])]),_:1})]),_:1})):x("",!0)])}}}),se={key:0},de={class:"table-responsive"},ue={class:"table table-striped table-hover"},ie={key:1,class:"alert alert-warning"},ce={key:1,class:"w-100 h-100"},me=U({__name:"list",props:{dataSources:{}},emits:["delete","edit","copy"],setup($,{emit:p}){const m=G(),b=T(null),a=z({open:!1,id:"edit-modal",title:"Edit data source",isLoading:!1,error:null,size:"lg",data:null,sourceId:null}),n=z({open:!1,id:"delete-modal",title:"Delete data source",isLoading:!1,error:null,size:"md",sourceName:"",sourceId:null}),k=s=>{n.sourceName=s.name,n.sourceId=s.id,n.open=!0},V=s=>{a.data={...s},a.sourceId=s.id,a.open=!0},C=()=>{a.error=null,a.data=null,a.open=!1,a.sourceId=null},F=async()=>{if(n.sourceId)try{await m.deleteDataSource(n.sourceId),_("delete",n.sourceId),n.open=!1,l()}catch(s){n.error=s instanceof Error?s.message:"An unexpected error occurred",console.error(n.error)}},l=()=>{n.error=null,n.sourceName="",n.sourceId=null},t=async()=>{if(b.value){const s=b.value;if(s.setFormEntered(!0),s.formValid&&a.sourceId&&s.model)try{const u=await m.updateDataSource(a.sourceId,s.model);_("edit",u),s.setFormEntered(!1),C()}catch(u){a.error=u instanceof Error?u.message:"An unexpected error occurred",console.error(a.error)}}},o=s=>{_("copy",s)},_=p;return(s,u)=>{const N=Z,D=J,f=X,g=K,w=R,W=ee;return s.dataSources?(i(),M(A,{key:0},[s.dataSources.length>0?(i(),M("div",se,[c("div",de,[c("table",ue,[u[2]||(u[2]=c("thead",null,[c("tr",null,[c("th",null,"ID"),c("th",null,"Name"),c("th",null,"Type"),c("th",null,"Description"),c("th",null,"Options")])],-1)),c("tbody",null,[(i(!0),M(A,null,Y(s.dataSources,v=>(i(),M("tr",{key:`tr-${v.id}`},[c("td",null,E(v.id),1),c("td",null,E(v.name),1),c("td",null,[r(N,{variant:"light"},{default:d(()=>[S(E(v.type),1)]),_:2},1024)]),c("td",null,E(v.description),1),c("td",null,[(i(),y(f,{key:`${v.id}-btn-edit`,variant:"link",title:"Edit",onClick:L=>V(v)},{default:d(()=>[r(D,{name:"material-symbols:edit-outline"})]),_:2},1032,["onClick"])),(i(),y(f,{key:`${v.id}-btn-copy`,variant:"link",title:"Copy",onClick:L=>o(v)},{default:d(()=>[r(D,{name:"material-symbols:content-copy-outline"})]),_:2},1032,["onClick"])),(i(),y(f,{key:`${v.id}-btn-delete`,variant:"link",title:"Delete",onClick:L=>k(v)},{default:d(()=>[r(D,{name:"material-symbols:delete-outline"})]),_:2},1032,["onClick"]))])]))),128))])]),(i(),y(w,{id:e(a).id,key:e(a).id,modelValue:e(a).open,"onUpdate:modelValue":u[0]||(u[0]=v=>e(a).open=v),title:e(a).title,size:e(a).size,"ok-title":"Save",onOk:h(t,["prevent"]),onHide:C},{default:d(()=>[e(a).error?(i(),y(g,{key:0,"model-value":e(a).error!=null,variant:"danger"},{default:d(()=>[S(E(e(a).error),1)]),_:1},8,["model-value"])):x("",!0),e(a).data?(i(),y(re,{id:"editForm",key:"editForm",ref_key:"editForm",ref:b,"update-model":e(a).data},null,8,["update-model"])):x("",!0)]),_:1},8,["id","modelValue","title","size"])),(i(),y(w,{id:e(n).id,key:e(n).id,modelValue:e(n).open,"onUpdate:modelValue":u[1]||(u[1]=v=>e(n).open=v),title:e(n).title,size:e(n).size,"ok-title":"Delete","ok-variant":"danger",onOk:h(F,["prevent"])},{default:d(()=>[e(n).error?(i(),y(g,{key:0,"model-value":e(n).error!=null,variant:"danger"},{default:d(()=>[S(E(e(n).error),1)]),_:1},8,["model-value"])):x("",!0),u[4]||(u[4]=c("p",null,"Are you sure you want to delete this data source?",-1)),c("p",null,[u[3]||(u[3]=c("strong",null,"Name:",-1)),S(" "+E(e(n).sourceName),1)])]),_:1},8,["id","modelValue","title","size"]))])])):(i(),M("div",ie,"No data sources found."))],64)):(i(),M("div",ce,[r(W,{label:"Loading data sources..."})]))}}}),pe={class:"container"},fe=U({__name:"create-form",props:{createModel:{}},setup($,{expose:p}){const m=T(!1),b=I(()=>n.value&&k.value&&V.value),a=[{value:null,text:"Select the data source type"},...Object.values(B).map(t=>({value:t,text:t}))],n=I(()=>m.value?!!l.value.type:null),k=I(()=>m.value?!!l.value.name:null),V=I(()=>m.value?!!l.value.connStr:null),C=(t=!0)=>{m.value=t},l=T({...$.createModel});return te(()=>l.value.type,t=>{t&&(t==B.SQLite?l.value.connStr="sqlite:////path/to/db":t==B.DuckDB?l.value.connStr="duckdb:////path/to/db":t==B.SQLServer?l.value.connStr="mssql+pyodbc://user:password@host:port/databasename?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes":t==B.PostgreSQL?l.value.connStr="postgresql+psycopg://user:password@host:port/databasename?key=value&key=value":t==B.CSV?l.value.connStr="/path/to/file.csv":t==B.Parquet?l.value.connStr="/path/to/file.parquet":t==B.Oracle&&(l.value.connStr="oracle+oracledb://user:pass@hostname:port[/dbname][?service_name=<service>[&key=value&key=value...]]"))}),p({setFormEntered:C,formValid:b,dataSourceCreateModel:l,model:l}),(t,o)=>{const _=O,s=P,u=j,N=Q,D=H;return i(),M("div",pe,[r(D,null,{default:d(()=>[r(u,{label:"Name","label-for":"dataSourceName","label-class":"mb-1",class:"mb-3"},{default:d(()=>[r(_,{id:"dataSourceName",modelValue:e(l).name,"onUpdate:modelValue":o[0]||(o[0]=f=>e(l).name=f),required:"",placeholder:"Enter data source name",state:e(k)},null,8,["modelValue","state"]),r(s,{state:e(k)},{default:d(()=>o[4]||(o[4]=[S(" Please input a data source name ")])),_:1},8,["state"])]),_:1}),r(u,{label:"Type","label-for":"dataSourceType","label-class":"mb-1",class:"mb-3"},{default:d(()=>[r(N,{id:"dataSourceType",modelValue:e(l).type,"onUpdate:modelValue":o[1]||(o[1]=f=>e(l).type=f),options:a,required:"",state:e(n)},null,8,["modelValue","state"]),r(s,{state:e(n)},{default:d(()=>o[5]||(o[5]=[S(" Please select a data source type ")])),_:1},8,["state"])]),_:1}),r(u,{label:"Description","label-for":"dataSourceDesc","label-class":"mb-1",class:"mb-3"},{default:d(()=>[r(e(q),{id:"dataSourceDesc",modelValue:e(l).description,"onUpdate:modelValue":o[2]||(o[2]=f=>e(l).description=f)},null,8,["modelValue"])]),_:1}),r(u,{label:"Connection string","label-for":"dataSourceConnStr","label-class":"mb-1",class:"mb-3"},{default:d(()=>[r(e(q),{id:"dataSourceConnStr",modelValue:e(l).connStr,"onUpdate:modelValue":o[3]||(o[3]=f=>e(l).connStr=f),required:"",placeholder:"Enter connection string",state:e(V)},null,8,["modelValue","state"]),r(s,{state:e(V)},{default:d(()=>o[6]||(o[6]=[S(" Please input a connection string ")])),_:1},8,["state"])]),_:1})]),_:1})])}}}),ve={class:"px-4 mt-3 w-100"},Ve=U({__name:"data-sources",setup($){const p=T(),m=G(),b=T(null),a=z({open:!1,id:"createFormModal",title:"Add data source",isLoading:!1,size:"lg",error:null,data:null});ae(()=>{m.getDataSources().then(t=>{p.value=t}).catch(t=>{console.error(t)})});const n=()=>{a.open=!1,a.error=null,a.data=null},k=()=>{a.data={type:null,name:"",connStr:"",description:""},a.open=!0},V=async()=>{if(b.value){const t=b.value;if(t.setFormEntered(!0),t.formValid){const o=t.model;try{await m.createDataSource(o),a.open=!1,p.value=await m.getDataSources(),t.setFormEntered(!1),n()}catch(_){a.error=_ instanceof Error?_.message:"An unexpected error occurred"}}}},C=t=>{p.value&&(p.value=p.value.filter(o=>o.id!==t))},F=t=>{if(p.value){const o=p.value.findIndex(_=>_.id===t.id);o!==-1&&(p.value[o]=t)}},l=t=>{a.data={type:t.type,name:t.name,connStr:t.connStr,description:t.description},a.open=!0};return oe(),(t,o)=>{const _=J,s=X,u=K,N=R,D=me;return i(),y(le,null,{"header-secondary":d(()=>[r(s,{variant:"outline-secondary",size:"sm",onClick:k},{default:d(()=>[r(_,{name:"material-symbols:add"}),o[1]||(o[1]=S(" Add data source "))]),_:1}),r(N,{id:e(a).id,modelValue:e(a).open,"onUpdate:modelValue":o[0]||(o[0]=f=>e(a).open=f),title:e(a).title,size:e(a).size,"ok-title":"Create",onOk:h(V,["prevent"]),onHidden:n},{default:d(()=>[e(a).error?(i(),y(u,{key:0,"model-value":e(a).error!=null,variant:"danger"},{default:d(()=>[S(E(e(a).error),1)]),_:1},8,["model-value"])):x("",!0),e(a).data?(i(),y(fe,{key:1,id:"createForm",ref_key:"createForm",ref:b,"create-model":e(a).data},null,8,["create-model"])):x("",!0)]),_:1},8,["id","modelValue","title","size"])]),default:d(()=>[c("div",ve,[r(D,{"data-sources":e(p),onCopy:l,onDelete:C,onEdit:F},null,8,["data-sources"])])]),_:1})}}});export{Ve as default};
