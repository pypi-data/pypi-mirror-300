import{s as ne,p as _e,q as me,b as B,f as b,r as g,i as j,h as D,n as Q,e as N,a as H,t as ae,c as O,g as F,d as se,E as de,F as re,y as pe,v as X,P as je,J as He,w as le,z as ee,H as Fe,V as Ge,Z as Je,R as Qe,Q as Ze,_ as Oe,j as be,L as ge,W as Ke,M as ve,l as Xe,u as Ye,m as $e,o as xe}from"./scheduler.C_sdfy-5.js";import{S as oe,i as ce,c as R,a as q,m as L,t as k,b as E,d as P,g as $,e as x,j as et,f as he}from"./index.D_Dnc2IG.js";import{p as tt,z as lt,e as Me,w as it,I as rt,C as nt}from"./2.CFhpxp2a.js";import{I as at}from"./Image.BICviL2V.js";import{B as st}from"./BlockLabel.RrZy2lJ2.js";import{W as ot,a as ct,S as ut}from"./SelectSource.BoVzzOwP.js";import{g as ft}from"./utils.Gtzs_Zla.js";import{D as Ae}from"./DropdownArrow.BmEtC-r0.js";import{StreamingBar as _t}from"./index.BiwXGmxB.js";import{U as mt}from"./Upload.BdGT9g1b.js";/* empty css                                                   */import{I as dt}from"./IconButtonWrapper.ByxIRnez.js";import{I as gt}from"./Image.D1v7iwpD.js";function ht(r){let e,t,l;return{c(){e=_e("svg"),t=_e("path"),l=_e("circle"),this.h()},l(i){e=me(i,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0});var a=B(e);t=me(a,"path",{d:!0}),B(t).forEach(b),l=me(a,"circle",{cx:!0,cy:!0,r:!0}),B(l).forEach(b),a.forEach(b),this.h()},h(){g(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),g(l,"cx","12"),g(l,"cy","13"),g(l,"r","4"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 24 24"),g(e,"fill","none"),g(e,"stroke","currentColor"),g(e,"stroke-width","1.5"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),g(e,"class","feather feather-camera")},m(i,a){j(i,e,a),D(e,t),D(e,l)},p:Q,i:Q,o:Q,d(i){i&&b(e)}}}class bt extends oe{constructor(e){super(),ce(this,e,null,ht,ne,{})}}function vt(r){let e,t;return{c(){e=_e("svg"),t=_e("circle"),this.h()},l(l){e=me(l,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0});var i=B(e);t=me(i,"circle",{cx:!0,cy:!0,r:!0}),B(t).forEach(b),i.forEach(b),this.h()},h(){g(t,"cx","12"),g(t,"cy","12"),g(t,"r","10"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","1.5"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),g(e,"class","feather feather-circle")},m(l,i){j(l,e,i),D(e,t)},p:Q,i:Q,o:Q,d(l){l&&b(e)}}}class pt extends oe{constructor(e){super(),ce(this,e,null,vt,ne,{})}}function wt(r){let e,t,l,i,a,n="Click to Access Webcam",o,s,c,u;return i=new ot({}),{c(){e=N("button"),t=N("div"),l=N("span"),R(i.$$.fragment),a=H(),o=ae(n),this.h()},l(m){e=O(m,"BUTTON",{class:!0});var T=B(e);t=O(T,"DIV",{class:!0});var I=B(t);l=O(I,"SPAN",{class:!0});var M=B(l);q(i.$$.fragment,M),M.forEach(b),a=F(I),o=se(I,n),I.forEach(b),T.forEach(b),this.h()},h(){g(l,"class","icon-wrap svelte-qbrfs"),g(t,"class","wrap svelte-qbrfs"),g(e,"class","svelte-qbrfs"),de(e,"height","100%")},m(m,T){j(m,e,T),D(e,t),D(t,l),L(i,l,null),D(t,a),D(t,o),s=!0,c||(u=re(e,"click",r[1]),c=!0)},p:Q,i(m){s||(k(i.$$.fragment,m),s=!0)},o(m){E(i.$$.fragment,m),s=!1},d(m){m&&b(e),P(i),c=!1,u()}}}function kt(r){const e=pe();return[e,()=>e("click")]}class It extends oe{constructor(e){super(),ce(this,e,kt,wt,ne,{})}}function Et(){return navigator.mediaDevices.enumerateDevices()}function yt(r,e){e.srcObject=r,e.muted=!0,e.play()}async function Se(r,e,t){const l={width:{ideal:1920},height:{ideal:1440}},i={video:t?{deviceId:{exact:t},...l}:l,audio:r};return navigator.mediaDevices.getUserMedia(i).then(a=>(yt(a,e),a))}function Dt(r){return r.filter(t=>t.kind==="videoinput")}function Ue(r,e,t){const l=r.slice();return l[37]=e[t],l}function Tt(r){let e,t,l,i,a,n,o,s,c,u,m;const T=[Nt,Bt],I=[];function M(w,y){return w[2]==="video"||w[1]?0:1}l=M(r),i=I[l]=T[l](r);let f=!r[11]&&ze(r),v=r[13]&&r[8]&&Ce(r);return{c(){e=N("div"),t=N("button"),i.c(),n=H(),f&&f.c(),o=H(),v&&v.c(),s=ee(),this.h()},l(w){e=O(w,"DIV",{class:!0});var y=B(e);t=O(y,"BUTTON",{"aria-label":!0,class:!0});var S=B(t);i.l(S),S.forEach(b),n=F(y),f&&f.l(y),y.forEach(b),o=F(w),v&&v.l(w),s=ee(),this.h()},h(){g(t,"aria-label",a=r[2]==="image"?"capture photo":"start recording"),g(t,"class","svelte-s8feoe"),g(e,"class","button-wrap svelte-s8feoe")},m(w,y){j(w,e,y),D(e,t),I[l].m(t,null),D(e,n),f&&f.m(e,null),j(w,o,y),v&&v.m(w,y),j(w,s,y),c=!0,u||(m=re(t,"click",r[16]),u=!0)},p(w,y){let S=l;l=M(w),l===S?I[l].p(w,y):($(),E(I[S],1,1,()=>{I[S]=null}),x(),i=I[l],i?i.p(w,y):(i=I[l]=T[l](w),i.c()),k(i,1),i.m(t,null)),(!c||y[0]&4&&a!==(a=w[2]==="image"?"capture photo":"start recording"))&&g(t,"aria-label",a),w[11]?f&&($(),E(f,1,1,()=>{f=null}),x()):f?(f.p(w,y),y[0]&2048&&k(f,1)):(f=ze(w),f.c(),k(f,1),f.m(e,null)),w[13]&&w[8]?v?(v.p(w,y),y[0]&8448&&k(v,1)):(v=Ce(w),v.c(),k(v,1),v.m(s.parentNode,s)):v&&($(),E(v,1,1,()=>{v=null}),x())},i(w){c||(k(i),k(f),k(v),c=!0)},o(w){E(i),E(f),E(v),c=!1},d(w){w&&(b(e),b(o),b(s)),I[l].d(),f&&f.d(),v&&v.d(w),u=!1,m()}}}function Vt(r){let e,t,l,i;return t=new It({}),t.$on("click",r[26]),{c(){e=N("div"),R(t.$$.fragment),this.h()},l(a){e=O(a,"DIV",{title:!0,style:!0});var n=B(e);q(t.$$.fragment,n),n.forEach(b),this.h()},h(){g(e,"title","grant webcam access"),de(e,"height","100%")},m(a,n){j(a,e,n),L(t,e,null),i=!0},p:Q,i(a){i||(k(t.$$.fragment,a),a&&(l||Fe(()=>{l=et(e,lt,{delay:100,duration:200}),l.start()})),i=!0)},o(a){E(t.$$.fragment,a),i=!1},d(a){a&&b(e),P(t)}}}function Bt(r){let e,t,l;return t=new bt({}),{c(){e=N("div"),R(t.$$.fragment),this.h()},l(i){e=O(i,"DIV",{class:!0,title:!0});var a=B(e);q(t.$$.fragment,a),a.forEach(b),this.h()},h(){g(e,"class","icon svelte-s8feoe"),g(e,"title","capture photo")},m(i,a){j(i,e,a),L(t,e,null),l=!0},p:Q,i(i){l||(k(t.$$.fragment,i),l=!0)},o(i){E(t.$$.fragment,i),l=!1},d(i){i&&b(e),P(t)}}}function Nt(r){let e,t,l,i;const a=[jt,Wt,Ot],n=[];function o(s,c){return s[1]&&s[10]==="waiting"?0:s[1]&&s[10]==="open"||!s[1]&&s[11]?1:2}return e=o(r),t=n[e]=a[e](r),{c(){t.c(),l=ee()},l(s){t.l(s),l=ee()},m(s,c){n[e].m(s,c),j(s,l,c),i=!0},p(s,c){let u=e;e=o(s),e===u?n[e].p(s,c):($(),E(n[u],1,1,()=>{n[u]=null}),x(),t=n[e],t?t.p(s,c):(t=n[e]=a[e](s),t.c()),k(t,1),t.m(l.parentNode,l))},i(s){i||(k(t),i=!0)},o(s){E(t),i=!1},d(s){s&&b(l),n[e].d(s)}}}function Ot(r){let e,t,l,i,a=r[4]("audio.record")+"",n,o;return l=new pt({}),{c(){e=N("div"),t=N("div"),R(l.$$.fragment),i=H(),n=ae(a),this.h()},l(s){e=O(s,"DIV",{class:!0});var c=B(e);t=O(c,"DIV",{class:!0,title:!0});var u=B(t);q(l.$$.fragment,u),u.forEach(b),i=F(c),n=se(c,a),c.forEach(b),this.h()},h(){g(t,"class","icon color-primary svelte-s8feoe"),g(t,"title","start recording"),g(e,"class","icon-with-text svelte-s8feoe")},m(s,c){j(s,e,c),D(e,t),L(l,t,null),D(e,i),D(e,n),o=!0},p(s,c){(!o||c[0]&16)&&a!==(a=s[4]("audio.record")+"")&&be(n,a)},i(s){o||(k(l.$$.fragment,s),o=!0)},o(s){E(l.$$.fragment,s),o=!1},d(s){s&&b(e),P(l)}}}function Wt(r){let e,t,l,i,a=r[4]("audio.stop")+"",n,o;return l=new it({}),{c(){e=N("div"),t=N("div"),R(l.$$.fragment),i=H(),n=ae(a),this.h()},l(s){e=O(s,"DIV",{class:!0});var c=B(e);t=O(c,"DIV",{class:!0,title:!0});var u=B(t);q(l.$$.fragment,u),u.forEach(b),i=F(c),n=se(c,a),c.forEach(b),this.h()},h(){g(t,"class","icon color-primary svelte-s8feoe"),g(t,"title","stop recording"),g(e,"class","icon-with-text svelte-s8feoe")},m(s,c){j(s,e,c),D(e,t),L(l,t,null),D(e,i),D(e,n),o=!0},p(s,c){(!o||c[0]&16)&&a!==(a=s[4]("audio.stop")+"")&&be(n,a)},i(s){o||(k(l.$$.fragment,s),o=!0)},o(s){E(l.$$.fragment,s),o=!1},d(s){s&&b(e),P(l)}}}function jt(r){let e,t,l,i,a=r[4]("audio.waiting")+"",n,o;return l=new ct({}),{c(){e=N("div"),t=N("div"),R(l.$$.fragment),i=H(),n=ae(a),this.h()},l(s){e=O(s,"DIV",{class:!0,style:!0});var c=B(e);t=O(c,"DIV",{class:!0,title:!0});var u=B(t);q(l.$$.fragment,u),u.forEach(b),i=F(c),n=se(c,a),c.forEach(b),this.h()},h(){g(t,"class","icon color-primary svelte-s8feoe"),g(t,"title","spinner"),g(e,"class","icon-with-text svelte-s8feoe"),de(e,"width","var(--size-24)")},m(s,c){j(s,e,c),D(e,t),L(l,t,null),D(e,i),D(e,n),o=!0},p(s,c){(!o||c[0]&16)&&a!==(a=s[4]("audio.waiting")+"")&&be(n,a)},i(s){o||(k(l.$$.fragment,s),o=!0)},o(s){E(l.$$.fragment,s),o=!1},d(s){s&&b(e),P(l)}}}function ze(r){let e,t,l,i,a;return t=new Ae({}),{c(){e=N("button"),R(t.$$.fragment),this.h()},l(n){e=O(n,"BUTTON",{class:!0,"aria-label":!0});var o=B(e);q(t.$$.fragment,o),o.forEach(b),this.h()},h(){g(e,"class","icon svelte-s8feoe"),g(e,"aria-label","select input source")},m(n,o){j(n,e,o),L(t,e,null),l=!0,i||(a=re(e,"click",r[27]),i=!0)},p:Q,i(n){l||(k(t.$$.fragment,n),l=!0)},o(n){E(t.$$.fragment,n),l=!1},d(n){n&&b(e),P(t),i=!1,a()}}}function Ce(r){let e,t,l,i,a,n,o;l=new Ae({});function s(m,T){return m[7].length===0?St:Mt}let c=s(r),u=c(r);return{c(){e=N("select"),t=N("button"),R(l.$$.fragment),i=H(),u.c(),this.h()},l(m){e=O(m,"SELECT",{class:!0,"aria-label":!0});var T=B(e);t=O(T,"BUTTON",{class:!0});var I=B(t);q(l.$$.fragment,I),i=F(I),I.forEach(b),u.l(T),T.forEach(b),this.h()},h(){g(t,"class","inset-icon svelte-s8feoe"),g(e,"class","select-wrap svelte-s8feoe"),g(e,"aria-label","select source")},m(m,T){j(m,e,T),D(e,t),L(l,t,null),D(t,i),u.m(e,null),a=!0,n||(o=[re(t,"click",Ge(r[28])),Je(We.call(null,e,r[17])),re(e,"change",r[14])],n=!0)},p(m,T){c===(c=s(m))&&u?u.p(m,T):(u.d(1),u=c(m),u&&(u.c(),u.m(e,null)))},i(m){a||(k(l.$$.fragment,m),a=!0)},o(m){E(l.$$.fragment,m),a=!1},d(m){m&&b(e),P(l),u.d(),n=!1,Qe(o)}}}function Mt(r){let e,t=Me(r[7]),l=[];for(let i=0;i<t.length;i+=1)l[i]=Re(Ue(r,t,i));return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=ee()},l(i){for(let a=0;a<l.length;a+=1)l[a].l(i);e=ee()},m(i,a){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(i,a);j(i,e,a)},p(i,a){if(a[0]&384){t=Me(i[7]);let n;for(n=0;n<t.length;n+=1){const o=Ue(i,t,n);l[n]?l[n].p(o,a):(l[n]=Re(o),l[n].c(),l[n].m(e.parentNode,e))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(i){i&&b(e),Ze(l,i)}}}function St(r){let e,t=r[4]("common.no_devices")+"",l;return{c(){e=N("option"),l=ae(t),this.h()},l(i){e=O(i,"OPTION",{class:!0});var a=B(e);l=se(a,t),a.forEach(b),this.h()},h(){e.__value="",Oe(e,e.__value),g(e,"class","svelte-s8feoe")},m(i,a){j(i,e,a),D(e,l)},p(i,a){a[0]&16&&t!==(t=i[4]("common.no_devices")+"")&&be(l,t)},d(i){i&&b(e)}}}function Re(r){let e,t=r[37].label+"",l,i,a,n;return{c(){e=N("option"),l=ae(t),i=H(),this.h()},l(o){e=O(o,"OPTION",{class:!0});var s=B(e);l=se(s,t),i=F(s),s.forEach(b),this.h()},h(){e.__value=a=r[37].deviceId,Oe(e,e.__value),e.selected=n=r[8].deviceId===r[37].deviceId,g(e,"class","svelte-s8feoe")},m(o,s){j(o,e,s),D(e,l),D(e,i)},p(o,s){s[0]&128&&t!==(t=o[37].label+"")&&be(l,t),s[0]&128&&a!==(a=o[37].deviceId)&&(e.__value=a,Oe(e,e.__value)),s[0]&384&&n!==(n=o[8].deviceId===o[37].deviceId)&&(e.selected=n)},d(o){o&&b(e)}}}function Ut(r){let e,t,l,i,a,n,o,s,c,u,m;t=new _t({props:{time_limit:r[9]}});const T=[Vt,Tt],I=[];function M(f,v){return f[12]?1:0}return c=M(r),u=I[c]=T[c](r),{c(){e=N("div"),R(t.$$.fragment),l=H(),i=N("video"),a=H(),n=N("img"),s=H(),u.c(),this.h()},l(f){e=O(f,"DIV",{class:!0});var v=B(e);q(t.$$.fragment,v),l=F(v),i=O(v,"VIDEO",{class:!0}),B(i).forEach(b),a=F(v),n=O(v,"IMG",{src:!0,class:!0}),s=F(v),u.l(v),v.forEach(b),this.h()},h(){var f;g(i,"class","svelte-s8feoe"),X(i,"flip",r[3]),X(i,"hide",!r[12]||r[12]&&!!r[0]),je(n.src,o=(f=r[0])==null?void 0:f.url)||g(n,"src",o),g(n,"class","svelte-s8feoe"),X(n,"hide",!r[12]||r[12]&&!r[0]),g(e,"class","wrap svelte-s8feoe")},m(f,v){j(f,e,v),L(t,e,null),D(e,l),D(e,i),r[25](i),D(e,a),D(e,n),D(e,s),I[c].m(e,null),m=!0},p(f,v){var S;const w={};v[0]&512&&(w.time_limit=f[9]),t.$set(w),(!m||v[0]&8)&&X(i,"flip",f[3]),(!m||v[0]&4097)&&X(i,"hide",!f[12]||f[12]&&!!f[0]),(!m||v[0]&1&&!je(n.src,o=(S=f[0])==null?void 0:S.url))&&g(n,"src",o),(!m||v[0]&4097)&&X(n,"hide",!f[12]||f[12]&&!f[0]);let y=c;c=M(f),c===y?I[c].p(f,v):($(),E(I[y],1,1,()=>{I[y]=null}),x(),u=I[c],u?u.p(f,v):(u=I[c]=T[c](f),u.c()),k(u,1),u.m(e,null))},i(f){m||(k(t.$$.fragment,f),k(u),m=!0)},o(f){E(t.$$.fragment,f),E(u),m=!1},d(f){f&&b(e),P(t),r[25](null),I[c].d()}}}function We(r,e){const t=l=>{r&&!r.contains(l.target)&&!l.defaultPrevented&&e(l)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function zt(r,e,t){let l,i=[],a=null,n=null,o="closed";const s=h=>{h==="closed"?(t(9,n=null),t(10,o="closed"),t(0,U=null)):h==="waiting"?t(10,o="waiting"):t(10,o="open")},c=h=>{p&&t(9,n=h)};let u,{streaming:m=!1}=e,{pending:T=!1}=e,{root:I=""}=e,{stream_every:M=1}=e,{mode:f="image"}=e,{mirror_webcam:v}=e,{include_audio:w}=e,{i18n:y}=e,{upload:S}=e,{value:U=null}=e;const A=pe();He(()=>{u=document.createElement("canvas"),m&&f==="image"&&window.setInterval(()=>{l&&!T&&d()},M*1e3)});const V=async h=>{const K=h.target.value;await Se(w,l,K).then(async Y=>{W=Y,t(8,a=i.find(fe=>fe.deviceId===K)||null),t(13,te=!1)})};async function Z(){try{Se(w,l).then(async h=>{t(12,ue=!0),t(7,i=await Et()),W=h}).then(()=>Dt(i)).then(h=>{t(7,i=h);const C=W.getTracks().map(K=>{var Y;return(Y=K.getSettings())==null?void 0:Y.deviceId})[0];t(8,a=C&&h.find(K=>K.deviceId===C)||i[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&A("error",y("image.no_webcam_support"))}catch(h){if(h instanceof DOMException&&h.name=="NotAllowedError")A("error",y("image.allow_webcam_access"));else throw h}}function d(){var h=u.getContext("2d");if((!m||m&&p)&&l.videoWidth&&l.videoHeight){if(u.width=l.videoWidth,u.height=l.videoHeight,h.drawImage(l,0,0,l.videoWidth,l.videoHeight),v&&(h.scale(-1,1),h.drawImage(l,-l.videoWidth,0)),m&&(!p||o==="waiting"))return;if(m){const C=u.toDataURL("image/jpeg");A("stream",C);return}u.toBlob(C=>{A(m?"stream":"capture",C)},`image/${m?"jpeg":"png"}`,.8)}}let p=!1,G=[],W,z,J;function we(){if(p){J.stop();let h=new Blob(G,{type:z}),C=new FileReader;C.onload=async function(K){var Y;if(K.target){let fe=new File([h],"sample."+z.substring(6));const Ve=await tt([fe]);let Be=(Y=await S(Ve,I))==null?void 0:Y.filter(Boolean)[0];A("capture",Be),A("stop_recording")}},C.readAsDataURL(h)}else{A("start_recording"),G=[];let h=["video/webm","video/mp4"];for(let C of h)if(MediaRecorder.isTypeSupported(C)){z=C;break}if(z===null){console.error("No supported MediaRecorder mimeType");return}J=new MediaRecorder(W,{mimeType:z}),J.addEventListener("dataavailable",function(C){G.push(C.data)}),J.start(200)}t(11,p=!p)}let ue=!1;function ke(){f==="image"&&m&&t(11,p=!p),f==="image"?d():we(),!p&&W&&(A("close_stream"),W.getTracks().forEach(h=>h.stop()),t(6,l.srcObject=null,l),t(12,ue=!1),window.setTimeout(()=>{t(0,U=null)},500),t(0,U=null))}let te=!1;function Ie(h){h.preventDefault(),h.stopPropagation(),t(13,te=!1)}function Ee(h){le[h?"unshift":"push"](()=>{l=h,t(6,l)})}const ye=async()=>Z(),De=()=>t(13,te=!0),Te=()=>t(13,te=!1);return r.$$set=h=>{"streaming"in h&&t(1,m=h.streaming),"pending"in h&&t(20,T=h.pending),"root"in h&&t(21,I=h.root),"stream_every"in h&&t(22,M=h.stream_every),"mode"in h&&t(2,f=h.mode),"mirror_webcam"in h&&t(3,v=h.mirror_webcam),"include_audio"in h&&t(23,w=h.include_audio),"i18n"in h&&t(4,y=h.i18n),"upload"in h&&t(24,S=h.upload),"value"in h&&t(0,U=h.value)},[U,m,f,v,y,We,l,i,a,n,o,p,ue,te,V,Z,ke,Ie,s,c,T,I,M,w,S,Ee,ye,De,Te]}class Ct extends oe{constructor(e){super(),ce(this,e,zt,Ut,ne,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,i18n:4,upload:24,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get click_outside(){return We}}const Rt=Ct;function qt(r){let e,t;return e=new rt({props:{Icon:nt,label:"Remove Image"}}),e.$on("click",r[1]),{c(){R(e.$$.fragment)},l(l){q(e.$$.fragment,l)},m(l,i){L(e,l,i),t=!0},p:Q,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){P(e,l)}}}function Lt(r){let e,t;return e=new dt({props:{$$slots:{default:[qt]},$$scope:{ctx:r}}}),{c(){R(e.$$.fragment)},l(l){q(e.$$.fragment,l)},m(l,i){L(e,l,i),t=!0},p(l,[i]){const a={};i&4&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){P(e,l)}}}function Pt(r){const e=pe();return[e,l=>{e("remove_image"),l.stopPropagation()}]}class At extends oe{constructor(e){super(),ce(this,e,Pt,Lt,ne,{})}}function qe(r){let e,t;return e=new At({}),e.$on("remove_image",r[28]),{c(){R(e.$$.fragment)},l(l){q(e.$$.fragment,l)},m(l,i){L(e,l,i),t=!0},p:Q,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){P(e,l)}}}function Le(r){let e;const t=r[27].default,l=Xe(t,r,r[42],null);return{c(){l&&l.c()},l(i){l&&l.l(i)},m(i,a){l&&l.m(i,a),e=!0},p(i,a){l&&l.p&&(!e||a[1]&2048)&&Ye(l,t,i,i[42],e?xe(t,i[42],a,null):$e(i[42]),null)},i(i){e||(k(l,i),e=!0)},o(i){E(l,i),e=!1},d(i){l&&l.d(i)}}}function Ht(r){let e,t,l=r[3]===null&&Le(r);return{c(){l&&l.c(),e=ee()},l(i){l&&l.l(i),e=ee()},m(i,a){l&&l.m(i,a),j(i,e,a),t=!0},p(i,a){i[3]===null?l?(l.p(i,a),a[0]&8&&k(l,1)):(l=Le(i),l.c(),k(l,1),l.m(e.parentNode,e)):l&&($(),E(l,1,1,()=>{l=null}),x())},i(i){t||(k(l),t=!0)},o(i){E(l),t=!1},d(i){i&&b(e),l&&l.d(i)}}}function Ft(r){let e,t,l,i,a;return t=new gt({props:{src:r[3].url,alt:r[3].alt_text}}),{c(){e=N("div"),R(t.$$.fragment),this.h()},l(n){e=O(n,"DIV",{class:!0});var o=B(e);q(t.$$.fragment,o),o.forEach(b),this.h()},h(){g(e,"class","image-frame svelte-1ti4ehe"),X(e,"selectable",r[11])},m(n,o){j(n,e,o),L(t,e,null),l=!0,i||(a=re(e,"click",r[24]),i=!0)},p(n,o){const s={};o[0]&8&&(s.src=n[3].url),o[0]&8&&(s.alt=n[3].alt_text),t.$set(s),(!l||o[0]&2048)&&X(e,"selectable",n[11])},i(n){l||(k(t.$$.fragment,n),l=!0)},o(n){E(t.$$.fragment,n),l=!1},d(n){n&&b(e),P(t),i=!1,a()}}}function Gt(r){let e,t,l,i;function a(s){r[33](s)}function n(s){r[34](s)}let o={root:r[12],value:r[3],mirror_webcam:r[10],stream_every:r[17],streaming:r[9],mode:"image",include_audio:!1,i18n:r[13],upload:r[15]};return r[4]!==void 0&&(o.modify_stream=r[4]),r[5]!==void 0&&(o.set_time_limit=r[5]),e=new Rt({props:o}),le.push(()=>he(e,"modify_stream",a)),le.push(()=>he(e,"set_time_limit",n)),e.$on("capture",r[35]),e.$on("stream",r[36]),e.$on("error",r[37]),e.$on("drag",r[38]),e.$on("upload",r[39]),e.$on("close_stream",r[40]),{c(){R(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,c){L(e,s,c),i=!0},p(s,c){const u={};c[0]&4096&&(u.root=s[12]),c[0]&8&&(u.value=s[3]),c[0]&1024&&(u.mirror_webcam=s[10]),c[0]&131072&&(u.stream_every=s[17]),c[0]&512&&(u.streaming=s[9]),c[0]&8192&&(u.i18n=s[13]),c[0]&32768&&(u.upload=s[15]),!t&&c[0]&16&&(t=!0,u.modify_stream=s[4],ge(()=>t=!1)),!l&&c[0]&32&&(l=!0,u.set_time_limit=s[5],ge(()=>l=!1)),e.$set(u)},i(s){i||(k(e.$$.fragment,s),i=!0)},o(s){E(e.$$.fragment,s),i=!1},d(s){P(e,s)}}}function Pe(r){let e,t,l;function i(n){r[41](n)}let a={sources:r[8],handle_clear:r[21],handle_select:r[25]};return r[1]!==void 0&&(a.active_source=r[1]),e=new ut({props:a}),le.push(()=>he(e,"active_source",i)),{c(){R(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,o){L(e,n,o),l=!0},p(n,o){const s={};o[0]&256&&(s.sources=n[8]),!t&&o[0]&2&&(t=!0,s.active_source=n[1],ge(()=>t=!1)),e.$set(s)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){E(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Jt(r){var Z;let e,t,l,i,a,n,o,s,c,u,m,T,I=r[8].length>1||r[8].includes("clipboard"),M;e=new st({props:{show_label:r[7],Icon:at,label:r[6]||"Image"}});let f=((Z=r[3])==null?void 0:Z.url)&&!r[18]&&qe(r);function v(d){r[30](d)}function w(d){r[31](d)}let y={hidden:r[3]!==null||r[1]==="webcam",filetype:r[1]==="clipboard"?"clipboard":"image/*",root:r[12],max_file_size:r[14],disable_click:!r[8].includes("upload")||r[3]!==null,upload:r[15],stream_handler:r[16],$$slots:{default:[Ht]},$$scope:{ctx:r}};r[0]!==void 0&&(y.uploading=r[0]),r[2]!==void 0&&(y.dragging=r[2]),n=new mt({props:y}),r[29](n),le.push(()=>he(n,"uploading",v)),le.push(()=>he(n,"dragging",w)),n.$on("load",r[20]),n.$on("error",r[32]);const S=[Gt,Ft],U=[];function A(d,p){return d[1]==="webcam"&&(d[9]||!d[9]&&!d[3])?0:d[3]!==null&&!d[9]?1:-1}~(u=A(r))&&(m=U[u]=S[u](r));let V=I&&Pe(r);return{c(){R(e.$$.fragment),t=H(),l=N("div"),f&&f.c(),i=H(),a=N("div"),R(n.$$.fragment),c=H(),m&&m.c(),T=H(),V&&V.c(),this.h()},l(d){q(e.$$.fragment,d),t=F(d),l=O(d,"DIV",{"data-testid":!0,class:!0});var p=B(l);f&&f.l(p),i=F(p),a=O(p,"DIV",{class:!0});var G=B(a);q(n.$$.fragment,G),c=F(G),m&&m.l(G),G.forEach(b),T=F(p),V&&V.l(p),p.forEach(b),this.h()},h(){g(a,"class","upload-container svelte-1ti4ehe"),X(a,"reduced-height",r[8].length>1),de(a,"width",r[3]?"auto":"100%"),g(l,"data-testid","image"),g(l,"class","image-container svelte-1ti4ehe")},m(d,p){L(e,d,p),j(d,t,p),j(d,l,p),f&&f.m(l,null),D(l,i),D(l,a),L(n,a,null),D(a,c),~u&&U[u].m(a,null),D(l,T),V&&V.m(l,null),M=!0},p(d,p){var J;const G={};p[0]&128&&(G.show_label=d[7]),p[0]&64&&(G.label=d[6]||"Image"),e.$set(G),(J=d[3])!=null&&J.url&&!d[18]?f?(f.p(d,p),p[0]&262152&&k(f,1)):(f=qe(d),f.c(),k(f,1),f.m(l,i)):f&&($(),E(f,1,1,()=>{f=null}),x());const W={};p[0]&10&&(W.hidden=d[3]!==null||d[1]==="webcam"),p[0]&2&&(W.filetype=d[1]==="clipboard"?"clipboard":"image/*"),p[0]&4096&&(W.root=d[12]),p[0]&16384&&(W.max_file_size=d[14]),p[0]&264&&(W.disable_click=!d[8].includes("upload")||d[3]!==null),p[0]&32768&&(W.upload=d[15]),p[0]&65536&&(W.stream_handler=d[16]),p[0]&8|p[1]&2048&&(W.$$scope={dirty:p,ctx:d}),!o&&p[0]&1&&(o=!0,W.uploading=d[0],ge(()=>o=!1)),!s&&p[0]&4&&(s=!0,W.dragging=d[2],ge(()=>s=!1)),n.$set(W);let z=u;u=A(d),u===z?~u&&U[u].p(d,p):(m&&($(),E(U[z],1,1,()=>{U[z]=null}),x()),~u?(m=U[u],m?m.p(d,p):(m=U[u]=S[u](d),m.c()),k(m,1),m.m(a,null)):m=null),(!M||p[0]&256)&&X(a,"reduced-height",d[8].length>1),p[0]&8&&de(a,"width",d[3]?"auto":"100%"),p[0]&256&&(I=d[8].length>1||d[8].includes("clipboard")),I?V?(V.p(d,p),p[0]&256&&k(V,1)):(V=Pe(d),V.c(),k(V,1),V.m(l,null)):V&&($(),E(V,1,1,()=>{V=null}),x())},i(d){M||(k(e.$$.fragment,d),k(f),k(n.$$.fragment,d),k(m),k(V),M=!0)},o(d){E(e.$$.fragment,d),E(f),E(n.$$.fragment,d),E(m),E(V),M=!1},d(d){d&&(b(t),b(l)),P(e,d),f&&f.d(),r[29](null),P(n),~u&&U[u].d(),V&&V.d()}}}function Qt(r,e,t){let l,{$$slots:i={},$$scope:a}=e,{value:n=null}=e,{label:o=void 0}=e,{show_label:s}=e,{sources:c=["upload","clipboard","webcam"]}=e,{streaming:u=!1}=e,{pending:m=!1}=e,{mirror_webcam:T}=e,{selectable:I=!1}=e,{root:M}=e,{i18n:f}=e,{max_file_size:v=null}=e,{upload:w}=e,{stream_handler:y}=e,{stream_every:S}=e,{modify_stream:U}=e,{set_time_limit:A}=e,V,{uploading:Z=!1}=e,{active_source:d=null}=e;function p({detail:_}){u||(t(3,n=_),z("upload"))}function G(){t(3,n=null),z("clear"),z("change",null)}async function W(_,ie){if(ie==="stream"){z("stream",{value:{url:_},is_value_data:!0});return}t(26,m=!0);const Ne=await V.load_files([new File([_],`image/${u?"jpeg":"png"}`)]);(ie==="change"||ie==="upload")&&(t(3,n=(Ne==null?void 0:Ne[0])||null),await Ke(),z("change")),t(26,m=!1)}const z=pe();let{dragging:J=!1}=e;function we(_){let ie=ft(_);ie&&z("select",{index:ie,value:null})}async function ue(_){switch(_){case"clipboard":V.paste_clipboard();break}}const ke=()=>{t(3,n=null),z("clear")};function te(_){le[_?"unshift":"push"](()=>{V=_,t(19,V)})}function Ie(_){Z=_,t(0,Z)}function Ee(_){J=_,t(2,J)}function ye(_){ve.call(this,r,_)}function De(_){U=_,t(4,U)}function Te(_){A=_,t(5,A)}const h=_=>W(_.detail,"change"),C=_=>W(_.detail,"stream");function K(_){ve.call(this,r,_)}function Y(_){ve.call(this,r,_)}const fe=_=>W(_.detail,"upload");function Ve(_){ve.call(this,r,_)}function Be(_){d=_,t(1,d),t(8,c)}return r.$$set=_=>{"value"in _&&t(3,n=_.value),"label"in _&&t(6,o=_.label),"show_label"in _&&t(7,s=_.show_label),"sources"in _&&t(8,c=_.sources),"streaming"in _&&t(9,u=_.streaming),"pending"in _&&t(26,m=_.pending),"mirror_webcam"in _&&t(10,T=_.mirror_webcam),"selectable"in _&&t(11,I=_.selectable),"root"in _&&t(12,M=_.root),"i18n"in _&&t(13,f=_.i18n),"max_file_size"in _&&t(14,v=_.max_file_size),"upload"in _&&t(15,w=_.upload),"stream_handler"in _&&t(16,y=_.stream_handler),"stream_every"in _&&t(17,S=_.stream_every),"modify_stream"in _&&t(4,U=_.modify_stream),"set_time_limit"in _&&t(5,A=_.set_time_limit),"uploading"in _&&t(0,Z=_.uploading),"active_source"in _&&t(1,d=_.active_source),"dragging"in _&&t(2,J=_.dragging),"$$scope"in _&&t(42,a=_.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&258&&!d&&c&&t(1,d=c[0]),r.$$.dirty[0]&514&&t(18,l=u&&d==="webcam"),r.$$.dirty[0]&262145&&Z&&!l&&t(3,n=null),r.$$.dirty[0]&4&&z("drag",J)},[Z,d,J,n,U,A,o,s,c,u,T,I,M,f,v,w,y,S,l,V,p,G,W,z,we,ue,m,i,ke,te,Ie,Ee,ye,De,Te,h,C,K,Y,fe,Ve,Be,a]}class Zt extends oe{constructor(e){super(),ce(this,e,Qt,Jt,ne,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:26,mirror_webcam:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,uploading:0,active_source:1,dragging:2},null,[-1,-1])}}const ol=Zt;export{ol as I,Rt as W};
