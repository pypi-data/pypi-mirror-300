import"./IconButtonWrapper.svelte_svelte_type_style_lang-CmXUdlCe.js";import{B as St}from"./BlockLabel-Cv02uVno.js";import{I as Ze}from"./IconButton-C-D_5yDc.js";import{E as Vt}from"./Empty-C9gXEcal.js";import{S as Dt}from"./ShareButton-DmBjC4wG.js";import{D as qt}from"./Download-DVtk-Jv3.js";import{V as pt}from"./Video-fsmLZWjA.js";import{I as $t}from"./IconButtonWrapper-KW86tCZp.js";import{f as _e,u as Ct}from"./utils-BiWkKWez.js";import{D as Mt}from"./DownloadLink-CoHnReV-.js";import{T as Rt,P as Lt}from"./Trim-JQYgj7Jd.js";import{P as Pt}from"./Play-B0Q0U1Qz.js";import{U as kt}from"./Undo-DCjBnnSO.js";import{b as Bt,t as It,V as At}from"./Video-C5Jn9qih.js";import{d as Ht}from"./index-D4gamfFG.js";/* empty css                                             */import{M as Nt}from"./ModifyUpload-BWETyjJO.js";const{SvelteComponent:Xt,append:Ut,attr:j,detach:jt,init:Ft,insert:Ot,noop:Oe,safe_not_equal:zt,svg_element:et}=window.__gradio__svelte__internal;function Wt(l){let e,n;return{c(){e=et("svg"),n=et("path"),j(n,"d","M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"),j(e,"xmlns","http://www.w3.org/2000/svg"),j(e,"width","100%"),j(e,"height","100%"),j(e,"viewBox","0 0 24 24"),j(e,"fill","none"),j(e,"stroke","currentColor"),j(e,"stroke-width","1.5"),j(e,"stroke-linecap","round"),j(e,"stroke-linejoin","round")},m(t,i){Ot(t,e,i),Ut(e,n)},p:Oe,i:Oe,o:Oe,d(t){t&&jt(e)}}}class Gt extends Xt{constructor(e){super(),Ft(this,e,null,Wt,zt,{})}}const{SvelteComponent:Jt,append:ae,attr:P,destroy_block:Kt,detach:Pe,element:se,ensure_array_like:tt,flush:we,init:Qt,insert:Be,listen:ue,noop:Ke,run_all:Yt,safe_not_equal:Zt,set_style:Z,space:ze,src_url_equal:nt,update_keyed_each:xt}=window.__gradio__svelte__internal,{onMount:lt,onDestroy:en}=window.__gradio__svelte__internal;function it(l,e,n){const t=l.slice();return t[20]=e[n],t[22]=n,t}function tn(l){let e,n,t,i,o,r=[],s=new Map,m,b,_,u,d=tt(l[1]);const f=w=>w[22];for(let w=0;w<d.length;w+=1){let p=it(l,d,w),y=f(p);s.set(y,r[w]=ot(y,p))}return{c(){e=se("div"),n=se("button"),t=ze(),i=se("div"),o=ze();for(let w=0;w<r.length;w+=1)r[w].c();m=ze(),b=se("button"),P(n,"aria-label","start drag handle for trimming video"),P(n,"class","handle left svelte-10c4beq"),Z(n,"left",l[2]+"%"),P(i,"class","opaque-layer svelte-10c4beq"),Z(i,"left",l[2]+"%"),Z(i,"right",100-l[3]+"%"),P(b,"aria-label","end drag handle for trimming video"),P(b,"class","handle right svelte-10c4beq"),Z(b,"left",l[3]+"%"),P(e,"id","timeline"),P(e,"class","thumbnail-wrapper svelte-10c4beq")},m(w,p){Be(w,e,p),ae(e,n),ae(e,t),ae(e,i),ae(e,o);for(let y=0;y<r.length;y+=1)r[y]&&r[y].m(e,null);ae(e,m),ae(e,b),_||(u=[ue(n,"mousedown",l[10]),ue(n,"blur",l[5]),ue(n,"keydown",l[11]),ue(b,"mousedown",l[12]),ue(b,"blur",l[5]),ue(b,"keydown",l[13])],_=!0)},p(w,p){p&4&&Z(n,"left",w[2]+"%"),p&4&&Z(i,"left",w[2]+"%"),p&8&&Z(i,"right",100-w[3]+"%"),p&2&&(d=tt(w[1]),r=xt(r,p,f,1,w,d,s,e,Kt,ot,m,it)),p&8&&Z(b,"left",w[3]+"%")},d(w){w&&Pe(e);for(let p=0;p<r.length;p+=1)r[p].d();_=!1,Yt(u)}}}function nn(l){let e;return{c(){e=se("div"),e.innerHTML='<span aria-label="loading timeline" class="loader svelte-10c4beq"></span>',P(e,"class","load-wrap svelte-10c4beq")},m(n,t){Be(n,e,t)},p:Ke,d(n){n&&Pe(e)}}}function ot(l,e){let n,t,i;return{key:l,first:null,c(){n=se("img"),nt(n.src,t=e[20])||P(n,"src",t),P(n,"alt",i=`frame-${e[22]}`),P(n,"draggable","false"),P(n,"class","svelte-10c4beq"),this.first=n},m(o,r){Be(o,n,r)},p(o,r){e=o,r&2&&!nt(n.src,t=e[20])&&P(n,"src",t),r&2&&i!==(i=`frame-${e[22]}`)&&P(n,"alt",i)},d(o){o&&Pe(n)}}}function ln(l){let e;function n(o,r){return o[0]?nn:tn}let t=n(l),i=t(l);return{c(){e=se("div"),i.c(),P(e,"class","container svelte-10c4beq")},m(o,r){Be(o,e,r),i.m(e,null)},p(o,[r]){t===(t=n(o))&&i?i.p(o,r):(i.d(1),i=t(o),i&&(i.c(),i.m(e,null)))},i:Ke,o:Ke,d(o){o&&Pe(e),i.d()}}}let We=10;function on(l,e,n){let{videoElement:t}=e,{trimmedDuration:i}=e,{dragStart:o}=e,{dragEnd:r}=e,{loadingTimeline:s}=e,m=[],b,_=0,u=100,d=null;const f=h=>{d=h},w=()=>{d=null},p=(h,E)=>{if(d){const c=document.getElementById("timeline");if(!c)return;const T=c.getBoundingClientRect();let V=(h.clientX-T.left)/T.width*100;if(E?V=d==="left"?_+E:u+E:V=(h.clientX-T.left)/T.width*100,V=Math.max(0,Math.min(V,100)),d==="left"){n(2,_=Math.min(V,u));const $=_/100*b;n(6,t.currentTime=$,t),n(8,o=$)}else if(d==="right"){n(3,u=Math.max(V,_));const $=u/100*b;n(6,t.currentTime=$,t),n(9,r=$)}const G=_/100*b,v=u/100*b;n(7,i=v-G),n(2,_),n(3,u)}},y=h=>{if(d){const E=1/b*100;h.key==="ArrowLeft"?p({clientX:0},-E):h.key==="ArrowRight"&&p({clientX:0},E)}},R=()=>{const h=document.createElement("canvas"),E=h.getContext("2d");if(!E)return;h.width=t.videoWidth,h.height=t.videoHeight,E.drawImage(t,0,0,h.width,h.height);const c=h.toDataURL("image/jpeg",.7);n(1,m=[...m,c])};lt(()=>{const h=()=>{b=t.duration;const E=b/We;let c=0;const T=()=>{R(),c++,c<We?n(6,t.currentTime+=E,t):t.removeEventListener("seeked",T)};t.addEventListener("seeked",T),n(6,t.currentTime=0,t)};t.readyState>=1?h():t.addEventListener("loadedmetadata",h)}),en(()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",w),window.removeEventListener("keydown",y)}),lt(()=>{window.addEventListener("mousemove",p),window.addEventListener("mouseup",w),window.addEventListener("keydown",y)});const B=()=>f("left"),L=h=>{(h.key==="ArrowLeft"||h.key=="ArrowRight")&&f("left")},N=()=>f("right"),I=h=>{(h.key==="ArrowLeft"||h.key=="ArrowRight")&&f("right")};return l.$$set=h=>{"videoElement"in h&&n(6,t=h.videoElement),"trimmedDuration"in h&&n(7,i=h.trimmedDuration),"dragStart"in h&&n(8,o=h.dragStart),"dragEnd"in h&&n(9,r=h.dragEnd),"loadingTimeline"in h&&n(0,s=h.loadingTimeline)},l.$$.update=()=>{l.$$.dirty&2&&n(0,s=m.length!==We)},[s,m,_,u,f,w,t,i,o,r,B,L,N,I]}class rn extends Jt{constructor(e){super(),Qt(this,e,on,ln,Zt,{videoElement:6,trimmedDuration:7,dragStart:8,dragEnd:9,loadingTimeline:0})}get videoElement(){return this.$$.ctx[6]}set videoElement(e){this.$$set({videoElement:e}),we()}get trimmedDuration(){return this.$$.ctx[7]}set trimmedDuration(e){this.$$set({trimmedDuration:e}),we()}get dragStart(){return this.$$.ctx[8]}set dragStart(e){this.$$set({dragStart:e}),we()}get dragEnd(){return this.$$.ctx[9]}set dragEnd(e){this.$$set({dragEnd:e}),we()}get loadingTimeline(){return this.$$.ctx[0]}set loadingTimeline(e){this.$$set({loadingTimeline:e}),we()}}const{SvelteComponent:sn,add_flush_callback:De,append:de,attr:z,bind:qe,binding_callbacks:$e,check_outros:Qe,create_component:Ie,destroy_component:Ae,detach:Q,element:ee,empty:an,flush:X,group_outros:Ye,init:un,insert:Y,listen:rt,mount_component:He,noop:_n,run_all:dn,safe_not_equal:fn,set_data:cn,space:Ee,text:mn,toggle_class:x,transition_in:H,transition_out:W}=window.__gradio__svelte__internal,{onMount:hn}=window.__gradio__svelte__internal;function st(l){let e,n,t,i,o,r,s;function m(f){l[18](f)}function b(f){l[19](f)}function _(f){l[20](f)}function u(f){l[21](f)}let d={videoElement:l[2]};return l[14]!==void 0&&(d.dragStart=l[14]),l[15]!==void 0&&(d.dragEnd=l[15]),l[12]!==void 0&&(d.trimmedDuration=l[12]),l[16]!==void 0&&(d.loadingTimeline=l[16]),n=new rn({props:d}),$e.push(()=>qe(n,"dragStart",m)),$e.push(()=>qe(n,"dragEnd",b)),$e.push(()=>qe(n,"trimmedDuration",_)),$e.push(()=>qe(n,"loadingTimeline",u)),{c(){e=ee("div"),Ie(n.$$.fragment),z(e,"class","timeline-wrapper svelte-7yrr5f")},m(f,w){Y(f,e,w),He(n,e,null),s=!0},p(f,w){const p={};w&4&&(p.videoElement=f[2]),!t&&w&16384&&(t=!0,p.dragStart=f[14],De(()=>t=!1)),!i&&w&32768&&(i=!0,p.dragEnd=f[15],De(()=>i=!1)),!o&&w&4096&&(o=!0,p.trimmedDuration=f[12],De(()=>o=!1)),!r&&w&65536&&(r=!0,p.loadingTimeline=f[16],De(()=>r=!1)),n.$set(p)},i(f){s||(H(n.$$.fragment,f),s=!0)},o(f){W(n.$$.fragment,f),s=!1},d(f){f&&Q(e),Ae(n)}}}function gn(l){let e;return{c(){e=ee("div"),z(e,"class","svelte-7yrr5f")},m(n,t){Y(n,e,t)},p:_n,d(n){n&&Q(e)}}}function bn(l){let e,n=_e(l[12])+"",t,i,o,r,s,m,b,_;return{c(){e=ee("time"),t=mn(n),i=Ee(),o=ee("div"),r=ee("button"),r.textContent="Trim",s=Ee(),m=ee("button"),m.textContent="Cancel",z(e,"aria-label","duration of selected region in seconds"),z(e,"class","svelte-7yrr5f"),x(e,"hidden",l[16]),z(r,"class","text-button svelte-7yrr5f"),x(r,"hidden",l[16]),z(m,"class","text-button svelte-7yrr5f"),x(m,"hidden",l[16]),z(o,"class","edit-buttons svelte-7yrr5f")},m(u,d){Y(u,e,d),de(e,t),Y(u,i,d),Y(u,o,d),de(o,r),de(o,s),de(o,m),b||(_=[rt(r,"click",l[22]),rt(m,"click",l[17])],b=!0)},p(u,d){d&4096&&n!==(n=_e(u[12])+"")&&cn(t,n),d&65536&&x(e,"hidden",u[16]),d&65536&&x(r,"hidden",u[16]),d&65536&&x(m,"hidden",u[16])},d(u){u&&(Q(e),Q(i),Q(o)),b=!1,dn(_)}}}function at(l){let e,n;return e=new Ze({props:{Icon:kt,label:"Reset video to initial value",disabled:l[1]||!l[11]}}),e.$on("click",l[23]),{c(){Ie(e.$$.fragment)},m(t,i){He(e,t,i),n=!0},p(t,i){const o={};i&2050&&(o.disabled=t[1]||!t[11]),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Ae(e,t)}}}function ut(l){let e,n;return e=new Ze({props:{Icon:Rt,label:"Trim video to selection",disabled:l[1]}}),e.$on("click",l[17]),{c(){Ie(e.$$.fragment)},m(t,i){He(e,t,i),n=!0},p(t,i){const o={};i&2&&(o.disabled=t[1]),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Ae(e,t)}}}function wn(l){let e,n,t,i=l[3]&&l[0]===""&&at(l),o=l[4]&&l[0]===""&&ut(l);return{c(){i&&i.c(),e=Ee(),o&&o.c(),n=an()},m(r,s){i&&i.m(r,s),Y(r,e,s),o&&o.m(r,s),Y(r,n,s),t=!0},p(r,s){r[3]&&r[0]===""?i?(i.p(r,s),s&9&&H(i,1)):(i=at(r),i.c(),H(i,1),i.m(e.parentNode,e)):i&&(Ye(),W(i,1,1,()=>{i=null}),Qe()),r[4]&&r[0]===""?o?(o.p(r,s),s&17&&H(o,1)):(o=ut(r),o.c(),H(o,1),o.m(n.parentNode,n)):o&&(Ye(),W(o,1,1,()=>{o=null}),Qe())},i(r){t||(H(i),H(o),t=!0)},o(r){W(i),W(o),t=!1},d(r){r&&(Q(e),Q(n)),i&&i.d(r),o&&o.d(r)}}}function vn(l){let e,n,t,i,o,r,s=l[0]==="edit"&&st(l);function m(u,d){return u[0]==="edit"&&u[12]!==null?bn:gn}let b=m(l),_=b(l);return o=new Nt({props:{i18n:l[7],download:l[9]?l[8]?.url:null,$$slots:{default:[wn]},$$scope:{ctx:l}}}),o.$on("clear",l[24]),{c(){e=ee("div"),s&&s.c(),n=Ee(),t=ee("div"),_.c(),i=Ee(),Ie(o.$$.fragment),z(t,"class","controls svelte-7yrr5f"),z(t,"data-testid","waveform-controls"),z(e,"class","container svelte-7yrr5f"),x(e,"hidden",l[0]!=="edit")},m(u,d){Y(u,e,d),s&&s.m(e,null),de(e,n),de(e,t),_.m(t,null),Y(u,i,d),He(o,u,d),r=!0},p(u,[d]){u[0]==="edit"?s?(s.p(u,d),d&1&&H(s,1)):(s=st(u),s.c(),H(s,1),s.m(e,n)):s&&(Ye(),W(s,1,1,()=>{s=null}),Qe()),b===(b=m(u))&&_?_.p(u,d):(_.d(1),_=b(u),_&&(_.c(),_.m(t,null))),(!r||d&1)&&x(e,"hidden",u[0]!=="edit");const f={};d&128&&(f.i18n=u[7]),d&768&&(f.download=u[9]?u[8]?.url:null),d&33556539&&(f.$$scope={dirty:d,ctx:u}),o.$set(f)},i(u){r||(H(s),H(o.$$.fragment,u),r=!0)},o(u){W(s),W(o.$$.fragment,u),r=!1},d(u){u&&(Q(e),Q(i)),s&&s.d(),_.d(),Ae(o,u)}}}function pn(l,e,n){let{videoElement:t}=e,{showRedo:i=!1}=e,{interactive:o=!0}=e,{mode:r=""}=e,{handle_reset_value:s}=e,{handle_trim_video:m}=e,{processingVideo:b=!1}=e,{i18n:_}=e,{value:u=null}=e,{show_download_button:d=!1}=e,{handle_clear:f=()=>{}}=e,{has_change_history:w=!1}=e,p;hn(async()=>{n(13,p=await Bt())});let y=null,R=0,B=0,L=!1;const N=()=>{r==="edit"?(n(0,r=""),n(12,y=t.duration)):n(0,r="edit")};function I(v){R=v,n(14,R)}function h(v){B=v,n(15,B)}function E(v){y=v,n(12,y),n(0,r),n(2,t)}function c(v){L=v,n(16,L)}const T=()=>{n(0,r=""),n(1,b=!0),It(p,R,B,t).then(v=>{m(v)}).then(()=>{n(1,b=!1)})},V=()=>{s(),n(0,r="")},G=()=>f();return l.$$set=v=>{"videoElement"in v&&n(2,t=v.videoElement),"showRedo"in v&&n(3,i=v.showRedo),"interactive"in v&&n(4,o=v.interactive),"mode"in v&&n(0,r=v.mode),"handle_reset_value"in v&&n(5,s=v.handle_reset_value),"handle_trim_video"in v&&n(6,m=v.handle_trim_video),"processingVideo"in v&&n(1,b=v.processingVideo),"i18n"in v&&n(7,_=v.i18n),"value"in v&&n(8,u=v.value),"show_download_button"in v&&n(9,d=v.show_download_button),"handle_clear"in v&&n(10,f=v.handle_clear),"has_change_history"in v&&n(11,w=v.has_change_history)},l.$$.update=()=>{l.$$.dirty&4101&&r==="edit"&&y===null&&t&&n(12,y=t.duration)},[r,b,t,i,o,s,m,_,u,d,f,w,y,p,R,B,L,N,I,h,E,c,T,V,G]}class kn extends sn{constructor(e){super(),un(this,e,pn,vn,fn,{videoElement:2,showRedo:3,interactive:4,mode:0,handle_reset_value:5,handle_trim_video:6,processingVideo:1,i18n:7,value:8,show_download_button:9,handle_clear:10,has_change_history:11})}get videoElement(){return this.$$.ctx[2]}set videoElement(e){this.$$set({videoElement:e}),X()}get showRedo(){return this.$$.ctx[3]}set showRedo(e){this.$$set({showRedo:e}),X()}get interactive(){return this.$$.ctx[4]}set interactive(e){this.$$set({interactive:e}),X()}get mode(){return this.$$.ctx[0]}set mode(e){this.$$set({mode:e}),X()}get handle_reset_value(){return this.$$.ctx[5]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),X()}get handle_trim_video(){return this.$$.ctx[6]}set handle_trim_video(e){this.$$set({handle_trim_video:e}),X()}get processingVideo(){return this.$$.ctx[1]}set processingVideo(e){this.$$set({processingVideo:e}),X()}get i18n(){return this.$$.ctx[7]}set i18n(e){this.$$set({i18n:e}),X()}get value(){return this.$$.ctx[8]}set value(e){this.$$set({value:e}),X()}get show_download_button(){return this.$$.ctx[9]}set show_download_button(e){this.$$set({show_download_button:e}),X()}get handle_clear(){return this.$$.ctx[10]}set handle_clear(e){this.$$set({handle_clear:e}),X()}get has_change_history(){return this.$$.ctx[11]}set has_change_history(e){this.$$set({has_change_history:e}),X()}}const{SvelteComponent:yn,add_flush_callback:pe,append:A,attr:q,bind:ke,binding_callbacks:ye,bubble:Ge,check_outros:_t,create_component:fe,destroy_component:ce,detach:Ce,element:K,empty:En,flush:D,group_outros:dt,init:Tn,insert:Me,listen:oe,mount_component:me,prevent_default:ft,run_all:Sn,safe_not_equal:Vn,set_data:ct,space:ve,src_url_equal:mt,stop_propagation:Dn,text:Je,toggle_class:ht,transition_in:U,transition_out:O}=window.__gradio__svelte__internal,{createEventDispatcher:qn}=window.__gradio__svelte__internal;function $n(l){let e,n;return{c(){e=K("track"),q(e,"kind","captions"),mt(e.src,n=l[1])||q(e,"src",n),e.default=!0},m(t,i){Me(t,e,i)},p(t,i){i[0]&2&&!mt(e.src,n=t[1])&&q(e,"src",n)},d(t){t&&Ce(e)}}}function Cn(l){let e,n;return e=new Lt({}),{c(){fe(e.$$.fragment)},m(t,i){me(e,t,i),n=!0},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){ce(e,t)}}}function Mn(l){let e,n;return e=new Pt({}),{c(){fe(e.$$.fragment)},m(t,i){me(e,t,i),n=!0},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){ce(e,t)}}}function Rn(l){let e,n;return e=new kt({}),{c(){fe(e.$$.fragment)},m(t,i){me(e,t,i),n=!0},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){ce(e,t)}}}function gt(l){let e,n,t;function i(r){l[35](r)}let o={videoElement:l[17],showRedo:!0,handle_trim_video:l[23],handle_reset_value:l[7],value:l[11],i18n:l[9],show_download_button:l[10],handle_clear:l[12],has_change_history:l[13]};return l[18]!==void 0&&(o.processingVideo=l[18]),e=new kn({props:o}),ye.push(()=>ke(e,"processingVideo",i)),{c(){fe(e.$$.fragment)},m(r,s){me(e,r,s),t=!0},p(r,s){const m={};s[0]&131072&&(m.videoElement=r[17]),s[0]&128&&(m.handle_reset_value=r[7]),s[0]&2048&&(m.value=r[11]),s[0]&512&&(m.i18n=r[9]),s[0]&1024&&(m.show_download_button=r[10]),s[0]&4096&&(m.handle_clear=r[12]),s[0]&8192&&(m.has_change_history=r[13]),!n&&s[0]&262144&&(n=!0,m.processingVideo=r[18],pe(()=>n=!1)),e.$set(m)},i(r){t||(U(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){ce(e,r)}}}function Ln(l){let e,n,t,i,o,r,s,m,b,_,u,d,f,w,p,y=_e(l[14])+"",R,B,L=_e(l[15])+"",N,I,h,E,c,T,V,G,v,$,be,Te;function Ne(g){l[28](g)}function Xe(g){l[29](g)}function Ue(g){l[30](g)}function je(g){l[31](g)}let ie={src:l[0],preload:"auto",autoplay:l[3],loop:l[4],is_stream:l[8],"data-testid":`${l[5]}-player`,processingVideo:l[18],$$slots:{default:[$n]},$$scope:{ctx:l}};l[14]!==void 0&&(ie.currentTime=l[14]),l[15]!==void 0&&(ie.duration=l[15]),l[16]!==void 0&&(ie.paused=l[16]),l[17]!==void 0&&(ie.node=l[17]),t=new At({props:ie}),ye.push(()=>ke(t,"currentTime",Ne)),ye.push(()=>ke(t,"duration",Xe)),ye.push(()=>ke(t,"paused",Ue)),ye.push(()=>ke(t,"node",je)),t.$on("click",l[20]),t.$on("play",l[32]),t.$on("pause",l[33]),t.$on("ended",l[22]),t.$on("load",l[34]);const Se=[Rn,Mn,Cn],J=[];function Ve(g,k){return g[14]===g[15]?0:g[16]?1:2}d=Ve(l),f=J[d]=Se[d](l),V=new Gt({});let a=l[6]&&gt(l);return{c(){e=K("div"),n=K("div"),fe(t.$$.fragment),m=ve(),b=K("div"),_=K("div"),u=K("span"),f.c(),w=ve(),p=K("span"),R=Je(y),B=Je(" / "),N=Je(L),I=ve(),h=K("progress"),c=ve(),T=K("div"),fe(V.$$.fragment),G=ve(),a&&a.c(),v=En(),q(n,"class","mirror-wrap svelte-euo1cw"),ht(n,"mirror",l[2]),q(u,"role","button"),q(u,"tabindex","0"),q(u,"class","icon svelte-euo1cw"),q(u,"aria-label","play-pause-replay-button"),q(p,"class","time svelte-euo1cw"),h.value=E=l[14]/l[15]||0,q(h,"class","svelte-euo1cw"),q(T,"role","button"),q(T,"tabindex","0"),q(T,"class","icon svelte-euo1cw"),q(T,"aria-label","full-screen"),q(_,"class","inner svelte-euo1cw"),q(b,"class","controls svelte-euo1cw"),q(e,"class","wrap svelte-euo1cw")},m(g,k){Me(g,e,k),A(e,n),me(t,n,null),A(e,m),A(e,b),A(b,_),A(_,u),J[d].m(u,null),A(_,w),A(_,p),A(p,R),A(p,B),A(p,N),A(_,I),A(_,h),A(_,c),A(_,T),me(V,T,null),Me(g,G,k),a&&a.m(g,k),Me(g,v,k),$=!0,be||(Te=[oe(u,"click",l[20]),oe(u,"keydown",l[20]),oe(h,"mousemove",l[19]),oe(h,"touchmove",ft(l[19])),oe(h,"click",Dn(ft(l[21]))),oe(T,"click",l[24]),oe(T,"keypress",l[24])],be=!0)},p(g,k){const C={};k[0]&1&&(C.src=g[0]),k[0]&8&&(C.autoplay=g[3]),k[0]&16&&(C.loop=g[4]),k[0]&256&&(C.is_stream=g[8]),k[0]&32&&(C["data-testid"]=`${g[5]}-player`),k[0]&262144&&(C.processingVideo=g[18]),k[0]&2|k[1]&64&&(C.$$scope={dirty:k,ctx:g}),!i&&k[0]&16384&&(i=!0,C.currentTime=g[14],pe(()=>i=!1)),!o&&k[0]&32768&&(o=!0,C.duration=g[15],pe(()=>o=!1)),!r&&k[0]&65536&&(r=!0,C.paused=g[16],pe(()=>r=!1)),!s&&k[0]&131072&&(s=!0,C.node=g[17],pe(()=>s=!1)),t.$set(C),(!$||k[0]&4)&&ht(n,"mirror",g[2]);let Fe=d;d=Ve(g),d!==Fe&&(dt(),O(J[Fe],1,1,()=>{J[Fe]=null}),_t(),f=J[d],f||(f=J[d]=Se[d](g),f.c()),U(f,1),f.m(u,null)),(!$||k[0]&16384)&&y!==(y=_e(g[14])+"")&&ct(R,y),(!$||k[0]&32768)&&L!==(L=_e(g[15])+"")&&ct(N,L),(!$||k[0]&49152&&E!==(E=g[14]/g[15]||0))&&(h.value=E),g[6]?a?(a.p(g,k),k[0]&64&&U(a,1)):(a=gt(g),a.c(),U(a,1),a.m(v.parentNode,v)):a&&(dt(),O(a,1,1,()=>{a=null}),_t())},i(g){$||(U(t.$$.fragment,g),U(f),U(V.$$.fragment,g),U(a),$=!0)},o(g){O(t.$$.fragment,g),O(f),O(V.$$.fragment,g),O(a),$=!1},d(g){g&&(Ce(e),Ce(G),Ce(v)),ce(t),J[d].d(),ce(V),a&&a.d(g),be=!1,Sn(Te)}}}function Pn(l,e,n){let{root:t=""}=e,{src:i}=e,{subtitle:o=null}=e,{mirror:r}=e,{autoplay:s}=e,{loop:m}=e,{label:b="test"}=e,{interactive:_=!1}=e,{handle_change:u=()=>{}}=e,{handle_reset_value:d=()=>{}}=e,{upload:f}=e,{is_stream:w}=e,{i18n:p}=e,{show_download_button:y=!1}=e,{value:R=null}=e,{handle_clear:B=()=>{}}=e,{has_change_history:L=!1}=e;const N=qn();let I=0,h,E=!0,c,T=!1;function V(a){if(!h)return;if(a.type==="click"){v(a);return}if(a.type!=="touchmove"&&!(a.buttons&1))return;const g=a.type==="touchmove"?a.touches[0].clientX:a.clientX,{left:k,right:C}=a.currentTarget.getBoundingClientRect();n(14,I=h*(g-k)/(C-k))}async function G(){document.fullscreenElement!=c&&(c.currentTime>0&&!c.paused&&!c.ended&&c.readyState>c.HAVE_CURRENT_DATA?c.pause():await c.play())}function v(a){const{left:g,right:k}=a.currentTarget.getBoundingClientRect();n(14,I=h*(a.clientX-g)/(k-g))}function $(){N("stop"),N("end")}const be=async a=>{let g=new File([a],"video.mp4");const k=await Ht([g]);let C=(await f(k,t))?.filter(Boolean)[0];u(C)};function Te(){c.requestFullscreen()}function Ne(a){I=a,n(14,I)}function Xe(a){h=a,n(15,h)}function Ue(a){E=a,n(16,E)}function je(a){c=a,n(17,c)}function ie(a){Ge.call(this,l,a)}function Se(a){Ge.call(this,l,a)}function J(a){Ge.call(this,l,a)}function Ve(a){T=a,n(18,T)}return l.$$set=a=>{"root"in a&&n(25,t=a.root),"src"in a&&n(0,i=a.src),"subtitle"in a&&n(1,o=a.subtitle),"mirror"in a&&n(2,r=a.mirror),"autoplay"in a&&n(3,s=a.autoplay),"loop"in a&&n(4,m=a.loop),"label"in a&&n(5,b=a.label),"interactive"in a&&n(6,_=a.interactive),"handle_change"in a&&n(26,u=a.handle_change),"handle_reset_value"in a&&n(7,d=a.handle_reset_value),"upload"in a&&n(27,f=a.upload),"is_stream"in a&&n(8,w=a.is_stream),"i18n"in a&&n(9,p=a.i18n),"show_download_button"in a&&n(10,y=a.show_download_button),"value"in a&&n(11,R=a.value),"handle_clear"in a&&n(12,B=a.handle_clear),"has_change_history"in a&&n(13,L=a.has_change_history)},[i,o,r,s,m,b,_,d,w,p,y,R,B,L,I,h,E,c,T,V,G,v,$,be,Te,t,u,f,Ne,Xe,Ue,je,ie,Se,J,Ve]}class Bn extends yn{constructor(e){super(),Tn(this,e,Pn,Ln,Vn,{root:25,src:0,subtitle:1,mirror:2,autoplay:3,loop:4,label:5,interactive:6,handle_change:26,handle_reset_value:7,upload:27,is_stream:8,i18n:9,show_download_button:10,value:11,handle_clear:12,has_change_history:13},null,[-1,-1])}get root(){return this.$$.ctx[25]}set root(e){this.$$set({root:e}),D()}get src(){return this.$$.ctx[0]}set src(e){this.$$set({src:e}),D()}get subtitle(){return this.$$.ctx[1]}set subtitle(e){this.$$set({subtitle:e}),D()}get mirror(){return this.$$.ctx[2]}set mirror(e){this.$$set({mirror:e}),D()}get autoplay(){return this.$$.ctx[3]}set autoplay(e){this.$$set({autoplay:e}),D()}get loop(){return this.$$.ctx[4]}set loop(e){this.$$set({loop:e}),D()}get label(){return this.$$.ctx[5]}set label(e){this.$$set({label:e}),D()}get interactive(){return this.$$.ctx[6]}set interactive(e){this.$$set({interactive:e}),D()}get handle_change(){return this.$$.ctx[26]}set handle_change(e){this.$$set({handle_change:e}),D()}get handle_reset_value(){return this.$$.ctx[7]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),D()}get upload(){return this.$$.ctx[27]}set upload(e){this.$$set({upload:e}),D()}get is_stream(){return this.$$.ctx[8]}set is_stream(e){this.$$set({is_stream:e}),D()}get i18n(){return this.$$.ctx[9]}set i18n(e){this.$$set({i18n:e}),D()}get show_download_button(){return this.$$.ctx[10]}set show_download_button(e){this.$$set({show_download_button:e}),D()}get value(){return this.$$.ctx[11]}set value(e){this.$$set({value:e}),D()}get handle_clear(){return this.$$.ctx[12]}set handle_clear(e){this.$$set({handle_clear:e}),D()}get has_change_history(){return this.$$.ctx[13]}set has_change_history(e){this.$$set({has_change_history:e}),D()}}const In=Bn,{SvelteComponent:An,attr:Hn,bubble:re,check_outros:Re,create_component:te,destroy_component:ne,detach:he,element:Nn,empty:yt,flush:F,group_outros:Le,init:Xn,insert:ge,mount_component:le,noop:Et,safe_not_equal:Tt,space:xe,transition_in:S,transition_out:M}=window.__gradio__svelte__internal,{createEventDispatcher:Un,afterUpdate:jn,tick:Fn}=window.__gradio__svelte__internal;function On(l){let e=l[0].url,n,t,i,o,r=bt(l);return i=new $t({props:{$$slots:{default:[Gn]},$$scope:{ctx:l}}}),{c(){r.c(),n=xe(),t=Nn("div"),te(i.$$.fragment),Hn(t,"data-testid","download-div")},m(s,m){r.m(s,m),ge(s,n,m),ge(s,t,m),le(i,t,null),o=!0},p(s,m){m&1&&Tt(e,e=s[0].url)?(Le(),M(r,1,1,Et),Re(),r=bt(s),r.c(),S(r,1),r.m(n.parentNode,n)):r.p(s,m);const b={};m&2097505&&(b.$$scope={dirty:m,ctx:s}),i.$set(b)},i(s){o||(S(r),S(i.$$.fragment,s),o=!0)},o(s){M(r),M(i.$$.fragment,s),o=!1},d(s){s&&(he(n),he(t)),r.d(s),ne(i)}}}function zn(l){let e,n;return e=new Vt({props:{unpadded_box:!0,size:"large",$$slots:{default:[Jn]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p(t,i){const o={};i&2097152&&(o.$$scope={dirty:i,ctx:t}),e.$set(o)},i(t){n||(S(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function bt(l){let e,n;return e=new In({props:{src:l[0].url,subtitle:l[1]?.url,is_stream:l[0].is_stream,autoplay:l[4],mirror:!1,label:l[2],loop:l[7],interactive:!1,upload:l[9],i18n:l[8]}}),e.$on("play",l[10]),e.$on("pause",l[11]),e.$on("stop",l[12]),e.$on("end",l[13]),e.$on("load",l[14]),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p(t,i){const o={};i&1&&(o.src=t[0].url),i&2&&(o.subtitle=t[1]?.url),i&1&&(o.is_stream=t[0].is_stream),i&16&&(o.autoplay=t[4]),i&4&&(o.label=t[2]),i&128&&(o.loop=t[7]),i&512&&(o.upload=t[9]),i&256&&(o.i18n=t[8]),e.$set(o)},i(t){n||(S(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function wt(l){let e,n;return e=new Mt({props:{href:l[0].is_stream?l[0].url?.replace("playlist.m3u8","playlist-file"):l[0].url,download:l[0].orig_name||l[0].path,$$slots:{default:[Wn]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p(t,i){const o={};i&1&&(o.href=t[0].is_stream?t[0].url?.replace("playlist.m3u8","playlist-file"):t[0].url),i&1&&(o.download=t[0].orig_name||t[0].path),i&2097152&&(o.$$scope={dirty:i,ctx:t}),e.$set(o)},i(t){n||(S(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Wn(l){let e,n;return e=new Ze({props:{Icon:qt,label:"Download"}}),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p:Et,i(t){n||(S(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function vt(l){let e,n;return e=new Dt({props:{i18n:l[8],value:l[0],formatter:l[15]}}),e.$on("error",l[16]),e.$on("share",l[17]),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p(t,i){const o={};i&256&&(o.i18n=t[8]),i&1&&(o.value=t[0]),e.$set(o)},i(t){n||(S(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Gn(l){let e,n,t,i=l[6]&&wt(l),o=l[5]&&vt(l);return{c(){i&&i.c(),e=xe(),o&&o.c(),n=yt()},m(r,s){i&&i.m(r,s),ge(r,e,s),o&&o.m(r,s),ge(r,n,s),t=!0},p(r,s){r[6]?i?(i.p(r,s),s&64&&S(i,1)):(i=wt(r),i.c(),S(i,1),i.m(e.parentNode,e)):i&&(Le(),M(i,1,1,()=>{i=null}),Re()),r[5]?o?(o.p(r,s),s&32&&S(o,1)):(o=vt(r),o.c(),S(o,1),o.m(n.parentNode,n)):o&&(Le(),M(o,1,1,()=>{o=null}),Re())},i(r){t||(S(i),S(o),t=!0)},o(r){M(i),M(o),t=!1},d(r){r&&(he(e),he(n)),i&&i.d(r),o&&o.d(r)}}}function Jn(l){let e,n;return e=new pt({}),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},i(t){n||(S(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Kn(l){let e,n,t,i,o,r;e=new St({props:{show_label:l[3],Icon:pt,label:l[2]||"Video"}});const s=[zn,On],m=[];function b(_,u){return!_[0]||_[0].url===void 0?0:1}return t=b(l),i=m[t]=s[t](l),{c(){te(e.$$.fragment),n=xe(),i.c(),o=yt()},m(_,u){le(e,_,u),ge(_,n,u),m[t].m(_,u),ge(_,o,u),r=!0},p(_,[u]){const d={};u&8&&(d.show_label=_[3]),u&4&&(d.label=_[2]||"Video"),e.$set(d);let f=t;t=b(_),t===f?m[t].p(_,u):(Le(),M(m[f],1,1,()=>{m[f]=null}),Re(),i=m[t],i?i.p(_,u):(i=m[t]=s[t](_),i.c()),S(i,1),i.m(o.parentNode,o))},i(_){r||(S(e.$$.fragment,_),S(i),r=!0)},o(_){M(e.$$.fragment,_),M(i),r=!1},d(_){_&&(he(n),he(o)),ne(e,_),m[t].d(_)}}}function Qn(l,e,n){let{value:t=null}=e,{subtitle:i=null}=e,{label:o=void 0}=e,{show_label:r=!0}=e,{autoplay:s}=e,{show_share_button:m=!0}=e,{show_download_button:b=!0}=e,{loop:_}=e,{i18n:u}=e,{upload:d}=e,f=null,w=null;const p=Un();jn(async()=>{t!==f&&i!==w&&w!==null&&(f=t,n(0,t=null),await Fn(),n(0,t=f)),f=t,w=i});function y(c){re.call(this,l,c)}function R(c){re.call(this,l,c)}function B(c){re.call(this,l,c)}function L(c){re.call(this,l,c)}function N(c){re.call(this,l,c)}const I=async c=>c?await Ct(c.data):"";function h(c){re.call(this,l,c)}function E(c){re.call(this,l,c)}return l.$$set=c=>{"value"in c&&n(0,t=c.value),"subtitle"in c&&n(1,i=c.subtitle),"label"in c&&n(2,o=c.label),"show_label"in c&&n(3,r=c.show_label),"autoplay"in c&&n(4,s=c.autoplay),"show_share_button"in c&&n(5,m=c.show_share_button),"show_download_button"in c&&n(6,b=c.show_download_button),"loop"in c&&n(7,_=c.loop),"i18n"in c&&n(8,u=c.i18n),"upload"in c&&n(9,d=c.upload)},l.$$.update=()=>{l.$$.dirty&1&&t&&p("change",t)},[t,i,o,r,s,m,b,_,u,d,y,R,B,L,N,I,h,E]}class Yn extends An{constructor(e){super(),Xn(this,e,Qn,Kn,Tt,{value:0,subtitle:1,label:2,show_label:3,autoplay:4,show_share_button:5,show_download_button:6,loop:7,i18n:8,upload:9})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),F()}get subtitle(){return this.$$.ctx[1]}set subtitle(e){this.$$set({subtitle:e}),F()}get label(){return this.$$.ctx[2]}set label(e){this.$$set({label:e}),F()}get show_label(){return this.$$.ctx[3]}set show_label(e){this.$$set({show_label:e}),F()}get autoplay(){return this.$$.ctx[4]}set autoplay(e){this.$$set({autoplay:e}),F()}get show_share_button(){return this.$$.ctx[5]}set show_share_button(e){this.$$set({show_share_button:e}),F()}get show_download_button(){return this.$$.ctx[6]}set show_download_button(e){this.$$set({show_download_button:e}),F()}get loop(){return this.$$.ctx[7]}set loop(e){this.$$set({loop:e}),F()}get i18n(){return this.$$.ctx[8]}set i18n(e){this.$$set({i18n:e}),F()}get upload(){return this.$$.ctx[9]}set upload(e){this.$$set({upload:e}),F()}}const hl=Object.freeze(Object.defineProperty({__proto__:null,default:Yn},Symbol.toStringTag,{value:"Module"}));export{In as P,Yn as V,hl as a};
//# sourceMappingURL=VideoPreview-Cy-C3pK4.js.map
