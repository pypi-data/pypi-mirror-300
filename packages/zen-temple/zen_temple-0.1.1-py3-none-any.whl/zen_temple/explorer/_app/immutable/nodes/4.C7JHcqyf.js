import{s as at,e as p,c as g,b as w,f,y as wt,o as b,i as Q,h as u,z as Xe,A as Ze,n as $e,B as kt,C as Et,G as yt,t as Dt,a as O,d as Ct,g as S,D as xe,j as It,E as Vt,r as j,m as le,v as Me,w as z,F as et}from"../chunks/scheduler.Bjr9RZaN.js";import{S as it,i as rt,b as B,c as ve,d as me,m as we,t as x,a as se,e as Tt,f as ke,g as Ht}from"../chunks/index.NoFf4Nre.js";import{S as Lt,B as Mt,b as Ot,c as St,f as jt}from"../chunks/utils.4gDQ54k9.js";import{e as tt}from"../chunks/each.D6YF6ztN.js";function ot(e,n,o){const i=e.slice();return i[8]=n[o],i}function nt(e){let n,o=e[8]+"",i,a,m;return{c(){n=p("option"),i=Dt(o),a=O(),this.h()},l(c){n=g(c,"OPTION",{});var l=w(n);i=Ct(l,o),a=S(l),l.forEach(f),this.h()},h(){n.__value=m=e[8],xe(n,n.__value)},m(c,l){Q(c,n,l),u(n,i),u(n,a)},p(c,l){l&2&&o!==(o=c[8]+"")&&It(i,o),l&2&&m!==(m=c[8])&&(n.__value=m,xe(n,n.__value))},d(c){c&&f(n)}}}function zt(e){let n,o,i,a,m,c=tt(e[1]),l=[];for(let s=0;s<c.length;s+=1)l[s]=nt(ot(e,c,s));return{c(){n=p("div"),o=p("select");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){n=g(s,"DIV",{class:!0});var _=w(n);o=g(_,"SELECT",{});var r=w(o);for(let E=0;E<l.length;E+=1)l[E].l(r);r.forEach(f),_.forEach(f),this.h()},h(){o.disabled=i=!e[2],e[0]===void 0&&wt(()=>e[4].call(o)),b(n,"class","dropdown")},m(s,_){Q(s,n,_),u(n,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(o,null);Xe(o,e[0],!0),a||(m=[Ze(o,"change",e[4]),Ze(o,"change",e[5])],a=!0)},p(s,[_]){if(_&2){c=tt(s[1]);let r;for(r=0;r<c.length;r+=1){const E=ot(s,c,r);l[r]?l[r].p(E,_):(l[r]=nt(E),l[r].c(),l[r].m(o,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=c.length}_&4&&i!==(i=!s[2])&&(o.disabled=i),_&3&&Xe(o,s[0])},i:$e,o:$e,d(s){s&&f(n),kt(l,s),a=!1,Et(m)}}}function Bt(e,n,o){let{options:i}=n,{selected_option:a=i[0]}=n,{enabled:m=!0}=n;i.join("_");const c=yt();function l(){c("selection-changed",a)}function s(){a=Vt(this),o(0,a),o(1,i)}const _=()=>l();return e.$$set=r=>{"options"in r&&o(1,i=r.options),"selected_option"in r&&o(0,a=r.selected_option),"enabled"in r&&o(2,m=r.enabled)},[a,i,m,l,s,_]}class Ne extends it{constructor(n){super(),rt(this,n,Bt,zt,at,{options:1,selected_option:0,enabled:2})}}function lt(e){let n,o='<div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){n=p("div"),n.innerHTML=o,this.h()},l(i){n=g(i,"DIV",{class:!0,"data-svelte-h":!0}),le(n)!=="svelte-57s7b4"&&(n.innerHTML=o),this.h()},h(){b(n,"class","text-center")},m(i,a){Q(i,n,a)},d(i){i&&f(n)}}}function st(e){let n,o,i,a;function m(l){e[24](l)}let c={zoom:!0};return e[10]!==void 0&&(c.config=e[10]),o=new Mt({props:c}),j.push(()=>B(o,"config",m)),{c(){n=p("div"),ve(o.$$.fragment),this.h()},l(l){n=g(l,"DIV",{style:!0});var s=w(n);me(o.$$.fragment,s),s.forEach(f),this.h()},h(){Me(n,"position","relative")},m(l,s){Q(l,n,s),we(o,n,null),a=!0},p(l,s){const _={};!i&&s&1024&&(i=!0,_.config=l[10],z(()=>i=!1)),o.$set(_)},i(l){a||(x(o.$$.fragment,l),a=!0)},o(l){se(o.$$.fragment,l),a=!1},d(l){l&&f(n),ke(o)}}}function Pt(e){let n,o='<div class="col"><h2>The Energy Balance</h2></div>',i,a,m,c,l,s,_,r='<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button>',E,C,H,y,V,ue,ae,fe,_e,pe,G,R,Ee='<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button>',ge,N,M,U,W,X,h="Year",A,L,ee,te,he,T,P,Z,be="Node",d,D,Oe,Se,je,ie,$,re,We="Carrier",ze,q,Be,Pe,ye,oe,F,De,Ce;function dt(t){e[13](t)}function ct(t){e[14](t)}function ut(t){e[15](t)}function ft(t){e[16](t)}function _t(t){e[17](t)}let de={enabled:!e[2]&&!e[3]};e[6]!==void 0&&(de.carriers=e[6]),e[4]!==void 0&&(de.nodes=e[4]),e[8]!==void 0&&(de.years=e[8]),e[0]!==void 0&&(de.selected_solution=e[0]),e[2]!==void 0&&(de.loading=e[2]),y=new Lt({props:de}),j.push(()=>B(y,"carriers",dt)),j.push(()=>B(y,"nodes",ct)),j.push(()=>B(y,"years",ut)),j.push(()=>B(y,"selected_solution",ft)),j.push(()=>B(y,"loading",_t)),y.$on("solution_selected",e[11]);function pt(t){e[18](t)}function gt(t){e[19](t)}let qe={enabled:!e[3]&&!e[2]};e[8]!==void 0&&(qe.options=e[8]),e[9]!==void 0&&(qe.selected_option=e[9]),L=new Ne({props:qe}),j.push(()=>B(L,"options",pt)),j.push(()=>B(L,"selected_option",gt)),L.$on("selection-changed",e[12]);function ht(t){e[20](t)}function bt(t){e[21](t)}let Fe={enabled:!e[3]&&!e[2]};e[4]!==void 0&&(Fe.options=e[4]),e[5]!==void 0&&(Fe.selected_option=e[5]),D=new Ne({props:Fe}),j.push(()=>B(D,"options",ht)),j.push(()=>B(D,"selected_option",bt)),D.$on("selection-changed",e[12]);function vt(t){e[22](t)}function mt(t){e[23](t)}let Ge={enabled:!e[3]&&!e[2]};e[6]!==void 0&&(Ge.options=e[6]),e[7]!==void 0&&(Ge.selected_option=e[7]),q=new Ne({props:Ge}),j.push(()=>B(q,"options",vt)),j.push(()=>B(q,"selected_option",mt)),q.$on("selection-changed",e[12]);let I=e[3]&&lt(),k=!e[3]&&e[1]&&st(e);return{c(){n=p("div"),n.innerHTML=o,i=O(),a=p("div"),m=p("div"),c=p("div"),l=p("div"),s=p("div"),_=p("h2"),_.innerHTML=r,E=O(),C=p("div"),H=p("div"),ve(y.$$.fragment),pe=O(),G=p("div"),R=p("h2"),R.innerHTML=Ee,ge=O(),N=p("div"),M=p("div"),U=p("div"),W=p("div"),X=p("h3"),X.textContent=h,A=O(),ve(L.$$.fragment),he=O(),T=p("div"),P=p("div"),Z=p("h3"),Z.textContent=be,d=O(),ve(D.$$.fragment),je=O(),ie=p("div"),$=p("div"),re=p("h3"),re.textContent=We,ze=O(),ve(q.$$.fragment),ye=O(),oe=p("div"),F=p("div"),I&&I.c(),De=O(),k&&k.c(),this.h()},l(t){n=g(t,"DIV",{class:!0,"data-svelte-h":!0}),le(n)!=="svelte-1d6fcfp"&&(n.innerHTML=o),i=S(t),a=g(t,"DIV",{class:!0});var v=w(a);m=g(v,"DIV",{class:!0});var K=w(m);c=g(K,"DIV",{class:!0,style:!0});var ne=w(c);l=g(ne,"DIV",{class:!0,id:!0});var Y=w(l);s=g(Y,"DIV",{class:!0});var J=w(s);_=g(J,"H2",{class:!0,"data-svelte-h":!0}),le(_)!=="svelte-1oln34a"&&(_.innerHTML=r),E=S(J),C=g(J,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Ae=w(C);H=g(Ae,"DIV",{class:!0});var Ke=w(H);me(y.$$.fragment,Ke),Ke.forEach(f),Ae.forEach(f),J.forEach(f),pe=S(Y),G=g(Y,"DIV",{class:!0});var Ie=w(G);R=g(Ie,"H2",{class:!0,"data-svelte-h":!0}),le(R)!=="svelte-1huxmzt"&&(R.innerHTML=Ee),ge=S(Ie),N=g(Ie,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Re=w(N);M=g(Re,"DIV",{class:!0});var ce=w(M);U=g(ce,"DIV",{class:!0});var Ye=w(U);W=g(Ye,"DIV",{class:!0});var Ve=w(W);X=g(Ve,"H3",{"data-svelte-h":!0}),le(X)!=="svelte-r9e7qt"&&(X.textContent=h),A=S(Ve),me(L.$$.fragment,Ve),Ve.forEach(f),Ye.forEach(f),he=S(ce),T=g(ce,"DIV",{class:!0});var Je=w(T);P=g(Je,"DIV",{class:!0});var Te=w(P);Z=g(Te,"H3",{"data-svelte-h":!0}),le(Z)!=="svelte-ocjo5w"&&(Z.textContent=be),d=S(Te),me(D.$$.fragment,Te),Te.forEach(f),Je.forEach(f),je=S(ce),ie=g(ce,"DIV",{class:!0});var Qe=w(ie);$=g(Qe,"DIV",{class:!0});var He=w($);re=g(He,"H3",{"data-svelte-h":!0}),le(re)!=="svelte-xc22hm"&&(re.textContent=We),ze=S(He),me(q.$$.fragment,He),He.forEach(f),Qe.forEach(f),ce.forEach(f),Re.forEach(f),Ie.forEach(f),Y.forEach(f),ne.forEach(f),K.forEach(f),v.forEach(f),ye=S(t),oe=g(t,"DIV",{class:!0});var Ue=w(oe);F=g(Ue,"DIV",{class:!0,style:!0});var Le=w(F);I&&I.l(Le),De=S(Le),k&&k.l(Le),Le.forEach(f),Ue.forEach(f),this.h()},h(){b(n,"class","row"),b(_,"class","accordion-header"),b(H,"class","accordion-body"),b(C,"id","collapseOne"),b(C,"class","accordion-collapse collapse show"),b(C,"data-bs-parent","#accordionExample"),b(s,"class","accordion-item solution-selection"),b(R,"class","accordion-header"),b(W,"class","col-6"),b(U,"class","row"),b(P,"class","col-6"),b(T,"class","row"),b($,"class","col-6"),b(ie,"class","row"),b(M,"class","accordion-body"),b(N,"id","collapseTwo"),b(N,"class","accordion-collapse collapse"),b(N,"data-bs-parent","#accordionExample"),b(G,"class","accordion-item"),b(l,"class","accordion"),b(l,"id","accordionExample"),b(c,"class","filters"),Me(c,"position","absolute"),Me(c,"width","100%"),b(m,"class","col position-relative"),b(a,"class","row"),b(F,"class","col"),Me(F,"margin-top","400px"),b(oe,"class","row")},m(t,v){Q(t,n,v),Q(t,i,v),Q(t,a,v),u(a,m),u(m,c),u(c,l),u(l,s),u(s,_),u(s,E),u(s,C),u(C,H),we(y,H,null),u(l,pe),u(l,G),u(G,R),u(G,ge),u(G,N),u(N,M),u(M,U),u(U,W),u(W,X),u(W,A),we(L,W,null),u(M,he),u(M,T),u(T,P),u(P,Z),u(P,d),we(D,P,null),u(M,je),u(M,ie),u(ie,$),u($,re),u($,ze),we(q,$,null),Q(t,ye,v),Q(t,oe,v),u(oe,F),I&&I.m(F,null),u(F,De),k&&k.m(F,null),Ce=!0},p(t,[v]){const K={};v&12&&(K.enabled=!t[2]&&!t[3]),!V&&v&64&&(V=!0,K.carriers=t[6],z(()=>V=!1)),!ue&&v&16&&(ue=!0,K.nodes=t[4],z(()=>ue=!1)),!ae&&v&256&&(ae=!0,K.years=t[8],z(()=>ae=!1)),!fe&&v&1&&(fe=!0,K.selected_solution=t[0],z(()=>fe=!1)),!_e&&v&4&&(_e=!0,K.loading=t[2],z(()=>_e=!1)),y.$set(K);const ne={};v&12&&(ne.enabled=!t[3]&&!t[2]),!ee&&v&256&&(ee=!0,ne.options=t[8],z(()=>ee=!1)),!te&&v&512&&(te=!0,ne.selected_option=t[9],z(()=>te=!1)),L.$set(ne);const Y={};v&12&&(Y.enabled=!t[3]&&!t[2]),!Oe&&v&16&&(Oe=!0,Y.options=t[4],z(()=>Oe=!1)),!Se&&v&32&&(Se=!0,Y.selected_option=t[5],z(()=>Se=!1)),D.$set(Y);const J={};v&12&&(J.enabled=!t[3]&&!t[2]),!Be&&v&64&&(Be=!0,J.options=t[6],z(()=>Be=!1)),!Pe&&v&128&&(Pe=!0,J.selected_option=t[7],z(()=>Pe=!1)),q.$set(J),t[3]?I||(I=lt(),I.c(),I.m(F,De)):I&&(I.d(1),I=null),!t[3]&&t[1]?k?(k.p(t,v),v&10&&x(k,1)):(k=st(t),k.c(),x(k,1),k.m(F,null)):k&&(Ht(),se(k,1,1,()=>{k=null}),Tt())},i(t){Ce||(x(y.$$.fragment,t),x(L.$$.fragment,t),x(D.$$.fragment,t),x(q.$$.fragment,t),x(k),Ce=!0)},o(t){se(y.$$.fragment,t),se(L.$$.fragment,t),se(D.$$.fragment,t),se(q.$$.fragment,t),se(k),Ce=!1},d(t){t&&(f(n),f(i),f(a),f(ye),f(oe)),ke(y),ke(L),ke(D),ke(q),I&&I.d(),k&&k.d()}}}function qt(e,n,o){var i=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let a=null,m=!1,c=!1,l=!1,s=[],_=null,r=[],E=null,C=[],H=null;const y={counter:1,type:"line",data:{datasets:[]},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,title:{display:!0,text:"Power"}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}}}};let V=structuredClone(y);async function ue(){a&&(o(10,V=structuredClone(y)),o(5,_=s[0]),o(7,E=r[0]),o(9,H=C[0]),o(1,m=!1),await ae())}async function ae(){if(o(3,l=!0),et(),_==null||E==null||H==null||a==null){o(3,l=!1);return}let h=Math.floor((H-a.detail.system.reference_year)/a.detail.system.interval_between_years);console.log("Getting energy balance.");let A=await Ot(a.solution_name,_,E,a.scenario_name,h),L=await St(a.solution_name,"flow_export",a.scenario_name),ee=[],te=0;for(const T in A){let P={node:[_]};if(A[T]==null||A[T].data.length==0)continue;if("technology"in A[T].data[0]){let d=[];for(const D of A[T].data)d.push(D.technology);P={technology:d}}let Z={},be=jt(A[T].data,P,Z);if(be.length!=0)for(let d of be){if(Object.keys(d.data).length==0)continue;switch(T){case"flow_storage_discharge":d.label=d.label+" (discharge)";break;case"flow_transport_in":d.label=d.label+" (transport in)";break;case"flow_import":d.label="Import";break;case"shed_demand":d.label="Shed Demand";break;case"flow_storage_charge":d.label=d.label+" (charge)";break;case"flow_transport_out":d.label=d.label+" (transport out)";break;case"flow_export":d.label="Export";break}let D="line";Object.keys(d.data).length==1&&(D="bar"),T=="demand"?(d.label="Demand",d.type="line",d.stack="ownCustomStack",d.fill=!1,d.borderColor="black",d.backgroundColor="white",d.borderWidth=2,d.stepped=!0,Object.keys(d.data).length==1&&(d.pointRadius=2)):(d.type=D,d.fill="origin",d.borderColor=i[te%i.length],d.backgroundColor=i[te%i.length].replace(")",", 1)"),d.stepped=!0,d.cubicInterpolationMode="monotone"),ee.push(d),te++}}o(10,V.data.labels=Object.keys(ee[0].data),V),o(10,V.data.datasets=ee,V),o(10,V.options.scales.y.title.text="Power ["+L+"]",V),o(3,l=!1),o(1,m=!0);let he=performance.now();await et(),console.log("Building plot took",performance.now()-he)}function fe(h){r=h,o(6,r)}function _e(h){s=h,o(4,s)}function pe(h){C=h,o(8,C)}function G(h){a=h,o(0,a)}function R(h){c=h,o(2,c)}function Ee(h){C=h,o(8,C)}function ge(h){H=h,o(9,H)}function N(h){s=h,o(4,s)}function M(h){_=h,o(5,_)}function U(h){r=h,o(6,r)}function W(h){E=h,o(7,E)}function X(h){V=h,o(10,V)}return[a,m,c,l,s,_,r,E,C,H,V,ue,ae,fe,_e,pe,G,R,Ee,ge,N,M,U,W,X]}class At extends it{constructor(n){super(),rt(this,n,qt,Pt,at,{})}}export{At as component};
