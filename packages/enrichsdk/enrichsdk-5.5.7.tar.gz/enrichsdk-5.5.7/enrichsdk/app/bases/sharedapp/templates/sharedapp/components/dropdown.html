{% load i18n %}
{% load dashboard_tags %}

{% if dropdown.label %}
<h4>{% translate dropdown.label %}</h4>
{% endif %}
    <div class="column">
        <div class="form-group">
        {%  if dropdown.dropdown_type == 'select' %}
                <select class="selectpicker form-control" id="{{widget.id}}_{{dropdown.id}}" name="{{dropdown.id}}" data-live-search-placeholder="Search" data-live-search="true" data-container="body" data-size="5">
                    {% for choice in dropdown.choices %}
{#                        <option value="{% if dropdown.valuelist %}{{ dropdown.valuelist|index:forloop.counter0 }}{% else %}{{choice}} {% endif %}" title="{{choice}}" {% if dropdown.selected_choice == choice %}selected{% endif%}>{{choice}}</option>#}
                        <option value="{{ choice }}" title="{{choice}}" {% if dropdown.selected_choice == choice %}selected{% endif%}>{{choice}}</option>
                    {% endfor %}
                </select>
                <label>{{dropdown.description}}</label>
        {% elif dropdown.dropdown_type == 'date' %}
                <input type="text" name="{{dropdown.id}}" class="form-control datepicker" id="{{widget.id}}_{{dropdown.id}}" placeholder="Date e.g., 2023-01-01" value="{% if dropdown.selected_choice %}{{ dropdown.selected_choice }}{% else %}{% now 'Y-m-d' %}{% endif %}" autocomplete="off">

                </select>
        {% endif %}
        </div>
</div>

<script>
  $('#{{widget.id}}_{{dropdown.id}}').change(function(e){
      let url_path = window.location.href.split('?')[0];
      selected_choice = $('#{{widget.id}}_{{dropdown.id}} option:selected').text();
      window.location = url_path + "?{{dropdown.id}}=" + selected_choice;
  });
</script>
