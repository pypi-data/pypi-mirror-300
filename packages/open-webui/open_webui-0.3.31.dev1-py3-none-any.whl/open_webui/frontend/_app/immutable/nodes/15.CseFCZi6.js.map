{"version":3,"file":"15.CseFCZi6.js","sources":["../../../../../../src/lib/components/workspace/Knowledge/ItemMenu.svelte","../../../../../../src/lib/components/workspace/Knowledge.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { getContext, createEventDispatcher } from 'svelte';\n\tconst dispatch = createEventDispatcher();\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport Pencil from '$lib/components/icons/Pencil.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Tags from '$lib/components/chat/Tags.svelte';\n\timport Share from '$lib/components/icons/Share.svelte';\n\timport ArchiveBox from '$lib/components/icons/ArchiveBox.svelte';\n\timport DocumentDuplicate from '$lib/components/icons/DocumentDuplicate.svelte';\n\timport ArrowDownTray from '$lib/components/icons/ArrowDownTray.svelte';\n\timport ArrowUpCircle from '$lib/components/icons/ArrowUpCircle.svelte';\n\timport EllipsisHorizontal from '$lib/components/icons/EllipsisHorizontal.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let onClose: Function = () => {};\n\n\tlet show = false;\n</script>\n\n<Dropdown\n\tbind:show\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n\talign=\"end\"\n>\n\t<Tooltip content={$i18n.t('More')}>\n\t\t<slot\n\t\t\t><button\n\t\t\t\tclass=\"self-center w-fit text-sm p-1.5 dark:text-gray-300 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/5 rounded-xl\"\n\t\t\t\ttype=\"button\"\n\t\t\t\ton:click={(e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tshow = true;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<EllipsisHorizontal className=\"size-5\" />\n\t\t\t</button>\n\t\t</slot>\n\t</Tooltip>\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[160px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow\"\n\t\t\tsideOffset={-2}\n\t\t\tside=\"bottom\"\n\t\t\talign=\"end\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex  gap-2  items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tdispatch('delete');\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<GarbageBin strokeWidth=\"2\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Delete')}</div>\n\t\t\t</DropdownMenu.Item>\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport Fuse from 'fuse.js';\n\n\timport dayjs from 'dayjs';\n\timport relativeTime from 'dayjs/plugin/relativeTime';\n\tdayjs.extend(relativeTime);\n\n\timport { toast } from 'svelte-sonner';\n\timport { onMount, getContext } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { WEBUI_NAME, knowledge } from '$lib/stores';\n\n\timport { getKnowledgeItems, deleteKnowledgeById } from '$lib/apis/knowledge';\n\n\timport { blobToFile, transformFileName } from '$lib/utils';\n\n\timport { goto } from '$app/navigation';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport GarbageBin from '../icons/GarbageBin.svelte';\n\timport Pencil from '../icons/Pencil.svelte';\n\timport DeleteConfirmDialog from '../common/ConfirmDialog.svelte';\n\timport ItemMenu from './Knowledge/ItemMenu.svelte';\n\n\tlet query = '';\n\tlet selectedItem = null;\n\tlet showDeleteConfirm = false;\n\n\tlet fuse = null;\n\n\tlet filteredItems = [];\n\t$: if (fuse) {\n\t\tfilteredItems = query\n\t\t\t? fuse.search(query).map((e) => {\n\t\t\t\t\treturn e.item;\n\t\t\t\t})\n\t\t\t: $knowledge;\n\t}\n\n\tconst deleteHandler = async (item) => {\n\t\tconst res = await deleteKnowledgeById(localStorage.token, item.id).catch((e) => {\n\t\t\ttoast.error(e);\n\t\t});\n\n\t\tif (res) {\n\t\t\tknowledge.set(await getKnowledgeItems(localStorage.token));\n\t\t\ttoast.success($i18n.t('Knowledge deleted successfully.'));\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\tknowledge.set(await getKnowledgeItems(localStorage.token));\n\n\t\tknowledge.subscribe((value) => {\n\t\t\tfuse = new Fuse(value, {\n\t\t\t\tkeys: ['name', 'description']\n\t\t\t});\n\t\t});\n\t});\n</script>\n\n<svelte:head>\n\t<title>\n\t\t{$i18n.t('Knowledge')} | {$WEBUI_NAME}\n\t</title>\n</svelte:head>\n\n<DeleteConfirmDialog\n\tbind:show={showDeleteConfirm}\n\ton:confirm={() => {\n\t\tdeleteHandler(selectedItem);\n\t}}\n/>\n\n<div class=\"mb-3\">\n\t<div class=\"flex justify-between items-center\">\n\t\t<div class=\"flex md:self-center text-lg font-medium px-0.5\">\n\t\t\t{$i18n.t('Knowledge')}\n\t\t\t<div class=\"flex self-center w-[1px] h-6 mx-2.5 bg-gray-200 dark:bg-gray-700\" />\n\t\t\t<span class=\"text-lg font-medium text-gray-500 dark:text-gray-300\">{$knowledge.length}</span>\n\t\t</div>\n\t</div>\n</div>\n\n<div class=\" flex w-full space-x-2\">\n\t<div class=\"flex flex-1\">\n\t\t<div class=\" self-center ml-1 mr-3\">\n\t\t\t<svg\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\tfill=\"currentColor\"\n\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t>\n\t\t\t\t<path\n\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\td=\"M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z\"\n\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t/>\n\t\t\t</svg>\n\t\t</div>\n\t\t<input\n\t\t\tclass=\" w-full text-sm pr-4 py-1 rounded-r-xl outline-none bg-transparent\"\n\t\t\tbind:value={query}\n\t\t\tplaceholder={$i18n.t('Search Knowledge')}\n\t\t/>\n\t</div>\n\n\t<div>\n\t\t<button\n\t\t\tclass=\" px-2 py-2 rounded-xl border border-gray-50 dark:border-gray-800 dark:border-0 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 transition font-medium text-sm flex items-center space-x-1\"\n\t\t\taria-label={$i18n.t('Create Knowledge')}\n\t\t\ton:click={() => {\n\t\t\t\tgoto('/workspace/knowledge/create');\n\t\t\t}}\n\t\t>\n\t\t\t<svg\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\tfill=\"currentColor\"\n\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t>\n\t\t\t\t<path\n\t\t\t\t\td=\"M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z\"\n\t\t\t\t/>\n\t\t\t</svg>\n\t\t</button>\n\t</div>\n</div>\n\n<hr class=\" border-gray-50 dark:border-gray-850 my-2.5\" />\n\n<div class=\"my-3 mb-5 grid lg:grid-cols-2 xl:grid-cols-3 gap-2\">\n\t{#each filteredItems as item}\n\t\t<button\n\t\t\tclass=\" flex space-x-4 cursor-pointer text-left w-full px-4 py-3 border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-xl\"\n\t\t\ton:click={() => {\n\t\t\t\tif (item?.meta?.document) {\n\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t$i18n.t(\n\t\t\t\t\t\t\t'Only collections can be edited, create a new knowledge base to edit/add documents.'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tgoto(`/workspace/knowledge/${item.id}`);\n\t\t\t\t}\n\t\t\t}}\n\t\t>\n\t\t\t<div class=\" w-full\">\n\t\t\t\t<div class=\"flex items-center justify-between -mt-1\">\n\t\t\t\t\t<div class=\" font-semibold line-clamp-1 h-fit\">{item.name}</div>\n\n\t\t\t\t\t<div class=\" flex self-center\">\n\t\t\t\t\t\t<ItemMenu\n\t\t\t\t\t\t\ton:delete={() => {\n\t\t\t\t\t\t\t\tselectedItem = item;\n\t\t\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\" self-center flex-1\">\n\t\t\t\t\t<div class=\" text-xs overflow-hidden text-ellipsis line-clamp-1\">\n\t\t\t\t\t\t{item.description}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"mt-5 flex justify-between\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t{#if item?.meta?.document}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded uppercase text-xs font-bold px-1\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{$i18n.t('Document')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"bg-green-500/20 text-green-700 dark:text-green-200 rounded uppercase text-xs font-bold px-1\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{$i18n.t('Collection')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\" text-xs text-gray-500\">\n\t\t\t\t\t\t\tUpdated {dayjs(item.updated_at * 1000).fromNow()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</button>\n\t{/each}\n</div>\n\n<div class=\" text-gray-500 text-xs mt-1 mb-2\">\n\tâ“˜ {$i18n.t(\"Use '#' in the prompt input to load and include your knowledge.\")}\n</div>\n"],"names":["insert_hydration","target","button","anchor","ctx","div","set_data","t1","t1_value","flyAndScale","dispatch","createEventDispatcher","i18n","getContext","onClose","show","e","$$invalidate","t_value","t0_value","t3_value","t7_value","dayjs","_b","_a","create_if_block","append_hydration","div8","div2","div0","div1","div7","div3","div6","div4","div5","current","dirty","t0","t3","t7","t5_value","title_value","i","span","input","svg1","path1","hr","div9","t2","t2_value","t5","each_blocks","t13","t13_value","relativeTime","query","selectedItem","showDeleteConfirm","fuse","filteredItems","deleteHandler","item","deleteKnowledgeById","toast","knowledge","getKnowledgeItems","$i18n","onMount","value","Fuse","goto","$knowledge"],"mappings":"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"}