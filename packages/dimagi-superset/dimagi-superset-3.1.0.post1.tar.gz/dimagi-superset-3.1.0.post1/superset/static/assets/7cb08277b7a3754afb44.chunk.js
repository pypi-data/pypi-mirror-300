"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9563],{54070:(e,t,a)=>{a.d(t,{w:()=>s}),a(67294);var r=a(58593),l=a(83379),n=a(61988),o=a(11965);const s=e=>{let{user:t,date:a}=e;const s=(0,o.tZ)("span",{className:"no-wrap"},a);if(t){const e=(0,l.Z)(t),a=(0,n.t)("Modified by: %s",e);return(0,o.tZ)(r.u,{title:a,placement:"bottom"},s)}return s}},29848:(e,t,a)=>{a.d(t,{Z:()=>c}),a(67294);var r=a(51995),l=a(58593),n=a(70707),o=a(11965);const s=r.iK.span`
  white-space: nowrap;
  min-width: 100px;
  svg,
  i {
    margin-right: 8px;

    &:hover {
      path {
        fill: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
      }
    }
  }
`,i=r.iK.span`
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
`;function c(e){let{actions:t}=e;return(0,o.tZ)(s,{className:"actions"},t.map(((e,t)=>{const a=n.Z[e.icon];return e.tooltip?(0,o.tZ)(l.u,{id:`${e.label}-tooltip`,title:e.tooltip,placement:e.placement,key:t},(0,o.tZ)(i,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick},(0,o.tZ)(a,null))):(0,o.tZ)(i,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick,key:t},(0,o.tZ)(a,null))})))}},94222:(e,t,a)=>{a.d(t,{Z:()=>u});var r=a(51995),l=a(61988),n=(a(67294),a(58593)),o=a(70707),s=a(90335),i=a(11965);function c(e,t,a){switch(e){case s.Z.Working:return a.colors.primary.base;case s.Z.Error:return a.colors.error.base;case s.Z.Success:return t?a.colors.success.base:a.colors.alert.base;case s.Z.Noop:return a.colors.success.base;case s.Z.Grace:return a.colors.alert.base;default:return a.colors.grayscale.base}}function u(e){let{state:t,isReportEnabled:a=!1}=e;const u=(0,r.Fg)(),d={icon:o.Z.Check,label:"",status:""};switch(t){case s.Z.Success:d.icon=a?o.Z.Check:o.Z.AlertSolidSmall,d.label=a?(0,l.t)("Report sent"):(0,l.t)("Alert triggered, notification sent"),d.status=s.Z.Success;break;case s.Z.Working:d.icon=o.Z.Running,d.label=a?(0,l.t)("Report sending"):(0,l.t)("Alert running"),d.status=s.Z.Working;break;case s.Z.Error:d.icon=o.Z.XSmall,d.label=a?(0,l.t)("Report failed"):(0,l.t)("Alert failed"),d.status=s.Z.Error;break;case s.Z.Noop:d.icon=o.Z.Check,d.label=(0,l.t)("Nothing triggered"),d.status=s.Z.Noop;break;case s.Z.Grace:d.icon=o.Z.AlertSolidSmall,d.label=(0,l.t)("Alert Triggered, In Grace Period"),d.status=s.Z.Grace;break;default:d.icon=o.Z.Check,d.label=(0,l.t)("Nothing triggered"),d.status=s.Z.Noop}const p=d.icon;return(0,i.tZ)(n.u,{title:d.label,placement:"bottomLeft"},(0,i.tZ)(p,{iconColor:c(d.status,a,u)}))}},90335:(e,t,a)=>{var r,l;a.d(t,{Z:()=>r,u:()=>l}),function(e){e.Success="Success",e.Working="Working",e.Error="Error",e.Noop="Not triggered",e.Grace="On Grace"}(r||(r={})),function(e){e.Email="Email",e.Slack="Slack"}(l||(l={}))},32635:(e,t,a)=>{a.r(t),a.d(t,{default:()=>K});var r=a(67294),l=a(16550),n=a(75049),o=a(61988),s=a(22102),i=a(51995),c=a(31069),u=a(30381),d=a.n(u),p=a(29848),m=a(34581),g=a(58593),Z=a(93139),b=a(86074),h=a(12441),k=a(27600),f=a(14114),y=a(94222),w=a(11965),S=a(70707),v=a(90335);const C=e=>w.iv`
  color: ${e.colors.grayscale.light1};
  margin-right: ${2*e.gridUnit}px;
`;function E(e){let{type:t}=e;const a={icon:null,label:""};switch(t){case v.u.Email:a.icon=(0,w.tZ)(S.Z.Email,{css:C}),a.label=v.u.Email;break;case v.u.Slack:a.icon=(0,w.tZ)(S.Z.Slack,{css:C}),a.label=v.u.Slack;break;default:a.icon=null,a.label=""}return a.icon?(0,w.tZ)(g.u,{title:a.label,placement:"bottom"},a.icon):null}var $=a(19259),x=a(17198);d().updateLocale("en",{calendar:{lastDay:"[Yesterday at] LTS",sameDay:"[Today at] LTS",nextDay:"[Tomorrow at] LTS",lastWeek:"[last] dddd [at] LTS",nextWeek:"dddd [at] LTS",sameElse:"L"}});const _=i.iK.span`
  color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
`,A=(0,i.iK)(S.Z.Refresh)`
  color: ${e=>{let{theme:t}=e;return t.colors.primary.base}};
  width: auto;
  height: ${e=>{let{theme:t}=e;return 5*t.gridUnit}}px;
  position: relative;
  top: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  left: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  cursor: pointer;
`,N=e=>{let{updatedAt:t,update:a}=e;const[l,n]=(0,r.useState)(d()(t));return(0,r.useEffect)((()=>{n((()=>d()(t)));const e=setInterval((()=>{n((()=>d()(t)))}),6e4);return()=>clearInterval(e)}),[t]),(0,w.tZ)(_,null,(0,o.t)("Last Updated %s",l.isValid()?l.calendar():"--"),a&&(0,w.tZ)(A,{onClick:a}))};var T=a(34858),L=a(40768),R=a(22318),z=a(20095),D=a(54070),H=a(12);const W=(0,n.I)(),G={[v.Z.Success]:(0,o.t)("Success"),[v.Z.Working]:(0,o.t)("Working"),[v.Z.Error]:(0,o.t)("Error"),[v.Z.Noop]:(0,o.t)("Not triggered"),[v.Z.Grace]:(0,o.t)("On Grace")},B=(0,s.Z)({requestType:"rison",method:"DELETE",endpoint:"/api/v1/report/"}),I=i.iK.div`
  width: 100%;
  padding: 0 ${e=>{let{theme:t}=e;return 4*t.gridUnit}}px
    ${e=>{let{theme:t}=e;return 3*t.gridUnit}}px;
  background-color: ${e=>{let{theme:t}=e;return t.colors.grayscale.light5}};
`,M=i.iK.div`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  > *:first-child {
    margin-right: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  }
`,U=W.get("alertsreports.header.icon"),K=(0,f.ZP)((function(e){let{addDangerToast:t,isReportEnabled:a=!1,user:n,addSuccessToast:s}=e;const i=a?(0,o.t)("report"):(0,o.t)("alert"),u=a?(0,o.t)("reports"):(0,o.t)("alerts"),f=a?"Reports":"Alerts",S=(0,r.useMemo)((()=>[{id:"type",operator:Z.p.equals,value:a?"Report":"Alert"}]),[a]),{state:{loading:C,resourceCount:_,resourceCollection:A,bulkSelectEnabled:W,lastFetched:K},hasPerm:F,fetchData:O,setResourceCollection:P,refreshData:q,toggleBulkSelect:V}=(0,T.Yi)("report",(0,o.t)("reports"),t,!0,void 0,S),{updateResource:Y}=(0,T.LE)("report",(0,o.t)("reports"),t),[j,J]=(0,r.useState)(!1),[X,Q]=(0,r.useState)(null),[ee,te]=(0,r.useState)(null);function ae(e){Q(e),J(!0)}const re=F("can_write"),le=F("can_write"),ne=F("can_write");(0,r.useEffect)((()=>{W&&le&&V()}),[a]);const oe=[{id:"name",desc:!0}],se=(0,r.useCallback)(((e,t)=>{if(null!=e&&e.id){const a=e.id,r=[...A];P(r.map((a=>(null==a?void 0:a.id)===e.id?{...a,active:t}:a))),Y(a,{active:t},!1,!1).then().catch((()=>P(r)))}}),[A,P,Y]),ie=(0,r.useMemo)((()=>[{Cell:e=>{let{row:{original:{last_state:t}}}=e;return(0,w.tZ)(y.Z,{state:t,isReportEnabled:a})},accessor:"last_state",size:"xs",disableSortBy:!0},{Cell:e=>{let{row:{original:{last_eval_dttm:t}}}=e;return t?d().utc(t).local().format(k.v2):""},accessor:"last_eval_dttm",Header:(0,o.t)("Last run"),size:"lg"},{accessor:"name",Header:(0,o.t)("Name"),size:"xl"},{Header:(0,o.t)("Schedule"),accessor:"crontab_humanized",size:"xl",Cell:e=>{let{row:{original:{crontab_humanized:t="",timezone:a}}}=e;return(0,w.tZ)(g.u,{title:`${t} (${a})`,placement:"topLeft"},(0,w.tZ)("span",null,`${t} (${a})`))}},{Cell:e=>{let{row:{original:{recipients:t}}}=e;return t.map((e=>(0,w.tZ)(E,{key:e.id,type:e.type})))},accessor:"recipients",Header:(0,o.t)("Notification method"),disableSortBy:!0,size:"xl"},{Cell:e=>{let{row:{original:{owners:t=[]}}}=e;return(0,w.tZ)(m.Z,{users:t})},Header:(0,o.t)("Owners"),id:"owners",disableSortBy:!0,size:"xl"},{Cell:e=>{let{row:{original:{changed_on_delta_humanized:t,changed_by:a}}}=e;return(0,w.tZ)(D.w,{date:t,user:a})},Header:(0,o.t)("Last modified"),accessor:"changed_on_delta_humanized",size:"xl"},{Cell:e=>{let{row:{original:t}}=e;const a=t.owners.map((e=>e.id)).includes(n.userId)||(0,R.i5)(n);return(0,w.tZ)(h.r,{disabled:!a,checked:t.active,onClick:e=>se(t,e),size:"small"})},Header:(0,o.t)("Active"),accessor:"active",id:"active",size:"xl"},{Cell:e=>{let{row:{original:t}}=e;const a=(0,l.k6)(),r=t.owners.map((e=>e.id)).includes(n.userId)||(0,R.i5)(n),s=[re?{label:"execution-log-action",tooltip:(0,o.t)("Execution log"),placement:"bottom",icon:"Note",onClick:()=>a.push(`/${t.type.toLowerCase()}/${t.id}/log`)}:null,re?{label:r?"edit-action":"preview-action",tooltip:r?(0,o.t)("Edit"):(0,o.t)("View"),placement:"bottom",icon:r?"Edit":"Binoculars",onClick:()=>ae(t)}:null,r&&le?{label:"delete-action",tooltip:(0,o.t)("Delete"),placement:"bottom",icon:"Trash",onClick:()=>te(t)}:null].filter((e=>null!==e));return(0,w.tZ)(p.Z,{actions:s})},Header:(0,o.t)("Actions"),id:"actions",hidden:!re&&!le,disableSortBy:!0,size:"xl"},{accessor:H.J.changed_by,hidden:!0}]),[le,re,a,se]),ce=[];ne&&ce.push({name:(0,w.tZ)(r.Fragment,null,(0,w.tZ)("i",{className:"fa fa-plus"})," ",i),buttonStyle:"primary",onClick:()=>{ae(null)}}),le&&ce.push({name:(0,o.t)("Bulk select"),onClick:V,buttonStyle:"secondary","data-test":"bulk-select-toggle"});const ue={title:(0,o.t)("No %s yet",u),image:"filter-results.svg",buttonAction:()=>ae(null),buttonText:ne?(0,w.tZ)(r.Fragment,null,(0,w.tZ)("i",{className:"fa fa-plus"})," ",i," "):null},de=(0,r.useMemo)((()=>[{Header:(0,o.t)("Name"),key:"search",id:"name",input:"search",operator:Z.p.contains},{Header:(0,o.t)("Owner"),key:"owner",id:"owners",input:"select",operator:Z.p.relationManyMany,unfilteredLabel:(0,o.t)("All"),fetchSelects:(0,L.tm)("report","owners",(0,L.v$)((e=>(0,o.t)("An error occurred while fetching owners values: %s",e))),n),paginate:!0},{Header:(0,o.t)("Status"),key:"status",id:"last_state",input:"select",operator:Z.p.equals,unfilteredLabel:"Any",selects:[{label:G[v.Z.Success],value:v.Z.Success},{label:G[v.Z.Working],value:v.Z.Working},{label:G[v.Z.Error],value:v.Z.Error},{label:G[v.Z.Noop],value:v.Z.Noop},{label:G[v.Z.Grace],value:v.Z.Grace}]},{Header:(0,o.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:Z.p.relationOneMany,unfilteredLabel:(0,o.t)("All"),fetchSelects:(0,L.tm)("report","changed_by",(0,L.v$)((e=>(0,o.t)("An error occurred while fetching dataset datasource values: %s",e))),n),paginate:!0}]),[]),pe=U?(0,w.tZ)(M,null,(0,w.tZ)("div",null,(0,o.t)("Alerts & reports")),(0,w.tZ)(U,null)):(0,o.t)("Alerts & reports");return(0,w.tZ)(r.Fragment,null,(0,w.tZ)(b.Z,{activeChild:f,name:pe,tabs:[{name:"Alerts",label:(0,o.t)("Alerts"),url:"/alert/list/",usesRouter:!0,"data-test":"alert-list"},{name:"Reports",label:(0,o.t)("Reports"),url:"/report/list/",usesRouter:!0,"data-test":"report-list"}],buttons:ce},(0,w.tZ)(I,null,(0,w.tZ)(N,{updatedAt:K,update:()=>q()}))),(0,w.tZ)(z.ZP,{alert:X,addDangerToast:t,layer:X,onHide:()=>{J(!1),Q(null),q()},show:j,isReport:a,key:(null==X?void 0:X.id)||`${(new Date).getTime()}`}),ee&&(0,w.tZ)(x.Z,{description:(0,o.t)("This action will permanently delete %s.",ee.name),onConfirm:()=>{ee&&(e=>{let{id:a,name:r}=e;c.Z.delete({endpoint:`/api/v1/report/${a}`}).then((()=>{q(),te(null),s((0,o.t)("Deleted: %s",r))}),(0,L.v$)((e=>t((0,o.t)("There was an issue deleting %s: %s",r,e)))))})(ee)},onHide:()=>te(null),open:!0,title:(0,o.t)("Delete %s?",i)}),(0,w.tZ)($.Z,{title:(0,o.t)("Please confirm"),description:(0,o.t)("Are you sure you want to delete the selected %s?",u),onConfirm:async e=>{try{const{message:t}=await B(e.map((e=>{let{id:t}=e;return t})));q(),s(t)}catch(e){(0,L.v$)((e=>t((0,o.t)("There was an issue deleting the selected %s: %s",u,e))))(e)}}},(e=>{const a=le?[{key:"delete",name:(0,o.t)("Delete"),onSelect:e,type:"danger"}]:[];return(0,w.tZ)(Z.Z,{className:"alerts-list-view",columns:ie,count:_,data:A,emptyState:ue,fetchData:O,filters:de,initialSort:oe,loading:C,bulkActions:a,bulkSelectEnabled:W,disableBulkSelect:V,refreshData:q,addDangerToast:t,addSuccessToast:s,pageSize:25})})))}))},83379:(e,t,a)=>{function r(e){return e?`${e.first_name} ${e.last_name}`:""}a.d(t,{Z:()=>r})}}]);
//# sourceMappingURL=7cb08277b7a3754afb44.chunk.js.map