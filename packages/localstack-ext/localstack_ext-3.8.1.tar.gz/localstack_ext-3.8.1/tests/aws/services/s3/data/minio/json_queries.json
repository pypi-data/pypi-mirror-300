[
  {
    "id": "select-in-array-full",
    "query": "SELECT * from s3object s WHERE 'bar' IN s.synonyms[*]",
    "expected": "{\"id\":0,\"title\":\"Test Record\",\"desc\":\"Some text\",\"synonyms\":[\"foo\",\"bar\",\"whatever\"]}"
  },
  {
    "id": "simple-in-array",
    "query": "SELECT * from s3object s WHERE s.id IN (1,3)",
    "expected": "{\"id\":1,\"title\":\"Second Record\",\"desc\":\"another text\",\"synonyms\":[\"some\",\"synonym\",\"value\"]}\n{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "select-in-array-single",
    "query": "SELECT s.synonyms from s3object s WHERE 'bar' IN s.synonyms[*] ",
    "expected": "{\"synonyms\":[\"foo\",\"bar\",\"whatever\"]}"
  },
  {
    "id": "donatello-1",
    "query": "SELECT * from s3object s WHERE 'bar' in s.synonyms",
    "expected": "{\"id\":0,\"title\":\"Test Record\",\"desc\":\"Some text\",\"synonyms\":[\"foo\",\"bar\",\"whatever\"]}"
  },
  {
    "id": "donatello-2",
    "query": "SELECT * from s3object s WHERE 'bar' in s.synonyms[*]",
    "expected": "{\"id\":0,\"title\":\"Test Record\",\"desc\":\"Some text\",\"synonyms\":[\"foo\",\"bar\",\"whatever\"]}"
  },
  {
    "id": "bignum-1",
    "query": "SELECT s.\"id\" from s3object s WHERE CAST(s.\"id\" AS INTEGER) <= 9223372036854775807",
    "expected": "{\"id\":0}\n{\"id\":1}\n{\"id\":2}\n{\"id\":3}"
  },
  {
    "id": "bignum-2",
    "query": "SELECT s.\"id\" from s3object s WHERE s.\"id\" >= -9223372036854775808",
    "expected": "{\"id\":0}\n{\"id\":1}\n{\"id\":2}\n{\"id\":3}"
  },
  {
    "id": "donatello-3",
    "query": "SELECT * from s3object s WHERE 'value' IN s.synonyms[*]",
    "expected": "{\"id\":1,\"title\":\"Second Record\",\"desc\":\"another text\",\"synonyms\":[\"some\",\"synonym\",\"value\"]}"
  },
  {
    "id": "select-in-number",
    "query": "SELECT * from s3object s WHERE 4 in s.numbers[*]",
    "expected": "{\"id\":2,\"title\":\"Second Record\",\"desc\":\"another text\",\"numbers\":[2,3,4]}"
  },
  {
    "id": "select-in-number-float",
    "query": "SELECT * from s3object s WHERE 3 in s.numbers[*]",
    "expected": "{\"id\":2,\"title\":\"Second Record\",\"desc\":\"another text\",\"numbers\":[2,3,4]}"
  },
  {
    "id": "select-in-number-float-in-sql",
    "query": "SELECT * from s3object s WHERE 3.0 in s.numbers[*]",
    "expected": "{\"id\":2,\"title\":\"Second Record\",\"desc\":\"another text\",\"numbers\":[2,3,4]}"
  },
  {
    "id": "select-in-list-match",
    "query": "SELECT * from s3object s WHERE (2,3,4) IN s.nested[*]",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "select-in-nested-float",
    "query": "SELECT s.nested from s3object s WHERE 8.5 IN s.nested[*][*]",
    "expected": "{\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "select-in-combine-and",
    "query": "SELECT s.nested from s3object s WHERE (8.5 IN s.nested[*][*]) AND (s.id > 0)",
    "expected": "{\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "select-in-combine-and-no",
    "query": "SELECT s.nested from s3object s WHERE (8.5 IN s.nested[*][*]) AND (s.id = 0)",
    "expected": ""
  },
  {
    "id": "select-in-nested-float-no-flat",
    "query": "SELECT s.nested from s3object s WHERE 8.5 IN s.nested[*]",
    "expected": ""
  },
  {
    "id": "select-empty-field-result",
    "query": "SELECT * from s3object s WHERE s.nested[0][0] = 2",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "select-arrays-specific",
    "query": "SELECT * from s3object s WHERE s.nested[1][0] = 7",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "wrong-index-no-result",
    "query": "SELECT * from s3object s WHERE s.nested[0][0] = 7",
    "expected": ""
  },
  {
    "id": "not-equal-result",
    "query": "SELECT * from s3object s WHERE (s.nested[1][0] IS MISSING) OR (s.nested[1][0] != 7)",
    "expected": "{\"id\":0,\"title\":\"Test Record\",\"desc\":\"Some text\",\"synonyms\":[\"foo\",\"bar\",\"whatever\"]}\n{\"id\":1,\"title\":\"Second Record\",\"desc\":\"another text\",\"synonyms\":[\"some\",\"synonym\",\"value\"]}\n{\"id\":2,\"title\":\"Second Record\",\"desc\":\"another text\",\"numbers\":[2,3,4]}"
  },
  {
    "id": "indexed-list-match",
    "query": "SELECT * from s3object s WHERE (7,8.5,9) IN s.nested[1]",
    "expected": ""
  },
  {
    "id": "indexed-list-match-equals",
    "query": "SELECT * from s3object s WHERE (7,8.5,9) = s.nested[1]",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "indexed-list-match-equals-s-star",
    "query": "SELECT s.* from s3object s WHERE (7,8.5,9) = s.nested[1]",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "indexed-list-match-equals-s-index",
    "query": "SELECT s.nested[1], s.nested[0] from s3object s WHERE (7,8.5,9) = s.nested[1]",
    "expected": "{\"_1\":[7,8.5,9],\"_2\":[2,3,4]}"
  },
  {
    "id": "indexed-list-match-not-equals",
    "query": "SELECT * from s3object s WHERE (s.nested[1] IS MISSING) OR ((7,8.5,9) != s.nested[1])",
    "expected": "{\"id\":0,\"title\":\"Test Record\",\"desc\":\"Some text\",\"synonyms\":[\"foo\",\"bar\",\"whatever\"]}\n{\"id\":1,\"title\":\"Second Record\",\"desc\":\"another text\",\"synonyms\":[\"some\",\"synonym\",\"value\"]}\n{\"id\":2,\"title\":\"Second Record\",\"desc\":\"another text\",\"numbers\":[2,3,4]}"
  },
  {
    "id": "indexed-list-square-bracket",
    "query": "SELECT * from s3object s WHERE [7,8.5,9] = s.nested[1]",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "indexed-list-square-bracket",
    "query": "SELECT * from s3object s WHERE [7,8.5,9] IN s.nested",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "indexed-list-square-bracket",
    "query": "SELECT * from s3object s WHERE CAST(s.\"id\" AS INTEGER) IN [3,2]",
    "expected": "{\"id\":2,\"title\":\"Second Record\",\"desc\":\"another text\",\"numbers\":[2,3,4]}\n{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "index-wildcard-in",
    "query": "SELECT * from s3object s WHERE (8.5) IN s.nested[1][*]",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "index-wildcard-in",
    "query": "SELECT * from s3object s WHERE (8.0+0.5) IN s.nested[1][*]",
    "expected": "{\"id\":3,\"title\":\"Second Record\",\"desc\":\"another text\",\"nested\":[[2,3,4],[7,8.5,9]]}"
  },
  {
    "id": "index-wildcard-in",
    "query": "SELECT * from s3object s WHERE s.title = 'Test Record'",
    "expected": "{\"id\":0,\"title\":\"Test Record\",\"desc\":\"Some text\",\"synonyms\":[\"foo\",\"bar\",\"whatever\"]}"
  },
  {
    "id": "select-output-field-as-csv",
    "query": "",
    "expected": "\"[\"\"foo\"\",\"\"bar\"\",\"\"whatever\"\"]\""
  },
  {
    "id": "document",
    "query": "",
    "expected": "{\"element_type\":\"__elem__merfu\",\"element_id\":\"d868aefe-ef9a-4be2-b9b2-c9fd89cc43eb\",\"attributes\":{\"__attr__image_dpi\":300,\"__attr__image_size\":[2550,3299],\"__attr__image_index\":2,\"__attr__image_format\":\"JPEG\",\"__attr__file_extension\":\"jpg\",\"__attr__data\":null}}"
  },
  {
    "id": "date_diff_month",
    "query": "SELECT date_diff(MONTH, CAST('2019-10-20T' AS TIMESTAMP), CAST('2020-01-20T' AS TIMESTAMP)) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":3}"
  },
  {
    "id": "date_diff_month_neg",
    "query": "SELECT date_diff(MONTH, CAST('2020-01-20T' AS TIMESTAMP), CAST('2019-10-20T' AS TIMESTAMP)) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":-3}"
  },
  {
    "id": "date_diff_year",
    "query": "SELECT date_diff(year, CAST('2010-01-01T' AS TIMESTAMP), CAST('2011-01-01T' AS TIMESTAMP)) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":1}"
  },
  {
    "id": "date_diff_year",
    "query": "SELECT date_diff(month, CAST('2010-01-01T' AS TIMESTAMP), CAST('2010-05T' AS TIMESTAMP)) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":4}"
  },
  {
    "id": "date_diff_month_oney",
    "query": "SELECT date_diff(month, CAST('2010T' AS TIMESTAMP), CAST('2011T' AS TIMESTAMP)) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":12}"
  },
  {
    "id": "date_diff_month_neg",
    "query": "SELECT date_diff(month, CAST('2011T' AS TIMESTAMP), CAST('2010T' AS TIMESTAMP)) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":-12}"
  },
  {
    "id": "date_diff_days",
    "query": "SELECT date_diff(day, CAST('2010-01-01T23:00:00Z' AS TIMESTAMP), CAST('2010-01-02T01:00:00Z' AS TIMESTAMP)) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":0}"
  },
  {
    "id": "date_diff_days_one",
    "query": "SELECT date_diff(day, CAST('2010-01-01T23:00:00Z' AS TIMESTAMP), CAST('2010-01-02T23:00:00Z' AS TIMESTAMP)) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":1}"
  },
  {
    "id": "cast_from_int_to_float",
    "query": "SELECT cast(1 as float) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":1}"
  },
  {
    "id": "cast_from_float_to_float",
    "query": "SELECT cast(1.0 as float) FROM S3Object LIMIT 1",
    "expected": "{\"_1\":1}"
  },
  {
    "id": "arithmetic_integer_operand",
    "query": "SELECT 1 / 2 FROM S3Object LIMIT 1",
    "expected": "{\"_1\":0}"
  },
  {
    "id": "arithmetic_float_operand",
    "query": "SELECT 1.0 / 2.0 * .3 FROM S3Object LIMIT 1",
    "expected": "{\"_1\":0.15}"
  },
  {
    "id": "arithmetic_integer_float_operand",
    "query": "SELECT 3.0 / 2, 5 / 2.0 FROM S3Object LIMIT 1",
    "expected": "{\"_1\":1.5,\"_2\":2.5}"
  }
]
